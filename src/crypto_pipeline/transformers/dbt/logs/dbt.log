[0m23:44:42.203296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd42a174f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4135d030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd42cde7a0>]}


============================== 23:44:42.205242 | 5c9b1904-7fe1-4287-aa3e-3c851e6652c3 ==============================
[0m23:44:42.205242 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:44:42.205585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:44:42.209996 [info ] [MainThread]: dbt version: 1.8.8
[0m23:44:42.210321 [info ] [MainThread]: python version: 3.10.12
[0m23:44:42.210559 [info ] [MainThread]: python path: /root/crypto_pipeline/venv/bin/python3
[0m23:44:42.210785 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.35
[0m23:44:42.282808 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m23:44:42.283211 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m23:44:42.283467 [info ] [MainThread]: Using dbt_project.yml file at /root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/dbt_project.yml
[0m23:44:42.285173 [info ] [MainThread]: adapter type: duckdb
[0m23:44:42.285455 [info ] [MainThread]: adapter version: 1.9.0
[0m23:44:42.323577 [info ] [MainThread]: Configuration:
[0m23:44:42.324019 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:44:42.324338 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m23:44:42.324614 [info ] [MainThread]: Required dependencies:
[0m23:44:42.324877 [debug] [MainThread]: Executing "git --help"
[0m23:44:42.326412 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:44:42.326734 [debug] [MainThread]: STDERR: "b''"
[0m23:44:42.326924 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:44:42.327180 [info ] [MainThread]: Connection:
[0m23:44:42.327439 [info ] [MainThread]:   database: crypto_trading
[0m23:44:42.327667 [info ] [MainThread]:   schema: main
[0m23:44:42.327888 [info ] [MainThread]:   path: ~/crypto_pipeline/crypto_trading.db
[0m23:44:42.328109 [info ] [MainThread]:   config_options: None
[0m23:44:42.328329 [info ] [MainThread]:   extensions: ['httpfs', 'aws']
[0m23:44:42.328547 [info ] [MainThread]:   settings: {}
[0m23:44:42.328778 [info ] [MainThread]:   external_root: .
[0m23:44:42.329006 [info ] [MainThread]:   use_credential_provider: None
[0m23:44:42.329238 [info ] [MainThread]:   attach: None
[0m23:44:42.329452 [info ] [MainThread]:   filesystems: None
[0m23:44:42.329665 [info ] [MainThread]:   remote: None
[0m23:44:42.329882 [info ] [MainThread]:   plugins: None
[0m23:44:42.330109 [info ] [MainThread]:   disable_transactions: False
[0m23:44:42.330463 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m23:44:42.331462 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m23:44:42.347204 [debug] [MainThread]: Using duckdb connection "debug"
[0m23:44:42.347693 [debug] [MainThread]: On debug: select 1 as id
[0m23:44:42.347951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:44:42.393113 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m23:44:42.393957 [debug] [MainThread]: On debug: Close
[0m23:44:42.396191 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:44:42.396520 [info ] [MainThread]: [31m1 check failed:[0m
[0m23:44:42.396788 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('target_path' was unexpected)

Error encountered in /root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/dbt_project.yml


[0m23:44:42.397400 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.23532374, "process_user_time": 1.071134, "process_kernel_time": 0.071408, "process_mem_max_rss": "172300", "process_in_blocks": "272", "process_out_blocks": "16", "command_success": false}
[0m23:44:42.397792 [debug] [MainThread]: Command `dbt debug` failed at 23:44:42.397715 after 0.24 seconds
[0m23:44:42.398026 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:44:42.398252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd42a174f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd42d23d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd3573f490>]}
[0m23:44:42.398498 [debug] [MainThread]: Flushing usage events
[0m23:46:19.633539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6831734c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa681ab5780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa681ab6ce0>]}


============================== 23:46:19.635455 | df2142ca-9cc6-4282-928b-1f6219f95031 ==============================
[0m23:46:19.635455 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:46:19.635891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:46:19.640766 [info ] [MainThread]: dbt version: 1.8.8
[0m23:46:19.641081 [info ] [MainThread]: python version: 3.10.12
[0m23:46:19.641385 [info ] [MainThread]: python path: /root/crypto_pipeline/venv/bin/python3
[0m23:46:19.641688 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.35
[0m23:46:19.711999 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m23:46:19.712371 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m23:46:19.712609 [info ] [MainThread]: Using dbt_project.yml file at /root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/dbt_project.yml
[0m23:46:19.714138 [info ] [MainThread]: adapter type: duckdb
[0m23:46:19.714396 [info ] [MainThread]: adapter version: 1.9.0
[0m23:46:19.772902 [info ] [MainThread]: Configuration:
[0m23:46:19.773341 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:46:19.773678 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:46:19.773958 [info ] [MainThread]: Required dependencies:
[0m23:46:19.774352 [debug] [MainThread]: Executing "git --help"
[0m23:46:19.776242 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:46:19.776626 [debug] [MainThread]: STDERR: "b''"
[0m23:46:19.776823 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:46:19.777065 [info ] [MainThread]: Connection:
[0m23:46:19.777340 [info ] [MainThread]:   database: crypto_trading
[0m23:46:19.777589 [info ] [MainThread]:   schema: main
[0m23:46:19.777808 [info ] [MainThread]:   path: ~/crypto_pipeline/crypto_trading.db
[0m23:46:19.778026 [info ] [MainThread]:   config_options: None
[0m23:46:19.778245 [info ] [MainThread]:   extensions: ['httpfs', 'aws']
[0m23:46:19.778495 [info ] [MainThread]:   settings: {}
[0m23:46:19.778718 [info ] [MainThread]:   external_root: .
[0m23:46:19.778935 [info ] [MainThread]:   use_credential_provider: None
[0m23:46:19.779152 [info ] [MainThread]:   attach: None
[0m23:46:19.779406 [info ] [MainThread]:   filesystems: None
[0m23:46:19.779630 [info ] [MainThread]:   remote: None
[0m23:46:19.779889 [info ] [MainThread]:   plugins: None
[0m23:46:19.780137 [info ] [MainThread]:   disable_transactions: False
[0m23:46:19.780507 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m23:46:19.781587 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m23:46:19.798242 [debug] [MainThread]: Using duckdb connection "debug"
[0m23:46:19.798659 [debug] [MainThread]: On debug: select 1 as id
[0m23:46:19.798878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:46:19.841399 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m23:46:19.842285 [debug] [MainThread]: On debug: Close
[0m23:46:19.844586 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:46:19.844946 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:46:19.845647 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.24579185, "process_user_time": 1.042006, "process_kernel_time": 0.107793, "process_mem_max_rss": "172948", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m23:46:19.846046 [debug] [MainThread]: Command `dbt debug` succeeded at 23:46:19.845971 after 0.25 seconds
[0m23:46:19.846282 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:46:19.846508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6831734c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa682b87bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa681ab5780>]}
[0m23:46:19.846767 [debug] [MainThread]: Flushing usage events
[0m23:46:31.066289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1160843490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1160239f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1160b0b8e0>]}


============================== 23:46:31.068272 | 1f792df5-1ecd-4c80-8f77-a0251584f3ed ==============================
[0m23:46:31.068272 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:46:31.068647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m23:46:31.149391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f792df5-1ecd-4c80-8f77-a0251584f3ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1160b0bdc0>]}
[0m23:46:31.157678 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:46:31.158627 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:46:31.159452 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12714729, "process_user_time": 0.855798, "process_kernel_time": 0.039804, "process_mem_max_rss": "87804", "process_in_blocks": "352", "process_out_blocks": "16"}
[0m23:46:31.160049 [debug] [MainThread]: Command `dbt deps` succeeded at 23:46:31.159956 after 0.13 seconds
[0m23:46:31.160332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1160843490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f115ecdcdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1160b0b0a0>]}
[0m23:46:31.160648 [debug] [MainThread]: Flushing usage events
[0m23:46:47.544884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3c0674c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a593130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a592080>]}


============================== 23:46:47.546815 | 1d65e3c0-4b81-41f7-99a9-f08fd4c44877 ==============================
[0m23:46:47.546815 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:46:47.547168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:46:47.677518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d65e3c0-4b81-41f7-99a9-f08fd4c44877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3c32f7c0>]}
[0m23:46:47.712175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d65e3c0-4b81-41f7-99a9-f08fd4c44877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d36726890>]}
[0m23:46:47.713919 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m23:46:47.727969 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:46:47.728471 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:46:47.728776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1d65e3c0-4b81-41f7-99a9-f08fd4c44877', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2ee97310>]}
[0m23:46:48.496551 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:46:48.497030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1d65e3c0-4b81-41f7-99a9-f08fd4c44877', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2ed57940>]}
[0m23:46:48.593530 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_hourly_ohlcv_high__low_____ref_hourly_ohlcv_ (models/mart/schema.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'operator'
[0m23:46:48.594460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.082115, "process_user_time": 1.736933, "process_kernel_time": 0.050492, "process_mem_max_rss": "148264", "process_in_blocks": "1736", "process_out_blocks": "16", "command_success": false}
[0m23:46:48.594855 [debug] [MainThread]: Command `dbt run` failed at 23:46:48.594767 after 1.08 seconds
[0m23:46:48.595148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3c0674c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2ed57fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d2c17b880>]}
[0m23:46:48.595393 [debug] [MainThread]: Flushing usage events
[0m23:51:20.582806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c948c7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c93213be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c93213d60>]}


============================== 23:51:20.585515 | eb3e52d3-d889-4b10-87e1-56ac6f800ada ==============================
[0m23:51:20.585515 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:51:20.585865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:51:20.796124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb3e52d3-d889-4b10-87e1-56ac6f800ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9478d1b0>]}
[0m23:51:20.831770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb3e52d3-d889-4b10-87e1-56ac6f800ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c931e7df0>]}
[0m23:51:20.834275 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m23:51:20.843018 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:51:20.843555 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:51:20.843839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb3e52d3-d889-4b10-87e1-56ac6f800ada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c87698e80>]}
[0m23:51:21.605044 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:51:21.605486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eb3e52d3-d889-4b10-87e1-56ac6f800ada', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8efa6500>]}
[0m23:51:21.738799 [error] [MainThread]: Encountered an error:
Compilation Error in test relationships_stg_trades_partition_date__traded_at__date_field___ref_stg_trades_ (models/staging/schema.yml)
  macro 'dbt_macro__test_relationships' takes no keyword argument 'sql'
[0m23:51:21.740203 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1918916, "process_user_time": 1.758767, "process_kernel_time": 0.161616, "process_mem_max_rss": "145688", "process_in_blocks": "127984", "process_out_blocks": "16", "command_success": false}
[0m23:51:21.740680 [debug] [MainThread]: Command `dbt run` failed at 23:51:21.740526 after 1.19 seconds
[0m23:51:21.740985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c948c7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c87555e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c8439d0f0>]}
[0m23:51:21.741275 [debug] [MainThread]: Flushing usage events
[0m23:51:53.066712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a16ab520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a10a5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29fbd7850>]}


============================== 23:51:53.068661 | 5742d42b-2b8b-4da5-bc04-e524878d2069 ==============================
[0m23:51:53.068661 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:51:53.069041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:51:53.198267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5742d42b-2b8b-4da5-bc04-e524878d2069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a15711e0>]}
[0m23:51:53.233416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5742d42b-2b8b-4da5-bc04-e524878d2069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29bd263b0>]}
[0m23:51:53.235161 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m23:51:53.241895 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:51:53.242410 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:51:53.242723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5742d42b-2b8b-4da5-bc04-e524878d2069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff294426bc0>]}
[0m23:51:53.965104 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m23:51:53.965584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5742d42b-2b8b-4da5-bc04-e524878d2069', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29422bb20>]}
[0m23:51:54.154026 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m23:51:54.164339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5742d42b-2b8b-4da5-bc04-e524878d2069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28d04be20>]}
[0m23:51:54.244252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5742d42b-2b8b-4da5-bc04-e524878d2069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28d049ea0>]}
[0m23:51:54.244668 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m23:51:54.244947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5742d42b-2b8b-4da5-bc04-e524878d2069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff28d049db0>]}
[0m23:51:54.246280 [info ] [MainThread]: 
[0m23:51:54.246726 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:51:54.250572 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m23:51:54.283298 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m23:51:54.283715 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m23:51:54.284015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:54.345217 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m23:51:54.346363 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m23:51:54.348724 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m23:51:54.349108 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m23:51:54.353899 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m23:51:54.354171 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m23:51:54.354462 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:54.390521 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m23:51:54.392066 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m23:51:54.392339 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m23:51:54.392826 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:54.393132 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m23:51:54.393413 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m23:51:54.393979 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:54.394752 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m23:51:54.395089 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m23:51:54.395440 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m23:51:54.397288 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m23:51:54.397515 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m23:51:54.400156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m23:51:54.404432 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m23:51:54.404663 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m23:51:54.404844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:54.438273 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m23:51:54.438785 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m23:51:54.439129 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m23:51:54.457076 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m23:51:54.458267 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m23:51:54.459125 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m23:51:54.459438 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m23:51:54.462094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5742d42b-2b8b-4da5-bc04-e524878d2069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a173ed40>]}
[0m23:51:54.462555 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:54.462841 [debug] [MainThread]: On master: BEGIN
[0m23:51:54.463107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:54.498966 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m23:51:54.499438 [debug] [MainThread]: On master: COMMIT
[0m23:51:54.499698 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:54.499898 [debug] [MainThread]: On master: COMMIT
[0m23:51:54.500370 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:51:54.500705 [debug] [MainThread]: On master: Close
[0m23:51:54.502988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:51:54.503275 [info ] [MainThread]: 
[0m23:51:54.506040 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m23:51:54.506492 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m23:51:54.506966 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m23:51:54.507236 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m23:51:54.513158 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m23:51:54.514969 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m23:51:54.536816 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m23:51:54.538741 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m23:51:54.539065 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m23:51:54.539299 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:51:54.573808 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m23:51:54.574441 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m23:51:54.574823 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m23:51:54.582203 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m23:51:54.582489 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:51:54.582877 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m23:51:54.588050 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m23:51:54.588300 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m23:51:54.590215 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m23:51:54.591381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5742d42b-2b8b-4da5-bc04-e524878d2069', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a09e78e0>]}
[0m23:51:54.591869 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.08s]
[0m23:51:54.592322 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m23:51:54.593756 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m23:51:54.594080 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m23:51:54.594507 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m23:51:54.594820 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m23:51:54.595128 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m23:51:54.595638 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m23:51:54.597009 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:54.597300 [debug] [MainThread]: On master: BEGIN
[0m23:51:54.597513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:54.633625 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m23:51:54.634106 [debug] [MainThread]: On master: COMMIT
[0m23:51:54.634462 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:54.634731 [debug] [MainThread]: On master: COMMIT
[0m23:51:54.635402 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:51:54.635723 [debug] [MainThread]: On master: Close
[0m23:51:54.637588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:54.637797 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m23:51:54.637973 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m23:51:54.638249 [info ] [MainThread]: 
[0m23:51:54.638518 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m23:51:54.639067 [debug] [MainThread]: Command end result
[0m23:51:54.663325 [info ] [MainThread]: 
[0m23:51:54.663751 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:51:54.664049 [info ] [MainThread]: 
[0m23:51:54.664473 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m23:51:54.664731 [info ] [MainThread]: 
[0m23:51:54.665001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m23:51:54.665616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.6317325, "process_user_time": 3.18599, "process_kernel_time": 0.224802, "process_mem_max_rss": "207196", "process_in_blocks": "144992", "process_out_blocks": "2944", "command_success": false}
[0m23:51:54.666002 [debug] [MainThread]: Command `dbt run` failed at 23:51:54.665929 after 1.63 seconds
[0m23:51:54.666325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2a16ab520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff294217040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff29420b1f0>]}
[0m23:51:54.666588 [debug] [MainThread]: Flushing usage events
[0m23:58:57.742619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef956af4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef95977850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef95977d90>]}


============================== 23:58:57.745745 | a36681e0-bd13-424c-9f64-e360ceba9fa7 ==============================
[0m23:58:57.745745 [info ] [MainThread]: Running with dbt=1.8.8
[0m23:58:57.746289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:58:57.971638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a36681e0-bd13-424c-9f64-e360ceba9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8fda6830>]}
[0m23:58:58.008196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a36681e0-bd13-424c-9f64-e360ceba9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8fd3e770>]}
[0m23:58:58.011238 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m23:58:58.021151 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m23:58:58.137256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:58.137633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:58.142707 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m23:58:58.176538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a36681e0-bd13-424c-9f64-e360ceba9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8812c130>]}
[0m23:58:58.264298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a36681e0-bd13-424c-9f64-e360ceba9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef88391510>]}
[0m23:58:58.264740 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m23:58:58.265049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a36681e0-bd13-424c-9f64-e360ceba9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef88391540>]}
[0m23:58:58.266594 [info ] [MainThread]: 
[0m23:58:58.267067 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:58:58.271322 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m23:58:58.300899 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m23:58:58.301271 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m23:58:58.301536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:58.370939 [debug] [ThreadPool]: SQL status: OK in 0.069 seconds
[0m23:58:58.372338 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m23:58:58.375119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m23:58:58.375639 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m23:58:58.382827 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m23:58:58.383325 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m23:58:58.383697 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:58.426005 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m23:58:58.427730 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m23:58:58.428150 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m23:58:58.428762 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:58:58.429050 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m23:58:58.429352 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m23:58:58.429938 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:58:58.430669 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m23:58:58.430946 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m23:58:58.431231 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m23:58:58.431832 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:58:58.432131 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m23:58:58.435529 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m23:58:58.441200 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m23:58:58.441493 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m23:58:58.441721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:58:58.480179 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m23:58:58.480724 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m23:58:58.481077 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m23:58:58.503745 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m23:58:58.505246 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m23:58:58.506127 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m23:58:58.506437 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m23:58:58.509728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a36681e0-bd13-424c-9f64-e360ceba9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef95746d10>]}
[0m23:58:58.510243 [debug] [MainThread]: Using duckdb connection "master"
[0m23:58:58.510541 [debug] [MainThread]: On master: BEGIN
[0m23:58:58.510788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:58:58.552613 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m23:58:58.553112 [debug] [MainThread]: On master: COMMIT
[0m23:58:58.553498 [debug] [MainThread]: Using duckdb connection "master"
[0m23:58:58.553737 [debug] [MainThread]: On master: COMMIT
[0m23:58:58.554408 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:58:58.554829 [debug] [MainThread]: On master: Close
[0m23:58:58.557646 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:58.558122 [info ] [MainThread]: 
[0m23:58:58.560798 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m23:58:58.561303 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m23:58:58.561914 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m23:58:58.562183 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m23:58:58.569931 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m23:58:58.570656 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m23:58:58.598212 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m23:58:58.598922 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m23:58:58.599373 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m23:58:58.599752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:58:58.639207 [debug] [Thread-1 (]: SQL status: OK in 0.039 seconds
[0m23:58:58.639753 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m23:58:58.640271 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m23:58:58.648991 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m23:58:58.649547 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:58:58.650041 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m23:58:58.655587 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m23:58:58.655925 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m23:58:58.658959 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m23:58:58.660605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a36681e0-bd13-424c-9f64-e360ceba9fa7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef8758c520>]}
[0m23:58:58.661293 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.10s]
[0m23:58:58.661800 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m23:58:58.663651 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m23:58:58.664112 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m23:58:58.664652 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m23:58:58.665017 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m23:58:58.665393 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m23:58:58.665926 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m23:58:58.667395 [debug] [MainThread]: Using duckdb connection "master"
[0m23:58:58.667687 [debug] [MainThread]: On master: BEGIN
[0m23:58:58.667966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:58:58.711011 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m23:58:58.711551 [debug] [MainThread]: On master: COMMIT
[0m23:58:58.712061 [debug] [MainThread]: Using duckdb connection "master"
[0m23:58:58.712352 [debug] [MainThread]: On master: COMMIT
[0m23:58:58.713096 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:58:58.713577 [debug] [MainThread]: On master: Close
[0m23:58:58.716367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:58.716636 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m23:58:58.716895 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m23:58:58.717353 [info ] [MainThread]: 
[0m23:58:58.717767 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m23:58:58.718464 [debug] [MainThread]: Command end result
[0m23:58:58.748241 [info ] [MainThread]: 
[0m23:58:58.748843 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:58:58.749331 [info ] [MainThread]: 
[0m23:58:58.749743 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m23:58:58.750079 [info ] [MainThread]: 
[0m23:58:58.750413 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m23:58:58.751775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0464052, "process_user_time": 2.812747, "process_kernel_time": 0.402886, "process_mem_max_rss": "208732", "process_in_blocks": "272256", "process_out_blocks": "2048", "command_success": false}
[0m23:58:58.752297 [debug] [MainThread]: Command `dbt run` failed at 23:58:58.752193 after 1.05 seconds
[0m23:58:58.752687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef956af4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef950c28c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef87470a00>]}
[0m23:58:58.753037 [debug] [MainThread]: Flushing usage events
[0m00:02:48.719543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00ad874f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00b04f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00b04fd90>]}


============================== 00:02:48.723879 | 2a588846-67a4-40ae-94a2-0b8128d8ce50 ==============================
[0m00:02:48.723879 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:02:48.724628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:02:48.909416 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "crypto_pipeline", target "dev" invalid: Runtime Error
    Inconsistency detected between 'path' and 'database' fields in profile; the 'database' property must be set to 'crypto_trading' to match the 'path'
[0m00:02:48.911154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2453798, "process_user_time": 0.988238, "process_kernel_time": 0.095022, "process_mem_max_rss": "120984", "process_in_blocks": "125416", "process_out_blocks": "16", "command_success": false}
[0m00:02:48.911630 [debug] [MainThread]: Command `dbt run` failed at 00:02:48.911543 after 0.25 seconds
[0m00:02:48.911912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd00ad874f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd009268130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0092683a0>]}
[0m00:02:48.912182 [debug] [MainThread]: Flushing usage events
[0m00:03:38.348364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac7bf7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac7ebe590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac7ebfbe0>]}


============================== 00:03:38.350471 | 323307b2-826a-4d3c-9dda-e00f44e4ff12 ==============================
[0m00:03:38.350471 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:03:38.350844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:03:38.511364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '323307b2-826a-4d3c-9dda-e00f44e4ff12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac7abd1e0>]}
[0m00:03:38.555323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '323307b2-826a-4d3c-9dda-e00f44e4ff12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac694b610>]}
[0m00:03:38.559068 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:03:38.575514 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:03:38.673525 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:03:38.674003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '323307b2-826a-4d3c-9dda-e00f44e4ff12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac6d6ceb0>]}
[0m00:03:39.471237 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:03:39.471758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '323307b2-826a-4d3c-9dda-e00f44e4ff12', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac7f058d0>]}
[0m00:03:39.660251 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:03:39.672025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '323307b2-826a-4d3c-9dda-e00f44e4ff12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8f4e1f30>]}
[0m00:03:39.751740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '323307b2-826a-4d3c-9dda-e00f44e4ff12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac7f04ee0>]}
[0m00:03:39.752146 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:03:39.752428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323307b2-826a-4d3c-9dda-e00f44e4ff12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab8199b10>]}
[0m00:03:39.753980 [info ] [MainThread]: 
[0m00:03:39.754485 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:03:39.758615 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:03:39.787939 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:03:39.788313 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:03:39.788545 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:39.851433 [debug] [ThreadPool]: SQL status: OK in 0.063 seconds
[0m00:03:39.852623 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:03:39.854961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:03:39.855363 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:03:39.860431 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:03:39.860669 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:03:39.860861 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:39.898396 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m00:03:39.899747 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:03:39.900055 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:03:39.900652 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:39.901034 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:03:39.901347 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:03:39.902033 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:39.902911 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:03:39.903164 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:03:39.903352 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:03:39.903833 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:39.904148 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:03:39.907168 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:03:39.912092 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:03:39.912316 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:03:39.912497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:39.948396 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m00:03:39.948874 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:03:39.949209 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:03:39.969582 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m00:03:39.970734 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:03:39.971698 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:03:39.972019 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:03:39.974814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '323307b2-826a-4d3c-9dda-e00f44e4ff12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8f396ec0>]}
[0m00:03:39.975174 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:39.975439 [debug] [MainThread]: On master: BEGIN
[0m00:03:39.975637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:40.010381 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m00:03:40.010906 [debug] [MainThread]: On master: COMMIT
[0m00:03:40.011195 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:40.011384 [debug] [MainThread]: On master: COMMIT
[0m00:03:40.011842 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:40.012064 [debug] [MainThread]: On master: Close
[0m00:03:40.014568 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:40.014933 [info ] [MainThread]: 
[0m00:03:40.017415 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:03:40.017889 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:03:40.018369 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:03:40.018626 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:03:40.025515 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:03:40.025942 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:03:40.049493 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:03:40.050068 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:03:40.050468 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:03:40.050868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:03:40.085059 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m00:03:40.085660 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:03:40.085981 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m00:03:40.093699 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m00:03:40.093979 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:03:40.094396 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:03:40.099324 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:03:40.099580 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:03:40.101665 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m00:03:40.102801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '323307b2-826a-4d3c-9dda-e00f44e4ff12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8f37c4f0>]}
[0m00:03:40.103269 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.08s]
[0m00:03:40.103720 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:03:40.105363 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:03:40.105665 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:03:40.106044 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:03:40.106376 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:03:40.106734 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:03:40.107174 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:03:40.108270 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:40.108531 [debug] [MainThread]: On master: BEGIN
[0m00:03:40.108805 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:40.143332 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m00:03:40.143824 [debug] [MainThread]: On master: COMMIT
[0m00:03:40.144199 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:40.144504 [debug] [MainThread]: On master: COMMIT
[0m00:03:40.145050 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:40.145324 [debug] [MainThread]: On master: Close
[0m00:03:40.147459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:40.147683 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:03:40.147869 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:03:40.148147 [info ] [MainThread]: 
[0m00:03:40.148422 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m00:03:40.148988 [debug] [MainThread]: Command end result
[0m00:03:40.227409 [info ] [MainThread]: 
[0m00:03:40.227821 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:03:40.228154 [info ] [MainThread]: 
[0m00:03:40.228529 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m00:03:40.228803 [info ] [MainThread]: 
[0m00:03:40.229087 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:03:40.229744 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.9158733, "process_user_time": 3.440683, "process_kernel_time": 0.193387, "process_mem_max_rss": "219440", "process_in_blocks": "147064", "process_out_blocks": "2944", "command_success": false}
[0m00:03:40.230122 [debug] [MainThread]: Command `dbt run` failed at 00:03:40.230051 after 1.92 seconds
[0m00:03:40.230383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac7bf7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faac7b303a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa8f394220>]}
[0m00:03:40.230621 [debug] [MainThread]: Flushing usage events
[0m00:23:30.605830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b71987520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6febe590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6febfbe0>]}


============================== 00:23:30.608758 | 3fa50268-b413-4b53-82ef-3b26ee1e0188 ==============================
[0m00:23:30.608758 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:23:30.609236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:23:30.762294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fa50268-b413-4b53-82ef-3b26ee1e0188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b7184d1e0>]}
[0m00:23:30.798097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fa50268-b413-4b53-82ef-3b26ee1e0188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b706df610>]}
[0m00:23:30.800214 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:23:30.809095 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:23:30.924461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:23:30.924785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:23:30.930028 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:23:30.962392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fa50268-b413-4b53-82ef-3b26ee1e0188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b64434070>]}
[0m00:23:31.048892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fa50268-b413-4b53-82ef-3b26ee1e0188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b64412140>]}
[0m00:23:31.049310 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:23:31.049598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fa50268-b413-4b53-82ef-3b26ee1e0188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b644105e0>]}
[0m00:23:31.050993 [info ] [MainThread]: 
[0m00:23:31.051518 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:23:31.055486 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:23:31.086315 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:23:31.086644 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:23:31.086832 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:23:31.140195 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m00:23:31.141366 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:23:31.144003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:23:31.144400 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:23:31.149607 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:23:31.149843 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:23:31.150045 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:31.185409 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m00:23:31.186666 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:23:31.186944 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:23:31.187428 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:31.187656 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:23:31.187854 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:23:31.188407 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:31.189008 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:23:31.189218 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:23:31.189399 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:23:31.189855 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:23:31.190163 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:23:31.194268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:23:31.198479 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:23:31.198707 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:23:31.198895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:23:31.232663 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m00:23:31.233132 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:23:31.233462 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:23:31.252858 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:23:31.253822 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:23:31.254772 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:23:31.254981 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:23:31.257309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fa50268-b413-4b53-82ef-3b26ee1e0188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b6c86abc0>]}
[0m00:23:31.257758 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:31.257979 [debug] [MainThread]: On master: BEGIN
[0m00:23:31.258154 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:31.300626 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m00:23:31.301182 [debug] [MainThread]: On master: COMMIT
[0m00:23:31.301472 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:31.301705 [debug] [MainThread]: On master: COMMIT
[0m00:23:31.302207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:31.302556 [debug] [MainThread]: On master: Close
[0m00:23:31.305114 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:23:31.305402 [info ] [MainThread]: 
[0m00:23:31.307814 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:23:31.308250 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:23:31.308745 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:23:31.308997 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:23:31.315877 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:23:31.316327 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:23:31.337353 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:23:31.338151 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:23:31.338457 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:23:31.338703 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:23:31.376055 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m00:23:31.376501 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:23:31.376830 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m00:23:31.378406 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m00:23:31.378849 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:23:31.379380 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:23:31.384096 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:23:31.384426 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:23:31.386576 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m00:23:31.387792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fa50268-b413-4b53-82ef-3b26ee1e0188', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b63880550>]}
[0m00:23:31.388273 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.08s]
[0m00:23:31.388728 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:23:31.390276 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:23:31.390601 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:23:31.390933 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:23:31.391267 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:23:31.391583 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:23:31.392005 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:23:31.393348 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:31.393633 [debug] [MainThread]: On master: BEGIN
[0m00:23:31.393849 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:23:31.436042 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m00:23:31.436598 [debug] [MainThread]: On master: COMMIT
[0m00:23:31.436911 [debug] [MainThread]: Using duckdb connection "master"
[0m00:23:31.437210 [debug] [MainThread]: On master: COMMIT
[0m00:23:31.437823 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:23:31.438069 [debug] [MainThread]: On master: Close
[0m00:23:31.440523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:23:31.440843 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:23:31.441041 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:23:31.441326 [info ] [MainThread]: 
[0m00:23:31.441604 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m00:23:31.442346 [debug] [MainThread]: Command end result
[0m00:23:31.472266 [info ] [MainThread]: 
[0m00:23:31.472733 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:23:31.473102 [info ] [MainThread]: 
[0m00:23:31.473510 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m00:23:31.473807 [info ] [MainThread]: 
[0m00:23:31.474137 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:23:31.474913 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.90544015, "process_user_time": 2.371371, "process_kernel_time": 0.237137, "process_mem_max_rss": "210612", "process_in_blocks": "37584", "process_out_blocks": "2048", "command_success": false}
[0m00:23:31.475326 [debug] [MainThread]: Command `dbt run` failed at 00:23:31.475240 after 0.91 seconds
[0m00:23:31.475647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b71987520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b706df610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b64725d50>]}
[0m00:23:31.475939 [debug] [MainThread]: Flushing usage events
[0m00:24:05.982113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7db45f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7db72a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7db72bbe0>]}


============================== 00:24:05.984395 | 0fb69700-17c6-47c2-885b-3cd1bf2ce04d ==============================
[0m00:24:05.984395 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:24:05.984832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:24:06.139288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fb69700-17c6-47c2-885b-3cd1bf2ce04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7db3251e0>]}
[0m00:24:06.180515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fb69700-17c6-47c2-885b-3cd1bf2ce04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7da1b7610>]}
[0m00:24:06.182555 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:24:06.189701 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:24:06.283844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:24:06.284453 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:24:06.290603 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:24:06.331970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fb69700-17c6-47c2-885b-3cd1bf2ce04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7cdf4c070>]}
[0m00:24:06.412329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fb69700-17c6-47c2-885b-3cd1bf2ce04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7cdf2a140>]}
[0m00:24:06.412763 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:24:06.413069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb69700-17c6-47c2-885b-3cd1bf2ce04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7cdf285e0>]}
[0m00:24:06.414716 [info ] [MainThread]: 
[0m00:24:06.415289 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:24:06.419793 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:24:06.445242 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:24:06.445618 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:24:06.445819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:06.498500 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m00:24:06.499698 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:24:06.503158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:24:06.503604 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:24:06.509292 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:24:06.509587 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:24:06.509802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:06.556034 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m00:24:06.557405 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:24:06.557681 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:24:06.558186 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:24:06.558595 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:24:06.558879 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:24:06.559488 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:24:06.560117 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:24:06.560364 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:24:06.560558 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:24:06.560999 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:24:06.561234 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:24:06.565538 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:24:06.569915 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:24:06.570143 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:24:06.570365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:24:06.607882 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m00:24:06.608276 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:24:06.608536 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:24:06.626407 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m00:24:06.627754 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:24:06.628194 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:24:06.628413 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:24:06.630806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fb69700-17c6-47c2-885b-3cd1bf2ce04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7d98b2bc0>]}
[0m00:24:06.631194 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:06.631489 [debug] [MainThread]: On master: BEGIN
[0m00:24:06.631772 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:24:06.668837 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m00:24:06.669339 [debug] [MainThread]: On master: COMMIT
[0m00:24:06.669664 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:06.669880 [debug] [MainThread]: On master: COMMIT
[0m00:24:06.670371 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:24:06.670617 [debug] [MainThread]: On master: Close
[0m00:24:06.672866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:24:06.673181 [info ] [MainThread]: 
[0m00:24:06.675397 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:24:06.676026 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:24:06.676563 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:24:06.676830 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:24:06.684544 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:24:06.685100 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:24:06.708854 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:24:06.709413 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:24:06.709689 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:24:06.709920 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:24:06.743869 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m00:24:06.744356 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:24:06.744753 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m00:24:06.745557 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m00:24:06.745850 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:24:06.746194 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:24:06.747578 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:24:06.747831 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:24:06.749959 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m00:24:06.751184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fb69700-17c6-47c2-885b-3cd1bf2ce04d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7cd374550>]}
[0m00:24:06.751667 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.07s]
[0m00:24:06.752146 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:24:06.753590 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:24:06.753952 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:24:06.754365 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:24:06.754766 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:24:06.755150 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:24:06.755486 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:24:06.756551 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:06.756774 [debug] [MainThread]: On master: BEGIN
[0m00:24:06.756961 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:24:06.790834 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m00:24:06.791304 [debug] [MainThread]: On master: COMMIT
[0m00:24:06.791549 [debug] [MainThread]: Using duckdb connection "master"
[0m00:24:06.791760 [debug] [MainThread]: On master: COMMIT
[0m00:24:06.792273 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:24:06.792617 [debug] [MainThread]: On master: Close
[0m00:24:06.795112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:06.795356 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:24:06.795549 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:24:06.795854 [info ] [MainThread]: 
[0m00:24:06.796137 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m00:24:06.796730 [debug] [MainThread]: Command end result
[0m00:24:06.821110 [info ] [MainThread]: 
[0m00:24:06.821686 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:24:06.821995 [info ] [MainThread]: 
[0m00:24:06.822365 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m00:24:06.822688 [info ] [MainThread]: 
[0m00:24:06.822963 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:24:06.823604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.88504636, "process_user_time": 2.626476, "process_kernel_time": 0.188641, "process_mem_max_rss": "203592", "process_out_blocks": "2048", "command_success": false, "process_in_blocks": "0"}
[0m00:24:06.824000 [debug] [MainThread]: Command `dbt run` failed at 00:24:06.823925 after 0.89 seconds
[0m00:24:06.824320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7db45f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7da1b7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7d624dd50>]}
[0m00:24:06.824644 [debug] [MainThread]: Flushing usage events
[0m00:26:41.677597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9689f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f94dd2590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f94dd3be0>]}


============================== 00:26:41.680500 | bb02bfb4-cb47-4219-a525-3bb1d6288097 ==============================
[0m00:26:41.680500 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:26:41.681023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:26:41.841871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb02bfb4-cb47-4219-a525-3bb1d6288097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f967651e0>]}
[0m00:26:41.876984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb02bfb4-cb47-4219-a525-3bb1d6288097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f955f7610>]}
[0m00:26:41.880020 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:26:41.888765 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:26:42.002384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:26:42.002716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:26:42.007416 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:26:42.040319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb02bfb4-cb47-4219-a525-3bb1d6288097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f89334070>]}
[0m00:26:42.122248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb02bfb4-cb47-4219-a525-3bb1d6288097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f89312140>]}
[0m00:26:42.122678 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:26:42.122977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb02bfb4-cb47-4219-a525-3bb1d6288097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f893105e0>]}
[0m00:26:42.124399 [info ] [MainThread]: 
[0m00:26:42.124867 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:26:42.128855 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:26:42.158262 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:26:42.158655 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:26:42.158939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:42.212064 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m00:26:42.213251 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:26:42.215347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:26:42.215741 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:26:42.221138 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:26:42.221383 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:26:42.221595 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:26:42.255655 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m00:26:42.256907 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:26:42.257193 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:26:42.257687 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:26:42.258005 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:26:42.258280 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:26:42.258885 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:26:42.259536 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:26:42.259746 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:26:42.259936 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:26:42.260402 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:26:42.260736 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:26:42.263595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:26:42.268024 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:26:42.268279 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:26:42.268468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:26:42.305839 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m00:26:42.306310 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:26:42.306700 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:26:42.326656 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m00:26:42.327892 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:26:42.328878 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:26:42.329194 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:26:42.331837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb02bfb4-cb47-4219-a525-3bb1d6288097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f90f32bc0>]}
[0m00:26:42.332304 [debug] [MainThread]: Using duckdb connection "master"
[0m00:26:42.332515 [debug] [MainThread]: On master: BEGIN
[0m00:26:42.332738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:26:42.369702 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m00:26:42.370299 [debug] [MainThread]: On master: COMMIT
[0m00:26:42.370670 [debug] [MainThread]: Using duckdb connection "master"
[0m00:26:42.370911 [debug] [MainThread]: On master: COMMIT
[0m00:26:42.371402 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:26:42.371655 [debug] [MainThread]: On master: Close
[0m00:26:42.373663 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:26:42.373955 [info ] [MainThread]: 
[0m00:26:42.376628 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:26:42.377213 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:26:42.377704 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:26:42.378000 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:26:42.384370 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:26:42.385038 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:26:42.407409 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:26:42.408103 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:26:42.408394 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:26:42.408626 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:26:42.443204 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m00:26:42.443751 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:26:42.444114 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m00:26:42.446483 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "main"."main"."trades"
WHERE price > 0
  );

[0m00:26:42.446811 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:26:42.447151 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:26:42.452192 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:26:42.452452 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:26:42.454453 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m00:26:42.455685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb02bfb4-cb47-4219-a525-3bb1d6288097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f88780550>]}
[0m00:26:42.456181 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.08s]
[0m00:26:42.456648 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:26:42.458227 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:26:42.458683 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:26:42.459091 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:26:42.459402 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:26:42.459831 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:26:42.460237 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:26:42.461394 [debug] [MainThread]: Using duckdb connection "master"
[0m00:26:42.461634 [debug] [MainThread]: On master: BEGIN
[0m00:26:42.461824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:26:42.497959 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m00:26:42.498374 [debug] [MainThread]: On master: COMMIT
[0m00:26:42.498624 [debug] [MainThread]: Using duckdb connection "master"
[0m00:26:42.498835 [debug] [MainThread]: On master: COMMIT
[0m00:26:42.499311 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:26:42.499655 [debug] [MainThread]: On master: Close
[0m00:26:42.501818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:42.502064 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:26:42.502246 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:26:42.502528 [info ] [MainThread]: 
[0m00:26:42.502811 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m00:26:42.503376 [debug] [MainThread]: Command end result
[0m00:26:42.526432 [info ] [MainThread]: 
[0m00:26:42.526872 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:26:42.527194 [info ] [MainThread]: 
[0m00:26:42.527547 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Catalog "main" does not exist!
[0m00:26:42.527827 [info ] [MainThread]: 
[0m00:26:42.528157 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:26:42.529086 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.88673335, "process_user_time": 2.480961, "process_kernel_time": 0.143592, "process_mem_max_rss": "204000", "process_in_blocks": "151976", "process_out_blocks": "2056", "command_success": false}
[0m00:26:42.529512 [debug] [MainThread]: Command `dbt run` failed at 00:26:42.529433 after 0.89 seconds
[0m00:26:42.529793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f9689f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f955f7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2f89625d50>]}
[0m00:26:42.530057 [debug] [MainThread]: Flushing usage events
[0m00:29:16.471427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8801ea7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8802176590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8802177be0>]}


============================== 00:29:16.474329 | 4b71f764-2e6e-4f0d-bc61-dc456eea235f ==============================
[0m00:29:16.474329 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:29:16.474759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:29:16.628009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b71f764-2e6e-4f0d-bc61-dc456eea235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8801d6d1e0>]}
[0m00:29:16.662843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b71f764-2e6e-4f0d-bc61-dc456eea235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8800bff610>]}
[0m00:29:16.665475 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:29:16.674263 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:29:16.783508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:29:16.784320 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/sources.yml
[0m00:29:16.930537 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m00:29:16.931007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b71f764-2e6e-4f0d-bc61-dc456eea235f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8800371c90>]}
[0m00:29:17.152699 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:29:17.209673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b71f764-2e6e-4f0d-bc61-dc456eea235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f49b2140>]}
[0m00:29:17.288218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b71f764-2e6e-4f0d-bc61-dc456eea235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8800a38910>]}
[0m00:29:17.288624 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:29:17.288890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b71f764-2e6e-4f0d-bc61-dc456eea235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8800a392a0>]}
[0m00:29:17.290230 [info ] [MainThread]: 
[0m00:29:17.290697 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:29:17.294852 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:29:17.322679 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:29:17.323067 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:29:17.323259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:17.374215 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m00:29:17.375492 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:29:17.377677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:29:17.378085 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:29:17.382955 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:29:17.383195 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:29:17.383390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:17.419937 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m00:29:17.421563 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:29:17.421875 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:29:17.422385 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:29:17.422613 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:29:17.422824 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:29:17.423466 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:29:17.424258 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:29:17.424535 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:29:17.424730 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:29:17.425221 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:29:17.425548 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:29:17.428754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:29:17.433068 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:29:17.433284 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:29:17.433472 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:29:17.467173 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m00:29:17.467571 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:29:17.467809 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:29:17.487199 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:29:17.488382 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:29:17.489363 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:29:17.489670 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:29:17.491974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b71f764-2e6e-4f0d-bc61-dc456eea235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8801c7f460>]}
[0m00:29:17.492320 [debug] [MainThread]: Using duckdb connection "master"
[0m00:29:17.492521 [debug] [MainThread]: On master: BEGIN
[0m00:29:17.492714 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:29:17.528471 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m00:29:17.528968 [debug] [MainThread]: On master: COMMIT
[0m00:29:17.529359 [debug] [MainThread]: Using duckdb connection "master"
[0m00:29:17.529687 [debug] [MainThread]: On master: COMMIT
[0m00:29:17.530152 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:29:17.530390 [debug] [MainThread]: On master: Close
[0m00:29:17.533111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:29:17.533427 [info ] [MainThread]: 
[0m00:29:17.535806 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:29:17.536402 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:29:17.536954 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:29:17.537214 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:29:17.543149 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:29:17.543567 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:29:17.565898 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:29:17.566469 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:29:17.566747 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:29:17.567014 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:29:17.600611 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m00:29:17.601153 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:29:17.601522 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:29:17.617547 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:29:17.617898 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:29:17.618278 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:29:17.623553 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:29:17.623806 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:29:17.626299 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:29:17.627468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b71f764-2e6e-4f0d-bc61-dc456eea235f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88011e78e0>]}
[0m00:29:17.627952 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m00:29:17.628410 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:29:17.630061 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:29:17.630513 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:29:17.630910 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:29:17.631228 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:29:17.631522 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:29:17.631949 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:29:17.633148 [debug] [MainThread]: Using duckdb connection "master"
[0m00:29:17.633458 [debug] [MainThread]: On master: BEGIN
[0m00:29:17.633755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:29:17.667873 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m00:29:17.668421 [debug] [MainThread]: On master: COMMIT
[0m00:29:17.668716 [debug] [MainThread]: Using duckdb connection "master"
[0m00:29:17.668915 [debug] [MainThread]: On master: COMMIT
[0m00:29:17.669369 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:29:17.669605 [debug] [MainThread]: On master: Close
[0m00:29:17.671714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:17.672010 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:29:17.672204 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:29:17.672485 [info ] [MainThread]: 
[0m00:29:17.672766 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m00:29:17.673332 [debug] [MainThread]: Command end result
[0m00:29:17.696644 [info ] [MainThread]: 
[0m00:29:17.697083 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:29:17.697378 [info ] [MainThread]: 
[0m00:29:17.697709 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:29:17.697966 [info ] [MainThread]: 
[0m00:29:17.698299 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:29:17.699224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2618349, "process_user_time": 3.014161, "process_kernel_time": 0.19592, "process_mem_max_rss": "209012", "process_in_blocks": "152672", "process_out_blocks": "2944", "command_success": false}
[0m00:29:17.699623 [debug] [MainThread]: Command `dbt run` failed at 00:29:17.699547 after 1.26 seconds
[0m00:29:17.699965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8801ea7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8800bff610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88002eeb60>]}
[0m00:29:17.700279 [debug] [MainThread]: Flushing usage events
[0m00:37:06.148477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e25513430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e23a47970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e23a46f20>]}


============================== 00:37:06.151198 | f3edb59a-5bfa-4196-82cd-fdf8a16a88e8 ==============================
[0m00:37:06.151198 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:37:06.151533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:37:06.303974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3edb59a-5bfa-4196-82cd-fdf8a16a88e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1fb276a0>]}
[0m00:37:06.339503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3edb59a-5bfa-4196-82cd-fdf8a16a88e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e24872c20>]}
[0m00:37:06.342427 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:37:06.351169 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:37:06.463976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:37:06.464329 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:37:06.469046 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:37:06.500741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3edb59a-5bfa-4196-82cd-fdf8a16a88e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e17f34130>]}
[0m00:37:06.582783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3edb59a-5bfa-4196-82cd-fdf8a16a88e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e17f4a770>]}
[0m00:37:06.583191 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:37:06.583452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3edb59a-5bfa-4196-82cd-fdf8a16a88e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e17f4a890>]}
[0m00:37:06.584815 [info ] [MainThread]: 
[0m00:37:06.585238 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:37:06.588769 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:37:06.617214 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:37:06.617687 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:37:06.617876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:06.669561 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m00:37:06.670916 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:37:06.673526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:37:06.673872 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:37:06.679236 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:37:06.679470 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:37:06.679668 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:06.713881 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m00:37:06.715147 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:37:06.715418 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:37:06.716023 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:37:06.716351 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:37:06.716666 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:37:06.717283 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:37:06.717895 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:37:06.718114 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:37:06.718380 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:37:06.718854 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:37:06.719085 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:37:06.723020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:37:06.727566 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:37:06.727798 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:37:06.727987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:37:06.761464 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m00:37:06.761978 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:37:06.762359 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:37:06.781615 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:37:06.782820 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:37:06.783871 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:37:06.784177 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:37:06.786625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3edb59a-5bfa-4196-82cd-fdf8a16a88e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e1fb67910>]}
[0m00:37:06.787042 [debug] [MainThread]: Using duckdb connection "master"
[0m00:37:06.787352 [debug] [MainThread]: On master: BEGIN
[0m00:37:06.787635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:37:06.822823 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m00:37:06.823247 [debug] [MainThread]: On master: COMMIT
[0m00:37:06.823531 [debug] [MainThread]: Using duckdb connection "master"
[0m00:37:06.823823 [debug] [MainThread]: On master: COMMIT
[0m00:37:06.824342 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:37:06.824663 [debug] [MainThread]: On master: Close
[0m00:37:06.826484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:37:06.826770 [info ] [MainThread]: 
[0m00:37:06.829017 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:37:06.829463 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:37:06.829984 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:37:06.830227 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:37:06.836315 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:37:06.836748 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:37:06.857444 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:37:06.857958 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:37:06.858234 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:37:06.858499 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:37:06.894832 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m00:37:06.895400 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:37:06.895757 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:37:06.912334 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:37:06.912622 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:37:06.913003 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:37:06.918072 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:37:06.918372 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:37:06.920874 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:37:06.922060 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3edb59a-5bfa-4196-82cd-fdf8a16a88e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e17380460>]}
[0m00:37:06.922527 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m00:37:06.923002 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:37:06.924534 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:37:06.924819 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:37:06.925168 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:37:06.925495 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:37:06.925786 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:37:06.926250 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:37:06.927662 [debug] [MainThread]: Using duckdb connection "master"
[0m00:37:06.927897 [debug] [MainThread]: On master: BEGIN
[0m00:37:06.928128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:37:06.964036 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m00:37:06.964657 [debug] [MainThread]: On master: COMMIT
[0m00:37:06.964920 [debug] [MainThread]: Using duckdb connection "master"
[0m00:37:06.965130 [debug] [MainThread]: On master: COMMIT
[0m00:37:06.965640 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:37:06.965980 [debug] [MainThread]: On master: Close
[0m00:37:06.968269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:06.968478 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:37:06.968653 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:37:06.968929 [info ] [MainThread]: 
[0m00:37:06.969219 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m00:37:06.969815 [debug] [MainThread]: Command end result
[0m00:37:06.992418 [info ] [MainThread]: 
[0m00:37:06.992849 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:37:06.993145 [info ] [MainThread]: 
[0m00:37:06.993487 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:37:06.993765 [info ] [MainThread]: 
[0m00:37:06.994054 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:37:06.995030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8809553, "process_user_time": 2.27962, "process_kernel_time": 0.213048, "process_mem_max_rss": "207612", "process_in_blocks": "152448", "process_out_blocks": "2056", "command_success": false}
[0m00:37:06.995682 [debug] [MainThread]: Command `dbt run` failed at 00:37:06.995564 after 0.88 seconds
[0m00:37:06.996031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e25513430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e24d9aa40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e172743d0>]}
[0m00:37:06.996289 [debug] [MainThread]: Flushing usage events
[0m00:40:35.199853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7bc9b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7a1cbd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7a1cb550>]}


============================== 00:40:35.202092 | a48d5081-b3bb-4b04-a428-7ce4a5f1e106 ==============================
[0m00:40:35.202092 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:40:35.202589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:40:35.361686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a48d5081-b3bb-4b04-a428-7ce4a5f1e106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf76327010>]}
[0m00:40:35.399119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a48d5081-b3bb-4b04-a428-7ce4a5f1e106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7a5afdf0>]}
[0m00:40:35.401596 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:40:35.410942 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:40:35.528896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:40:35.529227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:40:35.535139 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:40:35.570255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a48d5081-b3bb-4b04-a428-7ce4a5f1e106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6e734130>]}
[0m00:40:35.657874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a48d5081-b3bb-4b04-a428-7ce4a5f1e106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6e710610>]}
[0m00:40:35.658311 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:40:35.658657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a48d5081-b3bb-4b04-a428-7ce4a5f1e106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6e713760>]}
[0m00:40:35.660178 [info ] [MainThread]: 
[0m00:40:35.660629 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:40:35.664611 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:40:35.695970 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:40:35.696359 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:40:35.696574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:35.769218 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m00:40:35.770441 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:40:35.772611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:40:35.772990 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:40:35.778373 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:40:35.778617 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:40:35.778815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:35.816922 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m00:40:35.818183 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:40:35.818444 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:40:35.818980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:40:35.819210 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:40:35.819406 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:40:35.819909 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:40:35.820485 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:40:35.820687 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:40:35.820870 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:40:35.821384 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:40:35.821706 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:40:35.824716 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:40:35.828890 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:40:35.829123 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:40:35.829312 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:40:35.865209 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m00:40:35.865711 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:40:35.866119 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:40:35.886080 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m00:40:35.887368 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:40:35.888426 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:40:35.888745 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:40:35.891177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a48d5081-b3bb-4b04-a428-7ce4a5f1e106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6e74d870>]}
[0m00:40:35.891648 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:35.891869 [debug] [MainThread]: On master: BEGIN
[0m00:40:35.892057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:40:35.925739 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m00:40:35.926214 [debug] [MainThread]: On master: COMMIT
[0m00:40:35.926508 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:35.926771 [debug] [MainThread]: On master: COMMIT
[0m00:40:35.927237 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:40:35.927568 [debug] [MainThread]: On master: Close
[0m00:40:35.930020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:40:35.930310 [info ] [MainThread]: 
[0m00:40:35.932830 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:40:35.933339 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:40:35.933832 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:40:35.934125 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:40:35.940606 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:40:35.941044 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:40:35.961830 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:40:35.962514 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:40:35.962811 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:40:35.963053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:40:35.999314 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m00:40:35.999746 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:40:36.000082 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:40:36.016617 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:40:36.017013 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:40:36.017409 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:40:36.023591 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:40:36.023859 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:40:36.026309 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:40:36.027481 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a48d5081-b3bb-4b04-a428-7ce4a5f1e106', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6db88460>]}
[0m00:40:36.027948 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m00:40:36.028408 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:40:36.030021 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:40:36.030323 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:40:36.030653 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:40:36.030977 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:40:36.031353 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:40:36.031677 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:40:36.032842 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:36.033063 [debug] [MainThread]: On master: BEGIN
[0m00:40:36.033254 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:40:36.067722 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m00:40:36.068175 [debug] [MainThread]: On master: COMMIT
[0m00:40:36.068494 [debug] [MainThread]: Using duckdb connection "master"
[0m00:40:36.068824 [debug] [MainThread]: On master: COMMIT
[0m00:40:36.069308 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:40:36.069632 [debug] [MainThread]: On master: Close
[0m00:40:36.071544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:36.071758 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:40:36.071936 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:40:36.072214 [info ] [MainThread]: 
[0m00:40:36.072494 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m00:40:36.073082 [debug] [MainThread]: Command end result
[0m00:40:36.097014 [info ] [MainThread]: 
[0m00:40:36.097537 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:40:36.097894 [info ] [MainThread]: 
[0m00:40:36.098375 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:40:36.098669 [info ] [MainThread]: 
[0m00:40:36.098955 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:40:36.099591 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.94137454, "process_user_time": 2.59025, "process_kernel_time": 0.203156, "process_mem_max_rss": "203072", "process_in_blocks": "109872", "process_out_blocks": "2072", "command_success": false}
[0m00:40:36.099993 [debug] [MainThread]: Command `dbt run` failed at 00:40:36.099918 after 0.94 seconds
[0m00:40:36.100262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7bc9b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf7b5246d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdf6e797520>]}
[0m00:40:36.100525 [debug] [MainThread]: Flushing usage events
[0m00:43:14.479005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81445774c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8142aab130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8142aaa080>]}


============================== 00:43:14.482265 | 1ce1b1b5-0f41-4494-96fd-8e60cb7343ec ==============================
[0m00:43:14.482265 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:43:14.482766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:43:14.643111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ce1b1b5-0f41-4494-96fd-8e60cb7343ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81448437c0>]}
[0m00:43:14.679583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ce1b1b5-0f41-4494-96fd-8e60cb7343ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813f44e890>]}
[0m00:43:14.682303 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:43:14.690395 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:43:14.807597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:43:14.807923 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:43:14.813407 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:43:14.846666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ce1b1b5-0f41-4494-96fd-8e60cb7343ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813f4d0d30>]}
[0m00:43:14.929967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ce1b1b5-0f41-4494-96fd-8e60cb7343ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8137016860>]}
[0m00:43:14.930368 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:43:14.930638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce1b1b5-0f41-4494-96fd-8e60cb7343ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81370168c0>]}
[0m00:43:14.931966 [info ] [MainThread]: 
[0m00:43:14.932423 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:43:14.936493 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:43:14.966788 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:43:14.967151 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:43:14.967369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:15.022668 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m00:43:15.023906 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:43:15.026154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:43:15.026572 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:43:15.032676 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:43:15.032911 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:43:15.033108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:43:15.070275 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m00:43:15.071663 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:43:15.071938 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:43:15.072484 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:43:15.072795 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:43:15.073066 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:43:15.073703 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:43:15.074705 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:43:15.074930 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:43:15.075128 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:43:15.075520 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:43:15.075775 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:43:15.078484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:43:15.083295 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:43:15.083531 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:43:15.083718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:43:15.125043 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m00:43:15.125569 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:43:15.125861 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:43:15.146464 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m00:43:15.147829 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:43:15.148737 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:43:15.149060 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:43:15.151539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce1b1b5-0f41-4494-96fd-8e60cb7343ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813f4d2260>]}
[0m00:43:15.151999 [debug] [MainThread]: Using duckdb connection "master"
[0m00:43:15.152295 [debug] [MainThread]: On master: BEGIN
[0m00:43:15.152633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:43:15.193665 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m00:43:15.194082 [debug] [MainThread]: On master: COMMIT
[0m00:43:15.194395 [debug] [MainThread]: Using duckdb connection "master"
[0m00:43:15.194692 [debug] [MainThread]: On master: COMMIT
[0m00:43:15.195219 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:43:15.195629 [debug] [MainThread]: On master: Close
[0m00:43:15.198008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:43:15.198304 [info ] [MainThread]: 
[0m00:43:15.200771 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:43:15.201228 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:43:15.201770 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:43:15.202055 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:43:15.208606 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:43:15.209066 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:43:15.229901 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:43:15.230438 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:43:15.230706 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:43:15.230936 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:43:15.278040 [debug] [Thread-1 (]: SQL status: OK in 0.047 seconds
[0m00:43:15.278619 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:43:15.278943 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:43:15.295244 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:43:15.295732 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:43:15.296084 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:43:15.301308 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:43:15.301564 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:43:15.304503 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:43:15.305854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ce1b1b5-0f41-4494-96fd-8e60cb7343ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81364844f0>]}
[0m00:43:15.306349 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.10s]
[0m00:43:15.306825 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:43:15.308362 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:43:15.308704 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:43:15.309051 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:43:15.309368 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:43:15.309727 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:43:15.310254 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:43:15.311820 [debug] [MainThread]: Using duckdb connection "master"
[0m00:43:15.312163 [debug] [MainThread]: On master: BEGIN
[0m00:43:15.312378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:43:15.347995 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m00:43:15.348540 [debug] [MainThread]: On master: COMMIT
[0m00:43:15.348898 [debug] [MainThread]: Using duckdb connection "master"
[0m00:43:15.349149 [debug] [MainThread]: On master: COMMIT
[0m00:43:15.349669 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:43:15.350025 [debug] [MainThread]: On master: Close
[0m00:43:15.352377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:43:15.352875 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:43:15.353382 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:43:15.354373 [info ] [MainThread]: 
[0m00:43:15.354958 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m00:43:15.355578 [debug] [MainThread]: Command end result
[0m00:43:15.378355 [info ] [MainThread]: 
[0m00:43:15.378799 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:43:15.379124 [info ] [MainThread]: 
[0m00:43:15.379464 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:43:15.379726 [info ] [MainThread]: 
[0m00:43:15.380001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:43:15.380929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.93778205, "process_user_time": 2.704755, "process_kernel_time": 0.159999, "process_mem_max_rss": "210380", "process_in_blocks": "152416", "process_out_blocks": "2048", "command_success": false}
[0m00:43:15.381527 [debug] [MainThread]: Command `dbt run` failed at 00:43:15.381407 after 0.94 seconds
[0m00:43:15.381954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81445774c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813f44e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f813f48e530>]}
[0m00:43:15.382315 [debug] [MainThread]: Flushing usage events
[0m00:48:58.968343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b3157520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b168e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b168fbe0>]}


============================== 00:48:58.971495 | d04de57c-4fd8-4e68-9ab6-459a23e845dd ==============================
[0m00:48:58.971495 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:48:58.972033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:48:59.128817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd04de57c-4fd8-4e68-9ab6-459a23e845dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b301d1e0>]}
[0m00:48:59.165132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd04de57c-4fd8-4e68-9ab6-459a23e845dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b1eab610>]}
[0m00:48:59.168205 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:48:59.176332 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:48:59.292622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:48:59.292949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:48:59.297673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:48:59.329854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd04de57c-4fd8-4e68-9ab6-459a23e845dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a5c34070>]}
[0m00:48:59.412630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd04de57c-4fd8-4e68-9ab6-459a23e845dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a5c13b20>]}
[0m00:48:59.413050 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:48:59.413353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04de57c-4fd8-4e68-9ab6-459a23e845dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a5c11f00>]}
[0m00:48:59.414809 [info ] [MainThread]: 
[0m00:48:59.415280 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:48:59.420236 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:48:59.450954 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:48:59.451378 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:48:59.451614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:48:59.510446 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m00:48:59.511800 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:48:59.514457 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:48:59.514857 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:48:59.521318 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:48:59.521729 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:48:59.521969 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:59.562041 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m00:48:59.563390 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:48:59.563728 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:48:59.564382 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:48:59.564639 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:48:59.564927 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:48:59.565618 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:48:59.566672 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:48:59.566941 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:48:59.567188 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:48:59.567730 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:48:59.568224 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:48:59.573968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:48:59.580313 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:48:59.580674 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:48:59.580974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:48:59.622082 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m00:48:59.622605 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:48:59.622998 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:48:59.650130 [debug] [ThreadPool]: SQL status: OK in 0.027 seconds
[0m00:48:59.651643 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:48:59.652804 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:48:59.653253 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:48:59.657005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04de57c-4fd8-4e68-9ab6-459a23e845dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ae03abc0>]}
[0m00:48:59.657712 [debug] [MainThread]: Using duckdb connection "master"
[0m00:48:59.658077 [debug] [MainThread]: On master: BEGIN
[0m00:48:59.658420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:48:59.700408 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m00:48:59.700858 [debug] [MainThread]: On master: COMMIT
[0m00:48:59.701272 [debug] [MainThread]: Using duckdb connection "master"
[0m00:48:59.701533 [debug] [MainThread]: On master: COMMIT
[0m00:48:59.702089 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:48:59.702338 [debug] [MainThread]: On master: Close
[0m00:48:59.705077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:48:59.705398 [info ] [MainThread]: 
[0m00:48:59.707838 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:48:59.708387 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:48:59.708928 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:48:59.709192 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:48:59.716358 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:48:59.716998 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:48:59.745742 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:48:59.746618 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:48:59.747128 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:48:59.747432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:48:59.788906 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m00:48:59.789512 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:48:59.790015 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:48:59.813784 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:48:59.814336 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:48:59.815019 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:48:59.820704 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:48:59.821043 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:48:59.825357 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:48:59.827090 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04de57c-4fd8-4e68-9ab6-459a23e845dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a5080550>]}
[0m00:48:59.827715 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.12s]
[0m00:48:59.828387 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:48:59.830113 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:48:59.830596 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:48:59.831040 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:48:59.831434 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:48:59.831882 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:48:59.832311 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:48:59.833899 [debug] [MainThread]: Using duckdb connection "master"
[0m00:48:59.834313 [debug] [MainThread]: On master: BEGIN
[0m00:48:59.834689 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:48:59.877544 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m00:48:59.878014 [debug] [MainThread]: On master: COMMIT
[0m00:48:59.878333 [debug] [MainThread]: Using duckdb connection "master"
[0m00:48:59.878635 [debug] [MainThread]: On master: COMMIT
[0m00:48:59.879436 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:48:59.879788 [debug] [MainThread]: On master: Close
[0m00:48:59.882301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:48:59.882605 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:48:59.882800 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:48:59.883118 [info ] [MainThread]: 
[0m00:48:59.883457 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m00:48:59.884149 [debug] [MainThread]: Command end result
[0m00:48:59.916207 [info ] [MainThread]: 
[0m00:48:59.916661 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:48:59.917003 [info ] [MainThread]: 
[0m00:48:59.917466 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:48:59.917829 [info ] [MainThread]: 
[0m00:48:59.918135 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:48:59.918987 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.98912954, "process_user_time": 2.694646, "process_kernel_time": 0.216467, "process_mem_max_rss": "203824", "process_in_blocks": "40440", "process_out_blocks": "2056", "command_success": false}
[0m00:48:59.919581 [debug] [MainThread]: Command `dbt run` failed at 00:48:59.919461 after 0.99 seconds
[0m00:48:59.919939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b3157520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84b1eab610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84a5f25d50>]}
[0m00:48:59.920256 [debug] [MainThread]: Flushing usage events
[0m00:53:54.208283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd33b9df4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd339f13130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd339f12080>]}


============================== 00:53:54.211289 | 80b8ef67-2481-4a34-9719-0079af5ef3f6 ==============================
[0m00:53:54.211289 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:53:54.211808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:53:54.368606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80b8ef67-2481-4a34-9719-0079af5ef3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd33bcab7c0>]}
[0m00:53:54.404364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80b8ef67-2481-4a34-9719-0079af5ef3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3368b6890>]}
[0m00:53:54.407267 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:53:54.415751 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:53:54.529503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:53:54.529832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:53:54.535356 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:53:54.567597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80b8ef67-2481-4a34-9719-0079af5ef3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd336938d30>]}
[0m00:53:54.652518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80b8ef67-2481-4a34-9719-0079af5ef3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32e416860>]}
[0m00:53:54.652995 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:53:54.653387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80b8ef67-2481-4a34-9719-0079af5ef3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32e4168c0>]}
[0m00:53:54.654843 [info ] [MainThread]: 
[0m00:53:54.655301 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:53:54.659214 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:53:54.689525 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:53:54.689950 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:53:54.690142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:53:54.735343 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m00:53:54.736487 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:53:54.740526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:53:54.740935 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:53:54.746468 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:53:54.746715 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:53:54.746913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:53:54.782405 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m00:53:54.783679 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:53:54.783971 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:53:54.784874 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:53:54.785195 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:53:54.785485 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:53:54.786035 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:53:54.786973 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:53:54.787187 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:53:54.787379 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:53:54.787818 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:53:54.788043 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:53:54.790901 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:53:54.795350 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:53:54.795571 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:53:54.795756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:53:54.829967 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m00:53:54.830485 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:53:54.830737 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:53:54.848734 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m00:53:54.849927 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:53:54.850841 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:53:54.851144 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:53:54.853806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80b8ef67-2481-4a34-9719-0079af5ef3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd33693a260>]}
[0m00:53:54.854203 [debug] [MainThread]: Using duckdb connection "master"
[0m00:53:54.854533 [debug] [MainThread]: On master: BEGIN
[0m00:53:54.854730 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:53:54.888134 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m00:53:54.888633 [debug] [MainThread]: On master: COMMIT
[0m00:53:54.889012 [debug] [MainThread]: Using duckdb connection "master"
[0m00:53:54.889253 [debug] [MainThread]: On master: COMMIT
[0m00:53:54.889752 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:53:54.890089 [debug] [MainThread]: On master: Close
[0m00:53:54.891922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:53:54.892208 [info ] [MainThread]: 
[0m00:53:54.894876 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:53:54.895438 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:53:54.895998 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:53:54.896249 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:53:54.902839 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:53:54.903291 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:53:54.925008 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:53:54.925580 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:53:54.925859 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:53:54.926120 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:53:54.960947 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m00:53:54.961434 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:53:54.961773 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:53:54.979523 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:53:54.979861 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:53:54.980246 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:53:54.985368 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:53:54.985704 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:53:54.988362 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:53:54.989536 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80b8ef67-2481-4a34-9719-0079af5ef3f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd32d8844f0>]}
[0m00:53:54.990011 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m00:53:54.990521 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:53:54.992032 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:53:54.992317 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:53:54.992642 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:53:54.992993 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:53:54.993442 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:53:54.993757 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:53:54.994970 [debug] [MainThread]: Using duckdb connection "master"
[0m00:53:54.995197 [debug] [MainThread]: On master: BEGIN
[0m00:53:54.995434 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:53:55.029561 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m00:53:55.030020 [debug] [MainThread]: On master: COMMIT
[0m00:53:55.030300 [debug] [MainThread]: Using duckdb connection "master"
[0m00:53:55.030543 [debug] [MainThread]: On master: COMMIT
[0m00:53:55.031038 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:53:55.031414 [debug] [MainThread]: On master: Close
[0m00:53:55.033699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:53:55.033923 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:53:55.034104 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:53:55.034437 [info ] [MainThread]: 
[0m00:53:55.034728 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m00:53:55.035309 [debug] [MainThread]: Command end result
[0m00:53:55.058610 [info ] [MainThread]: 
[0m00:53:55.059079 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:53:55.059403 [info ] [MainThread]: 
[0m00:53:55.059779 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:53:55.060079 [info ] [MainThread]: 
[0m00:53:55.060360 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:53:55.061284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8894442, "process_user_time": 2.325626, "process_kernel_time": 0.157768, "process_mem_max_rss": "204920", "process_in_blocks": "48608", "process_out_blocks": "2080", "command_success": false}
[0m00:53:55.061829 [debug] [MainThread]: Command `dbt run` failed at 00:53:55.061744 after 0.89 seconds
[0m00:53:55.062135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd33b9df4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3368b6890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3368f6530>]}
[0m00:53:55.062398 [debug] [MainThread]: Flushing usage events
[0m00:55:01.466935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6c574c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6fd3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6fd2080>]}


============================== 00:55:01.469845 | 85021a39-95a5-456d-abc2-33e8ae1ccf44 ==============================
[0m00:55:01.469845 [info ] [MainThread]: Running with dbt=1.8.8
[0m00:55:01.470215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:55:01.623201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85021a39-95a5-456d-abc2-33e8ae1ccf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf55c37c0>]}
[0m00:55:01.659794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85021a39-95a5-456d-abc2-33e8ae1ccf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf524a890>]}
[0m00:55:01.662328 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m00:55:01.671190 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m00:55:01.786862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:55:01.787219 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:55:01.792330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m00:55:01.826086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85021a39-95a5-456d-abc2-33e8ae1ccf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be9b621a0>]}
[0m00:55:01.913591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85021a39-95a5-456d-abc2-33e8ae1ccf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be98c2860>]}
[0m00:55:01.914003 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m00:55:01.914275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85021a39-95a5-456d-abc2-33e8ae1ccf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be98c28c0>]}
[0m00:55:01.915622 [info ] [MainThread]: 
[0m00:55:01.916072 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:55:01.919935 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m00:55:01.950177 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m00:55:01.950574 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m00:55:01.950819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:55:02.003381 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m00:55:02.004724 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m00:55:02.006874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m00:55:02.007402 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m00:55:02.012998 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:55:02.013263 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m00:55:02.013461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:02.048888 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m00:55:02.050129 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:55:02.050414 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m00:55:02.050928 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:55:02.051154 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:55:02.051352 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m00:55:02.052087 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:55:02.052822 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:55:02.053095 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m00:55:02.053297 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m00:55:02.053851 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:55:02.054173 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m00:55:02.058831 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m00:55:02.063424 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:55:02.063744 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m00:55:02.063980 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:55:02.101411 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m00:55:02.101797 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m00:55:02.102036 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m00:55:02.121624 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:55:02.123096 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m00:55:02.124390 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m00:55:02.124789 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m00:55:02.128365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85021a39-95a5-456d-abc2-33e8ae1ccf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be9b62c80>]}
[0m00:55:02.129273 [debug] [MainThread]: Using duckdb connection "master"
[0m00:55:02.129602 [debug] [MainThread]: On master: BEGIN
[0m00:55:02.129824 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:55:02.166982 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m00:55:02.167746 [debug] [MainThread]: On master: COMMIT
[0m00:55:02.168035 [debug] [MainThread]: Using duckdb connection "master"
[0m00:55:02.168262 [debug] [MainThread]: On master: COMMIT
[0m00:55:02.168953 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:55:02.169301 [debug] [MainThread]: On master: Close
[0m00:55:02.171584 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:55:02.171887 [info ] [MainThread]: 
[0m00:55:02.175143 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m00:55:02.176276 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m00:55:02.177368 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m00:55:02.177983 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m00:55:02.187323 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m00:55:02.188063 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m00:55:02.211576 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m00:55:02.212333 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:55:02.212629 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m00:55:02.212850 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:55:02.253635 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m00:55:02.254189 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m00:55:02.254587 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:55:02.272729 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m00:55:02.273339 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:55:02.273834 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m00:55:02.279499 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m00:55:02.279971 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m00:55:02.284132 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:55:02.285703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85021a39-95a5-456d-abc2-33e8ae1ccf44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be8b4c4f0>]}
[0m00:55:02.286265 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.11s]
[0m00:55:02.286782 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m00:55:02.288612 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m00:55:02.289110 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m00:55:02.289553 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m00:55:02.289895 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m00:55:02.290297 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m00:55:02.290683 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m00:55:02.291854 [debug] [MainThread]: Using duckdb connection "master"
[0m00:55:02.292086 [debug] [MainThread]: On master: BEGIN
[0m00:55:02.292283 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:55:02.329885 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m00:55:02.330407 [debug] [MainThread]: On master: COMMIT
[0m00:55:02.330848 [debug] [MainThread]: Using duckdb connection "master"
[0m00:55:02.331132 [debug] [MainThread]: On master: COMMIT
[0m00:55:02.331847 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:55:02.332238 [debug] [MainThread]: On master: Close
[0m00:55:02.334145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:55:02.334532 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m00:55:02.334778 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m00:55:02.335070 [info ] [MainThread]: 
[0m00:55:02.335364 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m00:55:02.335953 [debug] [MainThread]: Command end result
[0m00:55:02.361186 [info ] [MainThread]: 
[0m00:55:02.361781 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:55:02.362218 [info ] [MainThread]: 
[0m00:55:02.362654 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m00:55:02.362961 [info ] [MainThread]: 
[0m00:55:02.363265 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m00:55:02.364320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9318799, "process_user_time": 2.621129, "process_kernel_time": 0.162495, "process_mem_max_rss": "208200", "process_in_blocks": "151264", "process_out_blocks": "2056", "command_success": false}
[0m00:55:02.364804 [debug] [MainThread]: Command `dbt run` failed at 00:55:02.364681 after 0.93 seconds
[0m00:55:02.365117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf6c574c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6bf524a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6be9b12530>]}
[0m00:55:02.365425 [debug] [MainThread]: Flushing usage events
[0m01:02:23.651842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5eaf43430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5eb20f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5eb20ef20>]}


============================== 01:02:23.655265 | f6f6af6b-0448-48d2-bf48-951e6d0a93af ==============================
[0m01:02:23.655265 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:02:23.655763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:02:23.826701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6f6af6b-0448-48d2-bf48-951e6d0a93af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e938b6a0>]}
[0m01:02:23.863187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6f6af6b-0448-48d2-bf48-951e6d0a93af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ea0a6c20>]}
[0m01:02:23.866121 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:02:23.874828 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:02:23.993388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:02:23.993714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:02:23.998875 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:02:24.033922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6f6af6b-0448-48d2-bf48-951e6d0a93af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5dd94c130>]}
[0m01:02:24.121314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6f6af6b-0448-48d2-bf48-951e6d0a93af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5dd962770>]}
[0m01:02:24.121799 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:02:24.122134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f6af6b-0448-48d2-bf48-951e6d0a93af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5dd962890>]}
[0m01:02:24.123554 [info ] [MainThread]: 
[0m01:02:24.124040 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:02:24.128888 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:02:24.160713 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:02:24.161115 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:02:24.161332 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:02:24.222511 [debug] [ThreadPool]: SQL status: OK in 0.061 seconds
[0m01:02:24.223754 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:02:24.226052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:02:24.226445 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:02:24.231727 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:02:24.231972 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:02:24.232169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:24.266045 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:02:24.267352 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:02:24.267639 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:02:24.268180 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:02:24.268474 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:02:24.268691 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:02:24.269206 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:02:24.269809 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:02:24.270014 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:02:24.270201 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:02:24.270681 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:02:24.270907 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:02:24.273955 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:02:24.278306 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:02:24.278661 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:02:24.278872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:02:24.314058 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:02:24.314542 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:02:24.314858 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:02:24.332445 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:02:24.333656 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:02:24.334762 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:02:24.334984 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:02:24.337467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6f6af6b-0448-48d2-bf48-951e6d0a93af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e93cf910>]}
[0m01:02:24.337941 [debug] [MainThread]: Using duckdb connection "master"
[0m01:02:24.338274 [debug] [MainThread]: On master: BEGIN
[0m01:02:24.338528 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:02:24.372887 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m01:02:24.373359 [debug] [MainThread]: On master: COMMIT
[0m01:02:24.373722 [debug] [MainThread]: Using duckdb connection "master"
[0m01:02:24.373937 [debug] [MainThread]: On master: COMMIT
[0m01:02:24.374451 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:02:24.374766 [debug] [MainThread]: On master: Close
[0m01:02:24.376989 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:02:24.377292 [info ] [MainThread]: 
[0m01:02:24.379517 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:02:24.379984 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:02:24.380485 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:02:24.380738 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:02:24.387122 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:02:24.387965 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:02:24.411474 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:02:24.412069 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:02:24.412327 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:02:24.412561 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:02:24.448407 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m01:02:24.448966 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:02:24.449411 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:02:24.466028 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:02:24.466401 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:02:24.466844 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:02:24.471825 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:02:24.472081 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:02:24.474677 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:02:24.475864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6f6af6b-0448-48d2-bf48-951e6d0a93af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5dcd90460>]}
[0m01:02:24.476322 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m01:02:24.476771 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:02:24.478343 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:02:24.478860 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:02:24.479364 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:02:24.479791 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:02:24.480132 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:02:24.480559 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:02:24.481593 [debug] [MainThread]: Using duckdb connection "master"
[0m01:02:24.481829 [debug] [MainThread]: On master: BEGIN
[0m01:02:24.482027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:02:24.517438 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:02:24.517834 [debug] [MainThread]: On master: COMMIT
[0m01:02:24.518038 [debug] [MainThread]: Using duckdb connection "master"
[0m01:02:24.518228 [debug] [MainThread]: On master: COMMIT
[0m01:02:24.518769 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:02:24.519084 [debug] [MainThread]: On master: Close
[0m01:02:24.520907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:02:24.521121 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:02:24.521300 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:02:24.521581 [info ] [MainThread]: 
[0m01:02:24.521864 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m01:02:24.522437 [debug] [MainThread]: Command end result
[0m01:02:24.546375 [info ] [MainThread]: 
[0m01:02:24.546857 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:02:24.547174 [info ] [MainThread]: 
[0m01:02:24.547505 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:02:24.547763 [info ] [MainThread]: 
[0m01:02:24.548038 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:02:24.548876 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.93532217, "process_user_time": 2.313791, "process_kernel_time": 0.252831, "process_mem_max_rss": "204408", "process_in_blocks": "52560", "process_out_blocks": "2048", "command_success": false}
[0m01:02:24.549283 [debug] [MainThread]: Command `dbt run` failed at 01:02:24.549207 after 0.94 seconds
[0m01:02:24.549578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5eaf43430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5e939e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5dd9af190>]}
[0m01:02:24.549829 [debug] [MainThread]: Flushing usage events
[0m01:04:23.854000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf1def4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf20be050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf20bfdc0>]}


============================== 01:04:23.856564 | ce80b74f-288f-469b-b7ab-24d0ddbcfd79 ==============================
[0m01:04:23.856564 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:04:23.856912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:04:24.021078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce80b74f-288f-469b-b7ab-24d0ddbcfd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf1cb51e0>]}
[0m01:04:24.057691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce80b74f-288f-469b-b7ab-24d0ddbcfd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf0f735b0>]}
[0m01:04:24.060760 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:04:24.069766 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:04:24.186410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:04:24.186784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:04:24.192064 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:04:24.223976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce80b74f-288f-469b-b7ab-24d0ddbcfd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be484c130>]}
[0m01:04:24.309108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce80b74f-288f-469b-b7ab-24d0ddbcfd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be4829150>]}
[0m01:04:24.309532 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:04:24.309834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce80b74f-288f-469b-b7ab-24d0ddbcfd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be4829210>]}
[0m01:04:24.311298 [info ] [MainThread]: 
[0m01:04:24.311772 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:04:24.315855 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:04:24.349247 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:04:24.349630 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:04:24.349836 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:04:24.436724 [debug] [ThreadPool]: SQL status: OK in 0.087 seconds
[0m01:04:24.438212 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:04:24.441076 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:04:24.441671 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:04:24.448631 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:04:24.448957 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:04:24.449265 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:24.500785 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m01:04:24.502396 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:04:24.502771 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:04:24.503439 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:04:24.503851 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:04:24.504249 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:04:24.504935 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:04:24.505889 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:04:24.506161 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:04:24.506503 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:04:24.507087 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:04:24.507650 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:04:24.511554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:04:24.517623 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:04:24.517951 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:04:24.518190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:04:24.562699 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m01:04:24.563347 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:04:24.563979 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:04:24.594146 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m01:04:24.596001 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:04:24.597557 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:04:24.597870 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:04:24.601370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce80b74f-288f-469b-b7ab-24d0ddbcfd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be4b7ea40>]}
[0m01:04:24.602418 [debug] [MainThread]: Using duckdb connection "master"
[0m01:04:24.602742 [debug] [MainThread]: On master: BEGIN
[0m01:04:24.603007 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:04:24.646193 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m01:04:24.646804 [debug] [MainThread]: On master: COMMIT
[0m01:04:24.647246 [debug] [MainThread]: Using duckdb connection "master"
[0m01:04:24.647736 [debug] [MainThread]: On master: COMMIT
[0m01:04:24.648628 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:04:24.649362 [debug] [MainThread]: On master: Close
[0m01:04:24.651849 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:04:24.652263 [info ] [MainThread]: 
[0m01:04:24.655644 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:04:24.656295 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:04:24.657254 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:04:24.657639 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:04:24.668208 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:04:24.668907 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:04:24.698814 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:04:24.699572 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:04:24.699895 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:04:24.700221 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:04:24.743251 [debug] [Thread-1 (]: SQL status: OK in 0.043 seconds
[0m01:04:24.743918 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:04:24.744424 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:04:24.765587 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:04:24.766198 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:04:24.766715 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:04:24.773186 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:04:24.773767 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:04:24.778095 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:04:24.779775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce80b74f-288f-469b-b7ab-24d0ddbcfd79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be3c904c0>]}
[0m01:04:24.780441 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.12s]
[0m01:04:24.781038 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:04:24.783198 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:04:24.783593 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:04:24.784109 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:04:24.784578 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:04:24.785040 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:04:24.785569 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:04:24.787202 [debug] [MainThread]: Using duckdb connection "master"
[0m01:04:24.787560 [debug] [MainThread]: On master: BEGIN
[0m01:04:24.787872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:04:24.830573 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m01:04:24.831231 [debug] [MainThread]: On master: COMMIT
[0m01:04:24.831625 [debug] [MainThread]: Using duckdb connection "master"
[0m01:04:24.831992 [debug] [MainThread]: On master: COMMIT
[0m01:04:24.832620 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:04:24.832932 [debug] [MainThread]: On master: Close
[0m01:04:24.834892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:04:24.835111 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:04:24.835304 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:04:24.835639 [info ] [MainThread]: 
[0m01:04:24.835939 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m01:04:24.836735 [debug] [MainThread]: Command end result
[0m01:04:24.861460 [info ] [MainThread]: 
[0m01:04:24.861954 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:04:24.862346 [info ] [MainThread]: 
[0m01:04:24.862744 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:04:24.863059 [info ] [MainThread]: 
[0m01:04:24.863414 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:04:24.864550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0484177, "process_user_time": 2.953577, "process_kernel_time": 0.32992, "process_mem_max_rss": "211368", "process_in_blocks": "150872", "process_out_blocks": "2072", "command_success": false}
[0m01:04:24.864948 [debug] [MainThread]: Command `dbt run` failed at 01:04:24.864872 after 1.05 seconds
[0m01:04:24.865218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf1def4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2be4b3dcc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2bf0f735b0>]}
[0m01:04:24.865500 [debug] [MainThread]: Flushing usage events
[0m01:07:42.601366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f945d3f3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f945cdedf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f945c730af0>]}


============================== 01:07:42.604004 | e562c680-30df-4746-809b-aa18603bb701 ==============================
[0m01:07:42.604004 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:07:42.604420 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:07:42.752878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e562c680-30df-4746-809b-aa18603bb701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f945ce10d60>]}
[0m01:07:42.788722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e562c680-30df-4746-809b-aa18603bb701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f945c733b80>]}
[0m01:07:42.791875 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:07:42.800592 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:07:42.918464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:07:42.918862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:07:42.923809 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:07:42.956177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e562c680-30df-4746-809b-aa18603bb701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944fe340a0>]}
[0m01:07:43.039939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e562c680-30df-4746-809b-aa18603bb701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94500d9570>]}
[0m01:07:43.040508 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:07:43.040844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e562c680-30df-4746-809b-aa18603bb701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94500d9690>]}
[0m01:07:43.042538 [info ] [MainThread]: 
[0m01:07:43.043046 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:07:43.047415 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:07:43.077575 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:07:43.078047 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:07:43.078408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:07:43.128912 [debug] [ThreadPool]: SQL status: OK in 0.050 seconds
[0m01:07:43.130290 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:07:43.133625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:07:43.134113 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:07:43.139898 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:07:43.140296 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:07:43.140667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:43.177672 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m01:07:43.179097 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:07:43.179448 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:07:43.180075 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:07:43.180399 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:07:43.180716 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:07:43.181308 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:07:43.182041 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:07:43.182329 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:07:43.182581 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:07:43.183159 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:07:43.183438 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:07:43.186552 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:07:43.191277 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:07:43.191662 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:07:43.191942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:07:43.226796 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:07:43.227296 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:07:43.227674 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:07:43.246535 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m01:07:43.248202 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:07:43.249577 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:07:43.250000 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:07:43.253066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e562c680-30df-4746-809b-aa18603bb701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94582eaa70>]}
[0m01:07:43.253674 [debug] [MainThread]: Using duckdb connection "master"
[0m01:07:43.254044 [debug] [MainThread]: On master: BEGIN
[0m01:07:43.254397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:07:43.288665 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m01:07:43.289316 [debug] [MainThread]: On master: COMMIT
[0m01:07:43.289707 [debug] [MainThread]: Using duckdb connection "master"
[0m01:07:43.290067 [debug] [MainThread]: On master: COMMIT
[0m01:07:43.290704 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:07:43.291038 [debug] [MainThread]: On master: Close
[0m01:07:43.293577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:07:43.293995 [info ] [MainThread]: 
[0m01:07:43.296353 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:07:43.296841 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:07:43.297289 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:07:43.297598 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:07:43.304119 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:07:43.305255 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:07:43.327912 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:07:43.328631 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:07:43.329027 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:07:43.329333 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:07:43.363562 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m01:07:43.364426 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:07:43.364882 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:07:43.381332 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:07:43.382055 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:07:43.382786 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:07:43.388602 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:07:43.389078 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:07:43.393230 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:07:43.394828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e562c680-30df-4746-809b-aa18603bb701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944f2804c0>]}
[0m01:07:43.395468 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.10s]
[0m01:07:43.396054 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:07:43.397887 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:07:43.398476 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:07:43.398983 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:07:43.399487 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:07:43.399994 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:07:43.400379 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:07:43.401911 [debug] [MainThread]: Using duckdb connection "master"
[0m01:07:43.402326 [debug] [MainThread]: On master: BEGIN
[0m01:07:43.402635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:07:43.439052 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m01:07:43.439710 [debug] [MainThread]: On master: COMMIT
[0m01:07:43.440211 [debug] [MainThread]: Using duckdb connection "master"
[0m01:07:43.440543 [debug] [MainThread]: On master: COMMIT
[0m01:07:43.441272 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:07:43.441599 [debug] [MainThread]: On master: Close
[0m01:07:43.443602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:07:43.443917 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:07:43.444199 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:07:43.444770 [info ] [MainThread]: 
[0m01:07:43.445072 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m01:07:43.445669 [debug] [MainThread]: Command end result
[0m01:07:43.469560 [info ] [MainThread]: 
[0m01:07:43.470061 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:07:43.470406 [info ] [MainThread]: 
[0m01:07:43.470810 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:07:43.471096 [info ] [MainThread]: 
[0m01:07:43.471382 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:07:43.472021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9057843, "process_user_time": 2.350053, "process_kernel_time": 0.143572, "process_mem_max_rss": "206240", "process_in_blocks": "38808", "process_out_blocks": "2056", "command_success": false}
[0m01:07:43.472470 [debug] [MainThread]: Command `dbt run` failed at 01:07:43.472391 after 0.91 seconds
[0m01:07:43.472803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f945d3f3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f945d1c58a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f944fe931c0>]}
[0m01:07:43.473132 [debug] [MainThread]: Flushing usage events
[0m01:15:24.695039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df1133430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2def667970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2def666f20>]}


============================== 01:15:24.698971 | d523897d-5c85-4094-816a-f6538dde7596 ==============================
[0m01:15:24.698971 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:15:24.699424 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:15:24.884450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd523897d-5c85-4094-816a-f6538dde7596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2deb72b6a0>]}
[0m01:15:24.923612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd523897d-5c85-4094-816a-f6538dde7596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df029ec20>]}
[0m01:15:24.926872 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:15:24.935685 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:15:25.052396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:15:25.052879 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:15:25.058053 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:15:25.090798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd523897d-5c85-4094-816a-f6538dde7596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de3b34130>]}
[0m01:15:25.186977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd523897d-5c85-4094-816a-f6538dde7596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de3b4a770>]}
[0m01:15:25.187815 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:15:25.188328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd523897d-5c85-4094-816a-f6538dde7596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de3b4a890>]}
[0m01:15:25.190263 [info ] [MainThread]: 
[0m01:15:25.190891 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:15:25.196237 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:15:25.231715 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:15:25.232359 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:15:25.232705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:25.298222 [debug] [ThreadPool]: SQL status: OK in 0.065 seconds
[0m01:15:25.299945 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:15:25.303497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:15:25.304458 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:15:25.311149 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:15:25.311688 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:15:25.312033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:25.355258 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m01:15:25.357191 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:15:25.357746 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:15:25.358839 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:15:25.359264 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:15:25.359666 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:15:25.360442 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:15:25.361329 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:15:25.361636 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:15:25.361943 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:15:25.362647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:15:25.363067 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:15:25.366547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:15:25.372212 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:15:25.372722 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:15:25.373044 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:15:25.411339 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m01:15:25.412068 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:15:25.412511 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:15:25.432905 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m01:15:25.434355 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:15:25.435979 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:15:25.436453 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:15:25.440208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd523897d-5c85-4094-816a-f6538dde7596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2deb76b910>]}
[0m01:15:25.440781 [debug] [MainThread]: Using duckdb connection "master"
[0m01:15:25.441184 [debug] [MainThread]: On master: BEGIN
[0m01:15:25.441559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:15:25.480876 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m01:15:25.481675 [debug] [MainThread]: On master: COMMIT
[0m01:15:25.482072 [debug] [MainThread]: Using duckdb connection "master"
[0m01:15:25.482392 [debug] [MainThread]: On master: COMMIT
[0m01:15:25.483019 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:15:25.483362 [debug] [MainThread]: On master: Close
[0m01:15:25.486385 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:15:25.486921 [info ] [MainThread]: 
[0m01:15:25.489992 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:15:25.490920 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:15:25.491574 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:15:25.491938 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:15:25.498684 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:15:25.499444 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:15:25.523978 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:15:25.524730 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:15:25.525100 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:15:25.525392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:15:25.566041 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m01:15:25.566664 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:15:25.567109 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:15:25.585194 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:15:25.585851 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:15:25.586338 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:15:25.592359 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:15:25.593010 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:15:25.597391 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:15:25.598894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd523897d-5c85-4094-816a-f6538dde7596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de2f80460>]}
[0m01:15:25.599655 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.11s]
[0m01:15:25.600302 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:15:25.602171 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:15:25.602719 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:15:25.603087 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:15:25.603456 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:15:25.603881 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:15:25.604428 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:15:25.605990 [debug] [MainThread]: Using duckdb connection "master"
[0m01:15:25.606551 [debug] [MainThread]: On master: BEGIN
[0m01:15:25.606976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:15:25.644189 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m01:15:25.644917 [debug] [MainThread]: On master: COMMIT
[0m01:15:25.645299 [debug] [MainThread]: Using duckdb connection "master"
[0m01:15:25.645620 [debug] [MainThread]: On master: COMMIT
[0m01:15:25.646234 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:15:25.646582 [debug] [MainThread]: On master: Close
[0m01:15:25.648812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:25.649130 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:15:25.649387 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:15:25.649761 [info ] [MainThread]: 
[0m01:15:25.650045 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m01:15:25.650624 [debug] [MainThread]: Command end result
[0m01:15:25.674478 [info ] [MainThread]: 
[0m01:15:25.674920 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:15:25.675229 [info ] [MainThread]: 
[0m01:15:25.675596 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:15:25.675875 [info ] [MainThread]: 
[0m01:15:25.676160 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:15:25.677093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0297174, "process_user_time": 2.841467, "process_kernel_time": 0.318306, "process_mem_max_rss": "206476", "process_in_blocks": "149176", "process_out_blocks": "2056", "command_success": false}
[0m01:15:25.677783 [debug] [MainThread]: Command `dbt run` failed at 01:15:25.677639 after 1.03 seconds
[0m01:15:25.678405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df1133430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2df09bea40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de2e746a0>]}
[0m01:15:25.678792 [debug] [MainThread]: Flushing usage events
[0m01:17:02.017884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad0ac7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acf40fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acf40fd60>]}


============================== 01:17:02.020856 | 593d3981-8302-4d36-bbcc-acff03232bed ==============================
[0m01:17:02.020856 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:17:02.021302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:17:02.189639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '593d3981-8302-4d36-bbcc-acff03232bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad09891b0>]}
[0m01:17:02.227466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '593d3981-8302-4d36-bbcc-acff03232bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acfe27ac0>]}
[0m01:17:02.230331 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:17:02.239463 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:17:02.353438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:17:02.353784 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:17:02.358630 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:17:02.392858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '593d3981-8302-4d36-bbcc-acff03232bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac3537fa0>]}
[0m01:17:02.478968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '593d3981-8302-4d36-bbcc-acff03232bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac3510850>]}
[0m01:17:02.479380 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:17:02.479642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593d3981-8302-4d36-bbcc-acff03232bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac3510670>]}
[0m01:17:02.480980 [info ] [MainThread]: 
[0m01:17:02.481418 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:17:02.485321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:17:02.515066 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:17:02.515420 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:17:02.515616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:17:02.569343 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m01:17:02.570528 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:17:02.572721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:17:02.573140 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:17:02.578701 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:17:02.578961 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:17:02.579163 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:02.615305 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m01:17:02.616564 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:17:02.616835 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:17:02.617360 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:17:02.617683 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:17:02.617956 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:17:02.618599 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:17:02.619326 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:17:02.619547 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:17:02.619769 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:17:02.620201 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:17:02.620492 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:17:02.625121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:17:02.629410 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:17:02.629682 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:17:02.629878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:17:02.664115 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:17:02.664685 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:17:02.664990 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:17:02.683063 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m01:17:02.684342 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:17:02.685495 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:17:02.685710 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:17:02.688271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593d3981-8302-4d36-bbcc-acff03232bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac354d150>]}
[0m01:17:02.688646 [debug] [MainThread]: Using duckdb connection "master"
[0m01:17:02.688851 [debug] [MainThread]: On master: BEGIN
[0m01:17:02.689097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:17:02.724495 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:17:02.724917 [debug] [MainThread]: On master: COMMIT
[0m01:17:02.725165 [debug] [MainThread]: Using duckdb connection "master"
[0m01:17:02.725424 [debug] [MainThread]: On master: COMMIT
[0m01:17:02.725953 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:17:02.726292 [debug] [MainThread]: On master: Close
[0m01:17:02.728713 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:17:02.729085 [info ] [MainThread]: 
[0m01:17:02.731453 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:17:02.731924 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:17:02.732434 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:17:02.732736 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:17:02.739407 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:17:02.739931 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:17:02.761661 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:17:02.762277 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:17:02.762566 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:17:02.762798 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:17:02.798293 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m01:17:02.798836 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:17:02.799284 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:17:02.815454 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:17:02.815857 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:17:02.816246 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:17:02.821358 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:17:02.821729 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:17:02.824572 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:17:02.825783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '593d3981-8302-4d36-bbcc-acff03232bed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac2978490>]}
[0m01:17:02.826250 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m01:17:02.826713 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:17:02.828218 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:17:02.828555 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:17:02.828934 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:17:02.829288 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:17:02.829672 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:17:02.830173 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:17:02.831280 [debug] [MainThread]: Using duckdb connection "master"
[0m01:17:02.831499 [debug] [MainThread]: On master: BEGIN
[0m01:17:02.831686 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:17:02.866611 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:17:02.867186 [debug] [MainThread]: On master: COMMIT
[0m01:17:02.867542 [debug] [MainThread]: Using duckdb connection "master"
[0m01:17:02.867838 [debug] [MainThread]: On master: COMMIT
[0m01:17:02.868366 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:17:02.868707 [debug] [MainThread]: On master: Close
[0m01:17:02.870541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:17:02.870752 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:17:02.870975 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:17:02.871269 [info ] [MainThread]: 
[0m01:17:02.871547 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m01:17:02.872111 [debug] [MainThread]: Command end result
[0m01:17:02.896143 [info ] [MainThread]: 
[0m01:17:02.896700 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:17:02.897161 [info ] [MainThread]: 
[0m01:17:02.897652 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:17:02.897943 [info ] [MainThread]: 
[0m01:17:02.898215 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:17:02.899111 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9206916, "process_user_time": 2.381482, "process_kernel_time": 0.197029, "process_mem_max_rss": "204444", "process_in_blocks": "149696", "process_out_blocks": "2056", "command_success": false}
[0m01:17:02.899553 [debug] [MainThread]: Command `dbt run` failed at 01:17:02.899444 after 0.92 seconds
[0m01:17:02.899857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad0ac7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8acfe27ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ac3825c90>]}
[0m01:17:02.900122 [debug] [MainThread]: Flushing usage events
[0m01:18:16.884421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f7b274c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f7df6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f7df7dc0>]}


============================== 01:18:16.887319 | 86529a84-9b74-4d06-a0c3-4f6880a076e5 ==============================
[0m01:18:16.887319 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:18:16.887732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:18:17.050169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86529a84-9b74-4d06-a0c3-4f6880a076e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f79ed1e0>]}
[0m01:18:17.087871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86529a84-9b74-4d06-a0c3-4f6880a076e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f6cab5b0>]}
[0m01:18:17.091235 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:18:17.099639 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:18:17.214585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:17.215017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:17.220280 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:18:17.253049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86529a84-9b74-4d06-a0c3-4f6880a076e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ea54c130>]}
[0m01:18:17.339559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86529a84-9b74-4d06-a0c3-4f6880a076e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ea529150>]}
[0m01:18:17.340040 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:18:17.340353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86529a84-9b74-4d06-a0c3-4f6880a076e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ea529210>]}
[0m01:18:17.341927 [info ] [MainThread]: 
[0m01:18:17.342448 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:18:17.346318 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:18:17.377508 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:18:17.377864 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:18:17.378056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:17.428782 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m01:18:17.430057 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:18:17.432077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:18:17.432468 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:18:17.437766 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:18:17.438012 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:18:17.438217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:17.472376 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:18:17.473718 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:18:17.474041 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:18:17.474664 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:17.474985 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:18:17.475341 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:18:17.475892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:17.476859 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:18:17.477070 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:18:17.477255 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:18:17.477708 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:17.477937 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:18:17.480784 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:18:17.485105 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:18:17.485333 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:18:17.485519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:17.520134 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:18:17.520627 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:18:17.521014 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:18:17.538554 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:18:17.539690 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:18:17.541019 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:18:17.541373 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:18:17.544030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86529a84-9b74-4d06-a0c3-4f6880a076e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f295aa40>]}
[0m01:18:17.544503 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:17.544737 [debug] [MainThread]: On master: BEGIN
[0m01:18:17.544973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:17.579963 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:18:17.580445 [debug] [MainThread]: On master: COMMIT
[0m01:18:17.580652 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:17.580930 [debug] [MainThread]: On master: COMMIT
[0m01:18:17.581409 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:18:17.581662 [debug] [MainThread]: On master: Close
[0m01:18:17.583761 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:17.584050 [info ] [MainThread]: 
[0m01:18:17.586365 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:18:17.586823 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:18:17.587326 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:18:17.587572 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:18:17.594997 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:18:17.595621 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:18:17.618118 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:18:17.618900 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:18:17.619206 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:18:17.619517 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:17.656272 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m01:18:17.656799 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:18:17.657161 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:18:17.674115 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:18:17.674592 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:18:17.675009 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:18:17.679964 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:18:17.680256 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:18:17.682985 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:18:17.684149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86529a84-9b74-4d06-a0c3-4f6880a076e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25e99744c0>]}
[0m01:18:17.684708 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.10s]
[0m01:18:17.685172 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:18:17.686677 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:18:17.687033 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:18:17.687365 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:18:17.687671 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:18:17.688145 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:18:17.688470 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:18:17.689911 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:17.690189 [debug] [MainThread]: On master: BEGIN
[0m01:18:17.690408 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:17.725930 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:18:17.726335 [debug] [MainThread]: On master: COMMIT
[0m01:18:17.726581 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:17.726819 [debug] [MainThread]: On master: COMMIT
[0m01:18:17.727332 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:18:17.727676 [debug] [MainThread]: On master: Close
[0m01:18:17.730083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:17.730320 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:18:17.730507 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:18:17.730797 [info ] [MainThread]: 
[0m01:18:17.731088 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m01:18:17.731669 [debug] [MainThread]: Command end result
[0m01:18:17.755593 [info ] [MainThread]: 
[0m01:18:17.756051 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:18:17.756372 [info ] [MainThread]: 
[0m01:18:17.756717 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:18:17.757006 [info ] [MainThread]: 
[0m01:18:17.757278 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:18:17.758225 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.90942633, "process_user_time": 2.551532, "process_kernel_time": 0.101193, "process_mem_max_rss": "211132", "process_in_blocks": "149424", "process_out_blocks": "2048", "command_success": false}
[0m01:18:17.758695 [debug] [MainThread]: Command `dbt run` failed at 01:18:17.758619 after 0.91 seconds
[0m01:18:17.758976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f7b274c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f2915cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25f6cab5b0>]}
[0m01:18:17.759239 [debug] [MainThread]: Flushing usage events
[0m01:18:41.398769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f5b4f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f5549f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f4e8caf0>]}


============================== 01:18:41.400881 | 97656d5d-5cfe-415a-831b-d9d47c4bf8f7 ==============================
[0m01:18:41.400881 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:18:41.401262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:18:41.545874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97656d5d-5cfe-415a-831b-d9d47c4bf8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f5568d60>]}
[0m01:18:41.582597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97656d5d-5cfe-415a-831b-d9d47c4bf8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f4e8fb80>]}
[0m01:18:41.584539 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:18:41.591650 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:18:41.684691 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:18:41.685012 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:18:41.689941 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:18:41.724738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97656d5d-5cfe-415a-831b-d9d47c4bf8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e86340a0>]}
[0m01:18:41.809436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97656d5d-5cfe-415a-831b-d9d47c4bf8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e8891570>]}
[0m01:18:41.809917 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:18:41.810302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97656d5d-5cfe-415a-831b-d9d47c4bf8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e8891690>]}
[0m01:18:41.811816 [info ] [MainThread]: 
[0m01:18:41.812331 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:18:41.816416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:18:41.840799 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:18:41.841268 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:18:41.841578 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:18:41.888211 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m01:18:41.889671 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:18:41.892213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:18:41.892564 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:18:41.897929 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:18:41.898199 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:18:41.898456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:41.932624 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:18:41.934046 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:18:41.934392 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:18:41.934917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:41.935270 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:18:41.935539 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:18:41.936066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:41.936640 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:18:41.936846 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:18:41.937068 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:18:41.937545 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:18:41.937865 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:18:41.941765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:18:41.946175 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:18:41.946405 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:18:41.946596 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:18:41.981400 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:18:41.981831 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:18:41.982082 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:18:41.999610 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:18:42.000686 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:18:42.001100 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:18:42.001323 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:18:42.003883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97656d5d-5cfe-415a-831b-d9d47c4bf8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f0a32a70>]}
[0m01:18:42.004388 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:42.004627 [debug] [MainThread]: On master: BEGIN
[0m01:18:42.004819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:18:42.038481 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m01:18:42.039128 [debug] [MainThread]: On master: COMMIT
[0m01:18:42.039414 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:42.039628 [debug] [MainThread]: On master: COMMIT
[0m01:18:42.040137 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:18:42.040491 [debug] [MainThread]: On master: Close
[0m01:18:42.042435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:18:42.042733 [info ] [MainThread]: 
[0m01:18:42.044702 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:18:42.045152 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:18:42.045605 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:18:42.045858 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:18:42.051950 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:18:42.052508 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:18:42.073614 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:18:42.074372 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:18:42.074694 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:18:42.074929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:18:42.110671 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m01:18:42.111201 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:18:42.111503 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:18:42.125924 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:18:42.126351 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:18:42.126761 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:18:42.128056 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:18:42.128360 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:18:42.130886 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:18:42.132093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97656d5d-5cfe-415a-831b-d9d47c4bf8f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e7a804c0>]}
[0m01:18:42.132577 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m01:18:42.133048 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:18:42.134672 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:18:42.134968 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:18:42.135302 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:18:42.135607 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:18:42.135974 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:18:42.136294 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:18:42.137675 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:42.137946 [debug] [MainThread]: On master: BEGIN
[0m01:18:42.138171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:18:42.173264 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:18:42.173758 [debug] [MainThread]: On master: COMMIT
[0m01:18:42.174048 [debug] [MainThread]: Using duckdb connection "master"
[0m01:18:42.174398 [debug] [MainThread]: On master: COMMIT
[0m01:18:42.175068 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:18:42.175438 [debug] [MainThread]: On master: Close
[0m01:18:42.177873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:18:42.178089 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:18:42.178269 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:18:42.178539 [info ] [MainThread]: 
[0m01:18:42.178820 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m01:18:42.179395 [debug] [MainThread]: Command end result
[0m01:18:42.202199 [info ] [MainThread]: 
[0m01:18:42.202645 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:18:42.202955 [info ] [MainThread]: 
[0m01:18:42.203298 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:18:42.203665 [info ] [MainThread]: 
[0m01:18:42.203956 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:18:42.204646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.84411037, "process_user_time": 2.216844, "process_kernel_time": 0.17299, "process_mem_max_rss": "213588", "process_out_blocks": "2064", "command_success": false, "process_in_blocks": "0"}
[0m01:18:42.205052 [debug] [MainThread]: Command `dbt run` failed at 01:18:42.204971 after 0.84 seconds
[0m01:18:42.205334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f5b4f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4f59218a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4e86931c0>]}
[0m01:18:42.205611 [debug] [MainThread]: Flushing usage events
[0m01:19:13.412916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2324b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a22c356c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a21783f10>]}


============================== 01:19:13.414882 | 04a45e98-fb73-4501-82e0-d3d151515810 ==============================
[0m01:19:13.414882 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:19:13.415271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:19:13.550087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04a45e98-fb73-4501-82e0-d3d151515810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a22c66ad0>]}
[0m01:19:13.585266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04a45e98-fb73-4501-82e0-d3d151515810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a21b6be20>]}
[0m01:19:13.587124 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:19:13.593885 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:19:13.682060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:19:13.682380 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:19:13.686913 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:19:13.719600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04a45e98-fb73-4501-82e0-d3d151515810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a1e1a4880>]}
[0m01:19:13.794552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04a45e98-fb73-4501-82e0-d3d151515810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a15e209d0>]}
[0m01:19:13.794973 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:19:13.795290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04a45e98-fb73-4501-82e0-d3d151515810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a15e208b0>]}
[0m01:19:13.796768 [info ] [MainThread]: 
[0m01:19:13.797246 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:19:13.801038 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:19:13.825651 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:19:13.825996 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:19:13.826215 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:13.873150 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m01:19:13.874621 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:19:13.877313 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:19:13.877679 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:19:13.883006 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:19:13.883245 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:19:13.883438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:13.918514 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:19:13.919747 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:19:13.920001 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:19:13.920501 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:13.920804 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:19:13.921080 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:19:13.921704 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:13.922276 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:19:13.922490 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:19:13.922767 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:19:13.923569 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:19:13.923945 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:19:13.926971 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:19:13.931382 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:19:13.931607 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:19:13.931793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:19:13.965980 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:19:13.966569 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:19:13.966947 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:19:13.984103 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:19:13.985406 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:19:13.985789 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:19:13.985987 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:19:13.989701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04a45e98-fb73-4501-82e0-d3d151515810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a15c80310>]}
[0m01:19:13.990056 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:13.990263 [debug] [MainThread]: On master: BEGIN
[0m01:19:13.990447 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:19:14.025425 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:19:14.025949 [debug] [MainThread]: On master: COMMIT
[0m01:19:14.026199 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:14.026417 [debug] [MainThread]: On master: COMMIT
[0m01:19:14.026947 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:19:14.027293 [debug] [MainThread]: On master: Close
[0m01:19:14.029449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:19:14.029829 [info ] [MainThread]: 
[0m01:19:14.031723 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:19:14.032119 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:19:14.032549 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:19:14.032846 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:19:14.039592 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:19:14.040082 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:19:14.061475 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:19:14.062065 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:19:14.062351 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:19:14.062586 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:19:14.098325 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m01:19:14.098877 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:19:14.099294 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:19:14.113971 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."main"."trades"
WHERE price > 0
  );

[0m01:19:14.114508 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:19:14.114915 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:19:14.116215 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:19:14.116475 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:19:14.119147 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:19:14.120389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a45e98-fb73-4501-82e0-d3d151515810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a15080580>]}
[0m01:19:14.121111 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m01:19:14.121733 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:19:14.123119 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:19:14.123412 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:19:14.123772 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:19:14.124106 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:19:14.124494 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:19:14.125004 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:19:14.126290 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:14.126541 [debug] [MainThread]: On master: BEGIN
[0m01:19:14.126764 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:19:14.164599 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m01:19:14.165100 [debug] [MainThread]: On master: COMMIT
[0m01:19:14.165381 [debug] [MainThread]: Using duckdb connection "master"
[0m01:19:14.165586 [debug] [MainThread]: On master: COMMIT
[0m01:19:14.166057 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:19:14.166308 [debug] [MainThread]: On master: Close
[0m01:19:14.168826 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:14.169104 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:19:14.169294 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:19:14.169588 [info ] [MainThread]: 
[0m01:19:14.169879 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m01:19:14.170459 [debug] [MainThread]: Command end result
[0m01:19:14.193803 [info ] [MainThread]: 
[0m01:19:14.194344 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:19:14.194720 [info ] [MainThread]: 
[0m01:19:14.195067 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."main"."trades"
                ^
[0m01:19:14.195358 [info ] [MainThread]: 
[0m01:19:14.195644 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:19:14.196300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8169641, "process_user_time": 2.202408, "process_kernel_time": 0.167271, "process_mem_max_rss": "205076", "process_out_blocks": "2080", "command_success": false, "process_in_blocks": "0"}
[0m01:19:14.196707 [debug] [MainThread]: Command `dbt run` failed at 01:19:14.196632 after 0.82 seconds
[0m01:19:14.197032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2324b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a15f25d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a22c66ad0>]}
[0m01:19:14.197335 [debug] [MainThread]: Flushing usage events
[0m01:20:34.979380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76d7df4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76bd13130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76bd12080>]}


============================== 01:20:34.981798 | 8fc41ab0-1d78-45e3-8678-d60e6a942c7a ==============================
[0m01:20:34.981798 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:20:34.982139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:20:35.134494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fc41ab0-1d78-45e3-8678-d60e6a942c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76daab7c0>]}
[0m01:20:35.171044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fc41ab0-1d78-45e3-8678-d60e6a942c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7686b6890>]}
[0m01:20:35.173576 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:20:35.182109 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:20:35.293019 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:20:35.293804 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/sources.yml
[0m01:20:35.443556 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:20:35.444008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8fc41ab0-1d78-45e3-8678-d60e6a942c7a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76873a4a0>]}
[0m01:20:35.677602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:20:35.735813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fc41ab0-1d78-45e3-8678-d60e6a942c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7602703a0>]}
[0m01:20:35.814505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fc41ab0-1d78-45e3-8678-d60e6a942c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76021ed40>]}
[0m01:20:35.814929 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:20:35.815223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc41ab0-1d78-45e3-8678-d60e6a942c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76021cee0>]}
[0m01:20:35.816643 [info ] [MainThread]: 
[0m01:20:35.817163 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:20:35.821081 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:20:35.850013 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:20:35.850448 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:20:35.850645 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:20:35.898331 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m01:20:35.899615 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:20:35.901948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:20:35.902368 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:20:35.907801 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:20:35.908056 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:20:35.908264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:35.944678 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m01:20:35.946126 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:20:35.946400 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:20:35.947156 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:35.947477 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:20:35.947789 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:20:35.948323 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:35.948925 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:20:35.949135 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:20:35.949397 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:20:35.949906 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:20:35.950253 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:20:35.952929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:20:35.957345 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:20:35.957577 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:20:35.957767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:20:35.992240 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:20:35.992784 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:20:35.993122 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:20:36.010250 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:20:36.011193 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:20:36.012426 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:20:36.012735 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:20:36.015286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fc41ab0-1d78-45e3-8678-d60e6a942c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7604260e0>]}
[0m01:20:36.015660 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:36.015868 [debug] [MainThread]: On master: BEGIN
[0m01:20:36.016052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:20:36.050880 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:20:36.051287 [debug] [MainThread]: On master: COMMIT
[0m01:20:36.051538 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:36.051813 [debug] [MainThread]: On master: COMMIT
[0m01:20:36.052321 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:20:36.052699 [debug] [MainThread]: On master: Close
[0m01:20:36.054888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:20:36.055190 [info ] [MainThread]: 
[0m01:20:36.057541 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:20:36.058011 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:20:36.058483 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:20:36.058729 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:20:36.064984 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:20:36.065458 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:20:36.087252 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:20:36.087773 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:20:36.088087 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:20:36.088354 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:20:36.122265 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m01:20:36.122730 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:20:36.123024 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:20:36.138565 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:20:36.138911 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:20:36.139314 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:20:36.144118 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:20:36.144468 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:20:36.146907 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.main.trades
                ^
[0m01:20:36.148080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc41ab0-1d78-45e3-8678-d60e6a942c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7686d0040>]}
[0m01:20:36.148566 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m01:20:36.149035 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:20:36.150565 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:20:36.151016 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:20:36.151422 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:20:36.151737 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:20:36.152071 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:20:36.152626 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:20:36.153929 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:36.154297 [debug] [MainThread]: On master: BEGIN
[0m01:20:36.154535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:20:36.191457 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m01:20:36.191967 [debug] [MainThread]: On master: COMMIT
[0m01:20:36.192351 [debug] [MainThread]: Using duckdb connection "master"
[0m01:20:36.192595 [debug] [MainThread]: On master: COMMIT
[0m01:20:36.193077 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:20:36.193317 [debug] [MainThread]: On master: Close
[0m01:20:36.195669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:20:36.195924 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:20:36.196110 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:20:36.196398 [info ] [MainThread]: 
[0m01:20:36.196684 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m01:20:36.197260 [debug] [MainThread]: Command end result
[0m01:20:36.220317 [info ] [MainThread]: 
[0m01:20:36.220760 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:20:36.221086 [info ] [MainThread]: 
[0m01:20:36.221457 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.main.trades
                ^
[0m01:20:36.221725 [info ] [MainThread]: 
[0m01:20:36.222017 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:20:36.222932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2782006, "process_user_time": 2.734429, "process_kernel_time": 0.240464, "process_mem_max_rss": "203996", "process_in_blocks": "150152", "process_out_blocks": "2944", "command_success": false}
[0m01:20:36.223362 [debug] [MainThread]: Command `dbt run` failed at 01:20:36.223258 after 1.28 seconds
[0m01:20:36.223683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76d7df4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb76d06be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7605ea770>]}
[0m01:20:36.223947 [debug] [MainThread]: Flushing usage events
[0m01:25:30.575483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043bfaf460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043b9a71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043a4e2bf0>]}


============================== 01:25:30.578075 | 11fcd817-5ab3-4ae2-a94d-a56472fa1f6c ==============================
[0m01:25:30.578075 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:25:30.578603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run-operation --args {relation: "trades"} get_relation_columns', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:25:30.742545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11fcd817-5ab3-4ae2-a94d-a56472fa1f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0436f1bee0>]}
[0m01:25:30.780190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11fcd817-5ab3-4ae2-a94d-a56472fa1f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0436e82290>]}
[0m01:25:30.782979 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:25:30.791198 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:25:30.905924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:30.906271 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:30.911100 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:25:30.945525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11fcd817-5ab3-4ae2-a94d-a56472fa1f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042ea34130>]}
[0m01:25:31.031426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11fcd817-5ab3-4ae2-a94d-a56472fa1f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042ea44820>]}
[0m01:25:31.031854 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:25:31.032165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11fcd817-5ab3-4ae2-a94d-a56472fa1f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042ebbc2b0>]}
[0m01:25:31.032618 [debug] [MainThread]: Acquiring new duckdb connection 'macro_get_relation_columns'
[0m01:25:31.032846 [debug] [MainThread]: Using duckdb connection "macro_get_relation_columns"
[0m01:25:31.033046 [debug] [MainThread]: On macro_get_relation_columns: BEGIN
[0m01:25:31.033221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:25:31.081411 [debug] [MainThread]: SQL status: OK in 0.048 seconds
[0m01:25:31.081824 [debug] [MainThread]: On macro_get_relation_columns: COMMIT
[0m01:25:31.082082 [debug] [MainThread]: Using duckdb connection "macro_get_relation_columns"
[0m01:25:31.082359 [debug] [MainThread]: On macro_get_relation_columns: COMMIT
[0m01:25:31.083270 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:25:31.083949 [debug] [MainThread]: On macro_get_relation_columns: Close
[0m01:25:31.086470 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "get_relation_columns" in any package
[0m01:25:31.088075 [debug] [MainThread]: Traceback (most recent call last):
  File "/root/crypto_pipeline/venv/lib/python3.10/site-packages/dbt/task/run_operation.py", line 62, in run
    self._run_unsafe(package_name, macro_name)
  File "/root/crypto_pipeline/venv/lib/python3.10/site-packages/dbt/task/run_operation.py", line 47, in _run_unsafe
    res = adapter.execute_macro(
  File "/root/crypto_pipeline/venv/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1135, in execute_macro
    raise DbtRuntimeError(
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "get_relation_columns" in any package

[0m01:25:31.088366 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'get_relation_columns' in any package
[0m01:25:31.089196 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.5484778, "process_user_time": 1.479939, "process_kernel_time": 0.137031, "process_mem_max_rss": "168636", "process_in_blocks": "146568", "process_out_blocks": "1056", "command_success": false}
[0m01:25:31.089648 [debug] [MainThread]: Command `dbt run-operation` failed at 01:25:31.089533 after 0.55 seconds
[0m01:25:31.089915 [debug] [MainThread]: Connection 'macro_get_relation_columns' was properly closed.
[0m01:25:31.090160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043bfaf460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042ea47a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f042ea47a60>]}
[0m01:25:31.090433 [debug] [MainThread]: Flushing usage events
[0m01:25:41.285465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d4a0b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d445d6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d2fa1f60>]}


============================== 01:25:41.287486 | b4f17d7b-179b-469d-b18b-0052ca3cc1d6 ==============================
[0m01:25:41.287486 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:25:41.287980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run-operation --args {relation: "trades"} get_relation_columns', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:25:41.428705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f17d7b-179b-469d-b18b-0052ca3cc1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d4935210>]}
[0m01:25:41.465649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f17d7b-179b-469d-b18b-0052ca3cc1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d338fe20>]}
[0m01:25:41.467582 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:25:41.474948 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:25:41.566708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:41.567139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:41.571816 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:25:41.605788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4f17d7b-179b-469d-b18b-0052ca3cc1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c7530130>]}
[0m01:25:41.683693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4f17d7b-179b-469d-b18b-0052ca3cc1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c750ec50>]}
[0m01:25:41.684189 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m01:25:41.684520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4f17d7b-179b-469d-b18b-0052ca3cc1d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c76bb880>]}
[0m01:25:41.684981 [debug] [MainThread]: Acquiring new duckdb connection 'macro_get_relation_columns'
[0m01:25:41.685205 [debug] [MainThread]: Using duckdb connection "macro_get_relation_columns"
[0m01:25:41.685390 [debug] [MainThread]: On macro_get_relation_columns: BEGIN
[0m01:25:41.685567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:25:41.727222 [debug] [MainThread]: SQL status: OK in 0.042 seconds
[0m01:25:41.727636 [debug] [MainThread]: On macro_get_relation_columns: COMMIT
[0m01:25:41.727881 [debug] [MainThread]: Using duckdb connection "macro_get_relation_columns"
[0m01:25:41.728135 [debug] [MainThread]: On macro_get_relation_columns: COMMIT
[0m01:25:41.729061 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:25:41.729659 [debug] [MainThread]: On macro_get_relation_columns: Close
[0m01:25:41.732021 [error] [MainThread]: Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "get_relation_columns" in any package
[0m01:25:41.732913 [debug] [MainThread]: Traceback (most recent call last):
  File "/root/crypto_pipeline/venv/lib/python3.10/site-packages/dbt/task/run_operation.py", line 62, in run
    self._run_unsafe(package_name, macro_name)
  File "/root/crypto_pipeline/venv/lib/python3.10/site-packages/dbt/task/run_operation.py", line 47, in _run_unsafe
    res = adapter.execute_macro(
  File "/root/crypto_pipeline/venv/lib/python3.10/site-packages/dbt/adapters/base/impl.py", line 1135, in execute_macro
    raise DbtRuntimeError(
dbt_common.exceptions.base.DbtRuntimeError: Runtime Error
  dbt could not find a macro with the name "get_relation_columns" in any package

[0m01:25:41.733413 [error] [MainThread]: Encountered an error:
Internal Error
  dbt could not find a macro with the name 'get_relation_columns' in any package
[0m01:25:41.734219 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_wall_clock_time": 0.48413756, "process_user_time": 1.320286, "process_kernel_time": 0.053525, "process_mem_max_rss": "170056", "process_out_blocks": "1048", "command_success": false, "process_in_blocks": "0"}
[0m01:25:41.734713 [debug] [MainThread]: Command `dbt run-operation` failed at 01:25:41.734617 after 0.48 seconds
[0m01:25:41.735060 [debug] [MainThread]: Connection 'macro_get_relation_columns' was properly closed.
[0m01:25:41.735309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d4a0b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c750da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15c750ec50>]}
[0m01:25:41.735575 [debug] [MainThread]: Flushing usage events
[0m01:31:50.672824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31453b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc312a73130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc312a72080>]}


============================== 01:31:50.675932 | 8bcec92a-e538-4c8e-885f-7664e3dc7896 ==============================
[0m01:31:50.675932 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:31:50.676436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:31:50.836120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31480b7c0>]}
[0m01:31:50.872939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30eb22890>]}
[0m01:31:50.875830 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:31:50.884637 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:31:51.003382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:31:51.003884 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://macros/debug_compile.sql
[0m01:31:51.004219 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m01:31:51.120069 [info ] [MainThread]: Relation type: None
[0m01:31:51.120507 [info ] [MainThread]: Database: crypto_trading
[0m01:31:51.120779 [info ] [MainThread]: Schema: main
[0m01:31:51.121042 [info ] [MainThread]: Identifier: stg_trades
[0m01:31:51.166163 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:31:51.166655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc306f64400>]}
[0m01:31:51.293602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:31:51.306196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc287d38130>]}
[0m01:31:51.438550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc304cea5c0>]}
[0m01:31:51.439036 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m01:31:51.439310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc304ce9ba0>]}
[0m01:31:51.440783 [info ] [MainThread]: 
[0m01:31:51.441248 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:31:51.445321 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:31:51.472478 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:31:51.472809 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:31:51.472996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:51.528966 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m01:31:51.530214 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:31:51.532388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:31:51.532799 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:31:51.537979 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:31:51.538230 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:31:51.538427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:51.573518 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:31:51.574940 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:31:51.575169 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:31:51.575633 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:31:51.575900 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:31:51.576169 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:31:51.576827 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:31:51.577648 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:31:51.577913 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:31:51.578129 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:31:51.578624 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:31:51.578934 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:31:51.581938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:31:51.586965 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:31:51.587192 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:31:51.587377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:51.621174 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:31:51.621635 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:31:51.622043 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:31:51.639913 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:31:51.641043 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:31:51.642308 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:31:51.642616 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:31:51.645239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3133a21d0>]}
[0m01:31:51.645701 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:51.645923 [debug] [MainThread]: On master: BEGIN
[0m01:31:51.646114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:31:51.681468 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:31:51.681927 [debug] [MainThread]: On master: COMMIT
[0m01:31:51.682209 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:51.682496 [debug] [MainThread]: On master: COMMIT
[0m01:31:51.682933 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:31:51.683164 [debug] [MainThread]: On master: Close
[0m01:31:51.685575 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:51.685880 [info ] [MainThread]: 
[0m01:31:51.688314 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:31:51.688767 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:31:51.689231 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:31:51.689477 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:31:51.696246 [info ] [Thread-1 (]: Relation type: None
[0m01:31:51.696712 [info ] [Thread-1 (]: Database: crypto_trading
[0m01:31:51.697045 [info ] [Thread-1 (]: Schema: main
[0m01:31:51.697354 [info ] [Thread-1 (]: Identifier: trades
[0m01:31:51.697759 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:31:51.698224 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:31:51.719397 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:31:51.720066 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:31:51.720349 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:31:51.720612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:31:51.754160 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m01:31:51.754736 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:31:51.755091 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql

  
  
  
  
  select 1

/*
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
*/
  );

[0m01:31:51.755880 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:31:51.761006 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:31:51.761293 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */
alter view "crypto_trading"."main"."stg_trades__dbt_tmp" rename to "stg_trades"
[0m01:31:51.762159 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:31:51.772241 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: COMMIT
[0m01:31:51.772516 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:31:51.772742 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: COMMIT
[0m01:31:51.776509 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:31:51.780235 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:31:51.780545 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */
drop view if exists "crypto_trading"."main"."stg_trades__dbt_backup" cascade
[0m01:31:51.781567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:31:51.783380 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:31:51.791728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3143cb5e0>]}
[0m01:31:51.792280 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_trades ............................... [[32mOK[0m in 0.10s]
[0m01:31:51.792791 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:31:51.793862 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:31:51.794288 [info ] [Thread-1 (]: 2 of 3 START sql table model main.hourly_ohlcv ................................. [RUN]
[0m01:31:51.794764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_pipeline.stg_trades, now model.crypto_pipeline.hourly_ohlcv)
[0m01:31:51.795119 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.hourly_ohlcv
[0m01:31:51.798831 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.hourly_ohlcv"
[0m01:31:51.800072 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.hourly_ohlcv
[0m01:31:51.812940 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.hourly_ohlcv"
[0m01:31:51.813913 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.hourly_ohlcv"
[0m01:31:51.814174 [debug] [Thread-1 (]: On model.crypto_pipeline.hourly_ohlcv: BEGIN
[0m01:31:51.814490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:51.850757 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m01:31:51.851265 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.hourly_ohlcv"
[0m01:31:51.851664 [debug] [Thread-1 (]: On model.crypto_pipeline.hourly_ohlcv: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.hourly_ohlcv"} */

  
    
    

    create  table
      "crypto_trading"."main"."hourly_ohlcv__dbt_tmp"
  
    as (
      -- mart/hourly_ohlcv.sql
WITH hourly_trades AS (
    SELECT
        DATE_TRUNC('hour', traded_at) AS trading_hour,
        price,
        qty,
        tick_volume
    FROM "crypto_trading"."main"."stg_trades"
)

SELECT 
    trading_hour,
    FIRST_VALUE(price) OVER (
        PARTITION BY trading_hour
        ORDER BY trading_hour
    ) AS open,
    MAX(price) AS high,
    MIN(price) AS low,
    LAST_VALUE(price) OVER (
        PARTITION BY trading_hour
        ORDER BY trading_hour
    ) AS close,
    SUM(tick_volume) AS volume,
    COUNT(*) AS trade_count
FROM hourly_trades
GROUP BY trading_hour
    );
  
  
[0m01:31:51.852920 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.hourly_ohlcv"} */

  
    
    

    create  table
      "crypto_trading"."main"."hourly_ohlcv__dbt_tmp"
  
    as (
      -- mart/hourly_ohlcv.sql
WITH hourly_trades AS (
    SELECT
        DATE_TRUNC('hour', traded_at) AS trading_hour,
        price,
        qty,
        tick_volume
    FROM "crypto_trading"."main"."stg_trades"
)

SELECT 
    trading_hour,
    FIRST_VALUE(price) OVER (
        PARTITION BY trading_hour
        ORDER BY trading_hour
    ) AS open,
    MAX(price) AS high,
    MIN(price) AS low,
    LAST_VALUE(price) OVER (
        PARTITION BY trading_hour
        ORDER BY trading_hour
    ) AS close,
    SUM(tick_volume) AS volume,
    COUNT(*) AS trade_count
FROM hourly_trades
GROUP BY trading_hour
    );
  
  
[0m01:31:51.853192 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:31:51.853532 [debug] [Thread-1 (]: On model.crypto_pipeline.hourly_ohlcv: ROLLBACK
[0m01:31:51.858862 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.hourly_ohlcv'
[0m01:31:51.859173 [debug] [Thread-1 (]: On model.crypto_pipeline.hourly_ohlcv: Close
[0m01:31:51.861339 [debug] [Thread-1 (]: Runtime Error in model hourly_ohlcv (models/mart/hourly_ohlcv.sql)
  Binder Error: Referenced column "traded_at" not found in FROM clause!
  Candidate bindings: "stg_trades.1"
  LINE 14:         DATE_TRUNC('hour', traded_at) AS trading_hour,
                                      ^
[0m01:31:51.861704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc30ebc58a0>]}
[0m01:31:51.862166 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.hourly_ohlcv ........................ [[31mERROR[0m in 0.07s]
[0m01:31:51.862674 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:31:51.863092 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:31:51.864125 [info ] [Thread-1 (]: 3 of 3 START sql table model main.minute_ohlcv ................................. [RUN]
[0m01:31:51.864632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_pipeline.hourly_ohlcv, now model.crypto_pipeline.minute_ohlcv)
[0m01:31:51.864881 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.minute_ohlcv
[0m01:31:51.867323 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.minute_ohlcv"
[0m01:31:51.867749 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.minute_ohlcv
[0m01:31:51.870256 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.minute_ohlcv"
[0m01:31:51.870707 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.minute_ohlcv"
[0m01:31:51.870951 [debug] [Thread-1 (]: On model.crypto_pipeline.minute_ohlcv: BEGIN
[0m01:31:51.871186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:51.904593 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m01:31:51.905073 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.minute_ohlcv"
[0m01:31:51.905398 [debug] [Thread-1 (]: On model.crypto_pipeline.minute_ohlcv: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.minute_ohlcv"} */

  
    
    

    create  table
      "crypto_trading"."main"."minute_ohlcv__dbt_tmp"
  
    as (
      -- mart/minute_ohlcv.sql
WITH minute_trades AS (
    SELECT
        DATE_TRUNC('minute', traded_at) AS trading_minute,
        price,
        qty,
        tick_volume,
        traded_at  
    FROM "crypto_trading"."main"."stg_trades"
)

SELECT 
    trading_minute,
    FIRST_VALUE(price) OVER (
        PARTITION BY trading_minute
        ORDER BY traded_at
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) AS open,
    MAX(price) AS high,
    MIN(price) AS low,
    LAST_VALUE(price) OVER (
        PARTITION BY trading_minute
        ORDER BY traded_at
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) AS close,
    SUM(tick_volume) AS volume,
    COUNT(*) AS trade_count
FROM minute_trades
GROUP BY trading_minute
ORDER BY trading_minute
    );
  
  
[0m01:31:51.906542 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.minute_ohlcv"} */

  
    
    

    create  table
      "crypto_trading"."main"."minute_ohlcv__dbt_tmp"
  
    as (
      -- mart/minute_ohlcv.sql
WITH minute_trades AS (
    SELECT
        DATE_TRUNC('minute', traded_at) AS trading_minute,
        price,
        qty,
        tick_volume,
        traded_at  
    FROM "crypto_trading"."main"."stg_trades"
)

SELECT 
    trading_minute,
    FIRST_VALUE(price) OVER (
        PARTITION BY trading_minute
        ORDER BY traded_at
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) AS open,
    MAX(price) AS high,
    MIN(price) AS low,
    LAST_VALUE(price) OVER (
        PARTITION BY trading_minute
        ORDER BY traded_at
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) AS close,
    SUM(tick_volume) AS volume,
    COUNT(*) AS trade_count
FROM minute_trades
GROUP BY trading_minute
ORDER BY trading_minute
    );
  
  
[0m01:31:51.906831 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:31:51.907209 [debug] [Thread-1 (]: On model.crypto_pipeline.minute_ohlcv: ROLLBACK
[0m01:31:51.907757 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.minute_ohlcv'
[0m01:31:51.907985 [debug] [Thread-1 (]: On model.crypto_pipeline.minute_ohlcv: Close
[0m01:31:51.910297 [debug] [Thread-1 (]: Runtime Error in model minute_ohlcv (models/mart/minute_ohlcv.sql)
  Binder Error: Referenced column "traded_at" not found in FROM clause!
  Candidate bindings: "stg_trades.1"
  LINE 14:         DATE_TRUNC('minute', traded_at) AS trading_minute,
                                        ^
[0m01:31:51.910687 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcec92a-e538-4c8e-885f-7664e3dc7896', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc306f251b0>]}
[0m01:31:51.911289 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model main.minute_ohlcv ........................ [[31mERROR[0m in 0.05s]
[0m01:31:51.912065 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:31:51.913511 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:51.913790 [debug] [MainThread]: On master: BEGIN
[0m01:31:51.913987 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:31:51.948611 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m01:31:51.949179 [debug] [MainThread]: On master: COMMIT
[0m01:31:51.949497 [debug] [MainThread]: Using duckdb connection "master"
[0m01:31:51.949738 [debug] [MainThread]: On master: COMMIT
[0m01:31:51.950228 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:31:51.950465 [debug] [MainThread]: On master: Close
[0m01:31:51.952468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:51.952681 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:31:51.952859 [debug] [MainThread]: Connection 'model.crypto_pipeline.minute_ohlcv' was properly closed.
[0m01:31:51.953179 [info ] [MainThread]: 
[0m01:31:51.953465 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m01:31:51.954527 [debug] [MainThread]: Command end result
[0m01:31:51.979725 [info ] [MainThread]: 
[0m01:31:51.980167 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:31:51.980483 [info ] [MainThread]: 
[0m01:31:51.980816 [error] [MainThread]:   Runtime Error in model hourly_ohlcv (models/mart/hourly_ohlcv.sql)
  Binder Error: Referenced column "traded_at" not found in FROM clause!
  Candidate bindings: "stg_trades.1"
  LINE 14:         DATE_TRUNC('hour', traded_at) AS trading_hour,
                                      ^
[0m01:31:51.981096 [info ] [MainThread]: 
[0m01:31:51.981395 [error] [MainThread]:   Runtime Error in model minute_ohlcv (models/mart/minute_ohlcv.sql)
  Binder Error: Referenced column "traded_at" not found in FROM clause!
  Candidate bindings: "stg_trades.1"
  LINE 14:         DATE_TRUNC('minute', traded_at) AS trading_minute,
                                        ^
[0m01:31:51.981649 [info ] [MainThread]: 
[0m01:31:51.981911 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m01:31:51.982771 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3463118, "process_user_time": 3.051108, "process_kernel_time": 0.251349, "process_mem_max_rss": "206508", "process_in_blocks": "150056", "process_out_blocks": "3568", "command_success": false}
[0m01:31:51.983203 [debug] [MainThread]: Command `dbt run` failed at 01:31:51.983089 after 1.35 seconds
[0m01:31:51.983516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31453b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3161fa2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc312ae0b80>]}
[0m01:31:51.983784 [debug] [MainThread]: Flushing usage events
[0m01:36:30.937111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff772ecb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77319b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77319bd90>]}


============================== 01:36:30.940989 | 11c8d86d-84e2-486c-8fe8-71cb18409495 ==============================
[0m01:36:30.940989 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:36:30.941565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:36:31.108022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11c8d86d-84e2-486c-8fe8-71cb18409495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff771386830>]}
[0m01:36:31.146924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11c8d86d-84e2-486c-8fe8-71cb18409495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff77132a770>]}
[0m01:36:31.150095 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:36:31.159267 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:36:31.278807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:36:31.279421 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m01:36:31.396836 [info ] [MainThread]: Relation type: None
[0m01:36:31.397289 [info ] [MainThread]: Database: crypto_trading
[0m01:36:31.397615 [info ] [MainThread]: Schema: main
[0m01:36:31.397898 [info ] [MainThread]: Identifier: stg_trades
[0m01:36:31.445103 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:36:31.445571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '11c8d86d-84e2-486c-8fe8-71cb18409495', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff771356c50>]}
[0m01:36:31.586033 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:36:31.599114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11c8d86d-84e2-486c-8fe8-71cb18409495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff737530100>]}
[0m01:36:31.741956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11c8d86d-84e2-486c-8fe8-71cb18409495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff73756c3d0>]}
[0m01:36:31.742434 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m01:36:31.742814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11c8d86d-84e2-486c-8fe8-71cb18409495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff772cd0be0>]}
[0m01:36:31.744585 [info ] [MainThread]: 
[0m01:36:31.745134 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:36:31.749284 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:36:31.779950 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:36:31.780547 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:36:31.780815 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:31.833571 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m01:36:31.835317 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:36:31.837944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:36:31.838460 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:36:31.843712 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:36:31.844023 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:36:31.844315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:31.884376 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m01:36:31.885746 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:36:31.886035 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:36:31.886538 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:31.886762 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:36:31.887007 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:36:31.887527 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:31.888151 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:36:31.888379 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:36:31.888592 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:36:31.889012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:31.889480 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:36:31.892634 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:36:31.897644 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:36:31.897939 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:36:31.898147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:31.932014 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m01:36:31.932515 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:36:31.932908 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:36:31.955302 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m01:36:31.956650 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:36:31.957918 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:36:31.958177 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:36:31.961089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11c8d86d-84e2-486c-8fe8-71cb18409495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff765860a90>]}
[0m01:36:31.961610 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:31.961981 [debug] [MainThread]: On master: BEGIN
[0m01:36:31.962323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:36:32.005675 [debug] [MainThread]: SQL status: OK in 0.043 seconds
[0m01:36:32.006128 [debug] [MainThread]: On master: COMMIT
[0m01:36:32.006390 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:32.006680 [debug] [MainThread]: On master: COMMIT
[0m01:36:32.007181 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:32.007419 [debug] [MainThread]: On master: Close
[0m01:36:32.009896 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:36:32.010206 [info ] [MainThread]: 
[0m01:36:32.012680 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:36:32.013182 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:36:32.013676 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:36:32.013932 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:36:32.020285 [info ] [Thread-1 (]: Relation type: None
[0m01:36:32.020682 [info ] [Thread-1 (]: Database: crypto_trading
[0m01:36:32.020993 [info ] [Thread-1 (]: Schema: main
[0m01:36:32.021371 [info ] [Thread-1 (]: Identifier: trades
[0m01:36:32.021763 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:36:32.022361 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:36:32.043924 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:36:32.044738 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:36:32.045059 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:36:32.045313 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:36:32.085362 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m01:36:32.085846 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:36:32.086225 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
--
  
  
  
  
  select 1


SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:36:32.089722 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
--
  
  
  
  
  select 1


SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:36:32.090255 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:36:32.090720 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:36:32.095942 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:36:32.096305 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:36:32.098589 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Parser Error: syntax error at or near "SELECT"
[0m01:36:32.099861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11c8d86d-84e2-486c-8fe8-71cb18409495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff76580ae00>]}
[0m01:36:32.100360 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m01:36:32.100855 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:36:32.102479 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:36:32.102839 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:36:32.103340 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:36:32.103698 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:36:32.104085 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:36:32.104577 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:36:32.105896 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:32.106237 [debug] [MainThread]: On master: BEGIN
[0m01:36:32.106439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:36:32.152108 [debug] [MainThread]: SQL status: OK in 0.046 seconds
[0m01:36:32.152545 [debug] [MainThread]: On master: COMMIT
[0m01:36:32.152800 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:32.153067 [debug] [MainThread]: On master: COMMIT
[0m01:36:32.153602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:32.154051 [debug] [MainThread]: On master: Close
[0m01:36:32.156331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:32.156743 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:36:32.157175 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:36:32.157617 [info ] [MainThread]: 
[0m01:36:32.157936 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m01:36:32.158536 [debug] [MainThread]: Command end result
[0m01:36:32.182748 [info ] [MainThread]: 
[0m01:36:32.183182 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:36:32.183498 [info ] [MainThread]: 
[0m01:36:32.183830 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Parser Error: syntax error at or near "SELECT"
[0m01:36:32.184086 [info ] [MainThread]: 
[0m01:36:32.184458 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:36:32.185100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2837038, "process_user_time": 2.802497, "process_kernel_time": 0.267939, "process_mem_max_rss": "207112", "process_in_blocks": "40792", "process_out_blocks": "2960", "command_success": false}
[0m01:36:32.185500 [debug] [MainThread]: Command `dbt run` failed at 01:36:32.185418 after 1.28 seconds
[0m01:36:32.185767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff772ecb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff773b5bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff773232ad0>]}
[0m01:36:32.186013 [debug] [MainThread]: Flushing usage events
[0m01:36:52.828617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30accdb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ac6d5f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ac018af0>]}


============================== 01:36:52.830527 | 2f8372a0-776b-472e-8c3b-c38487a6bee8 ==============================
[0m01:36:52.830527 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:36:52.830871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:36:52.964002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f8372a0-776b-472e-8c3b-c38487a6bee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ac6f4d60>]}
[0m01:36:52.999902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f8372a0-776b-472e-8c3b-c38487a6bee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ac01bb80>]}
[0m01:36:53.001803 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:36:53.008405 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:36:53.096611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:36:53.097176 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m01:36:53.213716 [info ] [MainThread]: Relation type: None
[0m01:36:53.214135 [info ] [MainThread]: Database: crypto_trading
[0m01:36:53.214422 [info ] [MainThread]: Schema: main
[0m01:36:53.214668 [info ] [MainThread]: Identifier: stg_trades
[0m01:36:53.259194 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:36:53.259655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2f8372a0-776b-472e-8c3b-c38487a6bee8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ab252680>]}
[0m01:36:53.387189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:36:53.398443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f8372a0-776b-472e-8c3b-c38487a6bee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f309c524100>]}
[0m01:36:53.524366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f8372a0-776b-472e-8c3b-c38487a6bee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ac8054e0>]}
[0m01:36:53.524823 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m01:36:53.525102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f8372a0-776b-472e-8c3b-c38487a6bee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30acae0bb0>]}
[0m01:36:53.526657 [info ] [MainThread]: 
[0m01:36:53.527133 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:36:53.531611 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:36:53.554344 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:36:53.554684 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:36:53.554880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:53.596827 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m01:36:53.598197 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:36:53.600276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:36:53.600609 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:36:53.605431 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:36:53.605667 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:36:53.605862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:53.641133 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:36:53.642431 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:36:53.642716 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:36:53.643305 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:53.643613 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:36:53.643810 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:36:53.644372 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:53.645153 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:36:53.645366 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:36:53.645553 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:36:53.646050 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:53.646310 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:36:53.648745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:36:53.653415 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:36:53.653659 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:36:53.653849 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:53.689019 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:36:53.689538 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:36:53.689834 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:36:53.706762 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:36:53.708070 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:36:53.708475 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:36:53.708676 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:36:53.711185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f8372a0-776b-472e-8c3b-c38487a6bee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f309f703c10>]}
[0m01:36:53.711583 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:53.711810 [debug] [MainThread]: On master: BEGIN
[0m01:36:53.712006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:36:53.747328 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:36:53.747842 [debug] [MainThread]: On master: COMMIT
[0m01:36:53.748158 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:53.748381 [debug] [MainThread]: On master: COMMIT
[0m01:36:53.748846 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:53.749098 [debug] [MainThread]: On master: Close
[0m01:36:53.751096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:36:53.751432 [info ] [MainThread]: 
[0m01:36:53.753403 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:36:53.753843 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:36:53.754363 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:36:53.754631 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:36:53.760954 [info ] [Thread-1 (]: Relation type: None
[0m01:36:53.761340 [info ] [Thread-1 (]: Database: crypto_trading
[0m01:36:53.761649 [info ] [Thread-1 (]: Schema: main
[0m01:36:53.762027 [info ] [Thread-1 (]: Identifier: trades
[0m01:36:53.762410 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:36:53.762783 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:36:53.783543 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:36:53.784161 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:36:53.784532 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:36:53.784771 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:36:53.824987 [debug] [Thread-1 (]: SQL status: OK in 0.040 seconds
[0m01:36:53.825502 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:36:53.825898 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
-- 
  
  
  
  
  select 1

SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:36:53.826574 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
-- 
  
  
  
  
  select 1

SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:36:53.826957 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:36:53.827447 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:36:53.829180 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:36:53.829536 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:36:53.831919 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Parser Error: syntax error at or near "SELECT"
[0m01:36:53.833287 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f8372a0-776b-472e-8c3b-c38487a6bee8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f309f73f3a0>]}
[0m01:36:53.833868 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.08s]
[0m01:36:53.834511 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:36:53.836356 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:36:53.836837 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:36:53.837248 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:36:53.837611 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:36:53.838008 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:36:53.838536 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:36:53.839882 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:53.840348 [debug] [MainThread]: On master: BEGIN
[0m01:36:53.840617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:36:53.881679 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m01:36:53.882192 [debug] [MainThread]: On master: COMMIT
[0m01:36:53.882597 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:53.882903 [debug] [MainThread]: On master: COMMIT
[0m01:36:53.883533 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:53.883821 [debug] [MainThread]: On master: Close
[0m01:36:53.886438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:53.886764 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:36:53.887079 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:36:53.887593 [info ] [MainThread]: 
[0m01:36:53.887903 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m01:36:53.888650 [debug] [MainThread]: Command end result
[0m01:36:53.920888 [info ] [MainThread]: 
[0m01:36:53.921406 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:36:53.921748 [info ] [MainThread]: 
[0m01:36:53.922182 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Parser Error: syntax error at or near "SELECT"
[0m01:36:53.922484 [info ] [MainThread]: 
[0m01:36:53.922806 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:36:53.923629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.129347, "process_user_time": 2.550752, "process_kernel_time": 0.150446, "process_mem_max_rss": "207608", "process_out_blocks": "2960", "command_success": false, "process_in_blocks": "0"}
[0m01:36:53.924250 [debug] [MainThread]: Command `dbt run` failed at 01:36:53.924119 after 1.13 seconds
[0m01:36:53.924686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30accdb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30abb421a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f30ae99f610>]}
[0m01:36:53.925069 [debug] [MainThread]: Flushing usage events
[0m01:37:01.716776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf603574f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5e88b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5e88bd90>]}


============================== 01:37:01.718701 | 5f688ece-a4cf-422b-a0af-f2960160b6c4 ==============================
[0m01:37:01.718701 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:37:01.719056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:37:01.857608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f688ece-a4cf-422b-a0af-f2960160b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5b2b2830>]}
[0m01:37:01.894393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f688ece-a4cf-422b-a0af-f2960160b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5b24a770>]}
[0m01:37:01.896257 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:37:01.902959 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:37:02.008786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:37:02.009406 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m01:37:02.156753 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m01:37:02.157213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f688ece-a4cf-422b-a0af-f2960160b6c4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf52e2fa60>]}
[0m01:37:02.293504 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:37:02.305357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f688ece-a4cf-422b-a0af-f2960160b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf50b0c130>]}
[0m01:37:02.429507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f688ece-a4cf-422b-a0af-f2960160b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf50c64c10>]}
[0m01:37:02.429996 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m01:37:02.430322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f688ece-a4cf-422b-a0af-f2960160b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf50c64c10>]}
[0m01:37:02.431986 [info ] [MainThread]: 
[0m01:37:02.432501 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:37:02.436624 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:37:02.462350 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:37:02.462713 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:37:02.463001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:02.509188 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m01:37:02.510396 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:37:02.512841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:37:02.513347 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:37:02.518200 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:37:02.518458 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:37:02.518652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:02.554103 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m01:37:02.555671 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:37:02.555903 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:37:02.556478 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:02.556694 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:37:02.556886 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:37:02.557479 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:02.558230 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:37:02.558509 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:37:02.558710 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:37:02.559200 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:02.559530 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:37:02.562426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:37:02.567200 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:37:02.567452 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:37:02.567654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:02.601122 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m01:37:02.601562 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:37:02.601810 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:37:02.619472 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m01:37:02.620852 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:37:02.621300 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:37:02.621538 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:37:02.624668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f688ece-a4cf-422b-a0af-f2960160b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5e8f8af0>]}
[0m01:37:02.625187 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:02.625475 [debug] [MainThread]: On master: BEGIN
[0m01:37:02.625678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:02.659490 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m01:37:02.660009 [debug] [MainThread]: On master: COMMIT
[0m01:37:02.660248 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:02.660552 [debug] [MainThread]: On master: COMMIT
[0m01:37:02.661029 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:37:02.661336 [debug] [MainThread]: On master: Close
[0m01:37:02.663514 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:37:02.663821 [info ] [MainThread]: 
[0m01:37:02.665659 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:37:02.667020 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:37:02.667484 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:37:02.667783 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:37:02.673310 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:37:02.673734 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:37:02.694752 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:37:02.695393 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:37:02.695691 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:37:02.695929 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:37:02.730547 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m01:37:02.731007 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:37:02.731319 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:37:02.746989 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:37:02.747321 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:37:02.747661 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:37:02.748978 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:37:02.749224 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:37:02.751648 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "stg_trades"?
  LINE 17: FROM crypto_trading.main.trades
                ^
[0m01:37:02.752791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f688ece-a4cf-422b-a0af-f2960160b6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf5e8f8af0>]}
[0m01:37:02.753244 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.08s]
[0m01:37:02.753698 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:37:02.755212 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:37:02.755556 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:37:02.755881 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:37:02.756183 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:37:02.756541 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:37:02.756859 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:37:02.758078 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:02.758387 [debug] [MainThread]: On master: BEGIN
[0m01:37:02.758695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:02.794394 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m01:37:02.794862 [debug] [MainThread]: On master: COMMIT
[0m01:37:02.795137 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:02.795368 [debug] [MainThread]: On master: COMMIT
[0m01:37:02.795874 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:37:02.796129 [debug] [MainThread]: On master: Close
[0m01:37:02.798191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:02.798447 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:37:02.798632 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:37:02.798916 [info ] [MainThread]: 
[0m01:37:02.799202 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m01:37:02.799780 [debug] [MainThread]: Command end result
[0m01:37:02.822940 [info ] [MainThread]: 
[0m01:37:02.823390 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:37:02.823703 [info ] [MainThread]: 
[0m01:37:02.824070 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "stg_trades"?
  LINE 17: FROM crypto_trading.main.trades
                ^
[0m01:37:02.824421 [info ] [MainThread]: 
[0m01:37:02.824703 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:37:02.825328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1431575, "process_user_time": 2.578461, "process_kernel_time": 0.183169, "process_mem_max_rss": "207112", "process_in_blocks": "424", "process_out_blocks": "2960", "command_success": false}
[0m01:37:02.825721 [debug] [MainThread]: Command `dbt run` failed at 01:37:02.825646 after 1.14 seconds
[0m01:37:02.825988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf603574f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6015cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf50c92140>]}
[0m01:37:02.826257 [debug] [MainThread]: Flushing usage events
[0m01:43:12.588522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe28f47460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe27477d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe27477550>]}


============================== 01:43:12.592547 | c01a95b3-7154-48d8-a9a6-4d6135bfae20 ==============================
[0m01:43:12.592547 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:43:12.593231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:43:12.793452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c01a95b3-7154-48d8-a9a6-4d6135bfae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2352b010>]}
[0m01:43:12.830944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c01a95b3-7154-48d8-a9a6-4d6135bfae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2785bdf0>]}
[0m01:43:12.833705 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:43:12.842364 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:43:12.964500 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:43:12.964894 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:43:12.970210 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:43:13.008620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c01a95b3-7154-48d8-a9a6-4d6135bfae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1b93c0a0>]}
[0m01:43:13.110315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c01a95b3-7154-48d8-a9a6-4d6135bfae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1b916dd0>]}
[0m01:43:13.110935 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m01:43:13.111496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c01a95b3-7154-48d8-a9a6-4d6135bfae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1b915480>]}
[0m01:43:13.113533 [info ] [MainThread]: 
[0m01:43:13.114184 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:43:13.119255 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m01:43:13.160366 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m01:43:13.160848 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m01:43:13.161190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:43:13.234100 [debug] [ThreadPool]: SQL status: OK in 0.073 seconds
[0m01:43:13.235687 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m01:43:13.238236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m01:43:13.238983 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m01:43:13.246341 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:43:13.246778 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m01:43:13.247053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:13.287295 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m01:43:13.288868 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:43:13.289216 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m01:43:13.290014 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:43:13.290426 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:43:13.290710 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m01:43:13.291527 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:43:13.292445 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:43:13.292676 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m01:43:13.292881 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m01:43:13.293524 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:43:13.293910 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m01:43:13.297379 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m01:43:13.302046 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:43:13.302411 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m01:43:13.302635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:43:13.341833 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m01:43:13.342472 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m01:43:13.342879 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m01:43:13.364459 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m01:43:13.366476 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m01:43:13.367911 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m01:43:13.368258 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m01:43:13.371636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c01a95b3-7154-48d8-a9a6-4d6135bfae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1b9843d0>]}
[0m01:43:13.372287 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:13.372685 [debug] [MainThread]: On master: BEGIN
[0m01:43:13.373009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:43:13.409103 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m01:43:13.409688 [debug] [MainThread]: On master: COMMIT
[0m01:43:13.410164 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:13.410443 [debug] [MainThread]: On master: COMMIT
[0m01:43:13.411574 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m01:43:13.411966 [debug] [MainThread]: On master: Close
[0m01:43:13.414207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:43:13.414717 [info ] [MainThread]: 
[0m01:43:13.417407 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m01:43:13.417964 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m01:43:13.418526 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m01:43:13.418794 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m01:43:13.425836 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m01:43:13.426506 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m01:43:13.452007 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m01:43:13.452708 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:43:13.453073 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m01:43:13.453377 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:43:13.491188 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m01:43:13.491753 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m01:43:13.492162 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:43:13.508857 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.main.trades
WHERE price > 0
  );

[0m01:43:13.509244 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:43:13.509646 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m01:43:13.515003 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m01:43:13.515276 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m01:43:13.518657 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM crypto_trading.main.trades
                ^
[0m01:43:13.519915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c01a95b3-7154-48d8-a9a6-4d6135bfae20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1ad807c0>]}
[0m01:43:13.520402 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.10s]
[0m01:43:13.520875 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m01:43:13.522405 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m01:43:13.522725 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m01:43:13.523051 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m01:43:13.523346 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m01:43:13.523741 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m01:43:13.524079 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m01:43:13.525273 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:13.525552 [debug] [MainThread]: On master: BEGIN
[0m01:43:13.525746 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:43:13.560651 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m01:43:13.561080 [debug] [MainThread]: On master: COMMIT
[0m01:43:13.561354 [debug] [MainThread]: Using duckdb connection "master"
[0m01:43:13.561586 [debug] [MainThread]: On master: COMMIT
[0m01:43:13.562095 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:43:13.562438 [debug] [MainThread]: On master: Close
[0m01:43:13.564619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:43:13.564848 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m01:43:13.565031 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m01:43:13.565335 [info ] [MainThread]: 
[0m01:43:13.565632 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m01:43:13.566218 [debug] [MainThread]: Command end result
[0m01:43:13.589316 [info ] [MainThread]: 
[0m01:43:13.589807 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:43:13.590141 [info ] [MainThread]: 
[0m01:43:13.590577 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM crypto_trading.main.trades
                ^
[0m01:43:13.590857 [info ] [MainThread]: 
[0m01:43:13.591166 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m01:43:13.592127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0622624, "process_user_time": 2.897458, "process_kernel_time": 0.279014, "process_mem_max_rss": "201644", "process_in_blocks": "146416", "process_out_blocks": "2080", "command_success": false}
[0m01:43:13.592548 [debug] [MainThread]: Command `dbt run` failed at 01:43:13.592469 after 1.06 seconds
[0m01:43:13.592851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe28f47460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1bc25c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe1b993cd0>]}
[0m01:43:13.593125 [debug] [MainThread]: Flushing usage events
[0m01:49:44.203944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1801f03400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18018fabf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f180043b340>]}


============================== 01:49:44.207105 | 881ec081-ad6b-45e9-9fba-bda0fbbf515f ==============================
[0m01:49:44.207105 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:49:44.207642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:49:44.368242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '881ec081-ad6b-45e9-9fba-bda0fbbf515f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1801dc51e0>]}
[0m01:49:44.403595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '881ec081-ad6b-45e9-9fba-bda0fbbf515f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fc52ace0>]}
[0m01:49:44.406246 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:49:44.415078 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:49:44.525753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:44.526077 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:44.530754 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:49:44.562436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '881ec081-ad6b-45e9-9fba-bda0fbbf515f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f49380a0>]}
[0m01:49:44.644514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '881ec081-ad6b-45e9-9fba-bda0fbbf515f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f491bc40>]}
[0m01:49:44.644964 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m01:49:44.645217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881ec081-ad6b-45e9-9fba-bda0fbbf515f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17f491b820>]}
[0m01:49:44.646499 [info ] [MainThread]: 
[0m01:49:44.646759 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:49:44.668220 [info ] [MainThread]: Done.
[0m01:49:44.669544 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.50688064, "process_user_time": 1.096453, "process_kernel_time": 0.081977, "process_mem_max_rss": "128612", "process_in_blocks": "7224", "process_out_blocks": "2016"}
[0m01:49:44.670034 [debug] [MainThread]: Command `dbt source freshness` succeeded at 01:49:44.669962 after 0.51 seconds
[0m01:49:44.670293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1801f03400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fc52ace0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18012475e0>]}
[0m01:49:44.670531 [debug] [MainThread]: Flushing usage events
[0m01:51:24.734420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cac2574c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cabc52680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0caa78b8b0>]}


============================== 01:51:24.736411 | aa581b88-f8a1-45d1-9205-538800213bdf ==============================
[0m01:51:24.736411 [info ] [MainThread]: Running with dbt=1.8.8
[0m01:51:24.736764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt source freshness --debug', 'send_anonymous_usage_stats': 'True'}
[0m01:51:24.867687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa581b88-f8a1-45d1-9205-538800213bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cac11d1e0>]}
[0m01:51:24.902880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa581b88-f8a1-45d1-9205-538800213bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0caafac6a0>]}
[0m01:51:24.904920 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m01:51:24.911288 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m01:51:24.996878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:51:24.997264 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:51:25.001872 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m01:51:25.033271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa581b88-f8a1-45d1-9205-538800213bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9ed38130>]}
[0m01:51:25.108197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa581b88-f8a1-45d1-9205-538800213bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9ed19060>]}
[0m01:51:25.108689 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m01:51:25.108977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa581b88-f8a1-45d1-9205-538800213bdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c9ed19ff0>]}
[0m01:51:25.110344 [info ] [MainThread]: 
[0m01:51:25.110627 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m01:51:25.129282 [info ] [MainThread]: Done.
[0m01:51:25.129984 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.428437, "process_user_time": 1.083617, "process_kernel_time": 0.070234, "process_mem_max_rss": "127364", "process_out_blocks": "2016", "process_in_blocks": "0"}
[0m01:51:25.130558 [debug] [MainThread]: Command `dbt source freshness` succeeded at 01:51:25.130478 after 0.43 seconds
[0m01:51:25.130876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cac2574c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cac18c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cac11d1e0>]}
[0m01:51:25.131174 [debug] [MainThread]: Flushing usage events
[0m02:01:52.494621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f356a79f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f356aa6df90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f356aa6f550>]}


============================== 02:01:52.497641 | a0a25b7b-557b-4761-a431-9e2751fe2683 ==============================
[0m02:01:52.497641 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:01:52.498040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:01:52.662188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0a25b7b-557b-4761-a431-9e2751fe2683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3568c674c0>]}
[0m02:01:52.698530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0a25b7b-557b-4761-a431-9e2751fe2683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3568f5f100>]}
[0m02:01:52.700382 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:01:52.707739 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:01:52.798891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:01:52.799780 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/sources.yml
[0m02:01:52.958398 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:01:52.958854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a0a25b7b-557b-4761-a431-9e2751fe2683', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355d583eb0>]}
[0m02:01:53.190021 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:01:53.252153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0a25b7b-557b-4761-a431-9e2751fe2683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355d279ed0>]}
[0m02:01:53.324292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0a25b7b-557b-4761-a431-9e2751fe2683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355d224700>]}
[0m02:01:53.324710 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:01:53.325017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0a25b7b-557b-4761-a431-9e2751fe2683', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355d2244f0>]}
[0m02:01:53.326449 [info ] [MainThread]: 
[0m02:01:53.326737 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m02:01:53.348287 [info ] [MainThread]: Done.
[0m02:01:53.349243 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 0.88845557, "process_user_time": 1.582335, "process_kernel_time": 0.118675, "process_mem_max_rss": "152608", "process_in_blocks": "480", "process_out_blocks": "2912"}
[0m02:01:53.349765 [debug] [MainThread]: Command `dbt source freshness` succeeded at 02:01:53.349677 after 0.89 seconds
[0m02:01:53.350054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f356a79f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355d2daa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f355d2dbb20>]}
[0m02:01:53.350311 [debug] [MainThread]: Flushing usage events
[0m02:02:00.922796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352fda7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352e2db970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352e2daf20>]}


============================== 02:02:00.924697 | 65a4dd8f-892b-41bb-8dfb-6130ec083ee5 ==============================
[0m02:02:00.924697 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:02:00.925060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:02:01.059089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65a4dd8f-892b-41bb-8dfb-6130ec083ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352ac7f6a0>]}
[0m02:02:01.094496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65a4dd8f-892b-41bb-8dfb-6130ec083ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352ef12c20>]}
[0m02:02:01.096309 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:02:01.103150 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:02:01.195921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:02:01.196243 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:02:01.200783 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:02:01.232991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65a4dd8f-892b-41bb-8dfb-6130ec083ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35228380a0>]}
[0m02:02:01.310434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65a4dd8f-892b-41bb-8dfb-6130ec083ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3522814df0>]}
[0m02:02:01.310877 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:02:01.311177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65a4dd8f-892b-41bb-8dfb-6130ec083ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3522815930>]}
[0m02:02:01.312603 [info ] [MainThread]: 
[0m02:02:01.313066 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:02:01.317067 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:02:01.345753 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:02:01.346246 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:02:01.346478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:02:01.404577 [debug] [ThreadPool]: SQL status: OK in 0.058 seconds
[0m02:02:01.405926 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:02:01.408579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:02:01.408950 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:02:01.414815 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:02:01.415064 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:02:01.415300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:02:01.449948 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m02:02:01.451488 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:02:01.451874 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:02:01.452559 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:02:01.452879 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:02:01.453153 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:02:01.454010 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:02:01.454868 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:02:01.455181 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:02:01.455431 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:02:01.455904 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:02:01.456221 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:02:01.460149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:02:01.464775 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:02:01.465010 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:02:01.465193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:02:01.500114 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m02:02:01.500599 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:02:01.501006 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:02:01.520494 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:02:01.521840 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:02:01.523193 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:02:01.523548 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:02:01.526073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65a4dd8f-892b-41bb-8dfb-6130ec083ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3522884400>]}
[0m02:02:01.526525 [debug] [MainThread]: Using duckdb connection "master"
[0m02:02:01.526926 [debug] [MainThread]: On master: BEGIN
[0m02:02:01.527165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:02:01.563837 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m02:02:01.564400 [debug] [MainThread]: On master: COMMIT
[0m02:02:01.564730 [debug] [MainThread]: Using duckdb connection "master"
[0m02:02:01.564963 [debug] [MainThread]: On master: COMMIT
[0m02:02:01.565453 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:02:01.565787 [debug] [MainThread]: On master: Close
[0m02:02:01.568050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:02:01.568336 [info ] [MainThread]: 
[0m02:02:01.570698 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:02:01.571214 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:02:01.571674 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:02:01.571912 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:02:01.578227 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:02:01.578886 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:02:01.599718 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:02:01.600297 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:02:01.600618 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:02:01.600879 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:02:01.635343 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m02:02:01.635802 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:02:01.636095 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:02:01.653265 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:02:01.653579 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:02:01.653934 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:02:01.659165 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:02:01.659504 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:02:01.662346 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:02:01.663544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65a4dd8f-892b-41bb-8dfb-6130ec083ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3521c807c0>]}
[0m02:02:01.664036 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m02:02:01.664569 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:02:01.666064 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:02:01.666376 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:02:01.666707 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:02:01.667007 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:02:01.667332 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:02:01.667784 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:02:01.668962 [debug] [MainThread]: Using duckdb connection "master"
[0m02:02:01.669217 [debug] [MainThread]: On master: BEGIN
[0m02:02:01.669479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:02:01.705550 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m02:02:01.705962 [debug] [MainThread]: On master: COMMIT
[0m02:02:01.706211 [debug] [MainThread]: Using duckdb connection "master"
[0m02:02:01.706463 [debug] [MainThread]: On master: COMMIT
[0m02:02:01.706991 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:02:01.707248 [debug] [MainThread]: On master: Close
[0m02:02:01.709210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:02:01.709423 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:02:01.709603 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:02:01.709887 [info ] [MainThread]: 
[0m02:02:01.710170 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m02:02:01.710736 [debug] [MainThread]: Command end result
[0m02:02:01.734697 [info ] [MainThread]: 
[0m02:02:01.735274 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:02:01.735662 [info ] [MainThread]: 
[0m02:02:01.736031 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:02:01.736305 [info ] [MainThread]: 
[0m02:02:01.736637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:02:01.737312 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8482342, "process_user_time": 2.289251, "process_kernel_time": 0.237052, "process_mem_max_rss": "208832", "process_in_blocks": "97760", "process_out_blocks": "2064", "command_success": false}
[0m02:02:01.737708 [debug] [MainThread]: Command `dbt run` failed at 02:02:01.737633 after 0.85 seconds
[0m02:02:01.737982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352fda7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352ef12c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f352289f6a0>]}
[0m02:02:01.738263 [debug] [MainThread]: Flushing usage events
[0m02:04:53.690270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3641a57520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3641dd2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3641dd3be0>]}


============================== 02:04:53.693330 | c71d2627-5266-4933-a9db-486b406c499d ==============================
[0m02:04:53.693330 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:04:53.693692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:04:53.848779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c71d2627-5266-4933-a9db-486b406c499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36419191e0>]}
[0m02:04:53.887850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c71d2627-5266-4933-a9db-486b406c499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3640763610>]}
[0m02:04:53.890425 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:04:53.899470 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:04:54.012680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:04:54.013016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:04:54.017811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:04:54.049010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c71d2627-5266-4933-a9db-486b406c499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36346e8070>]}
[0m02:04:54.128563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c71d2627-5266-4933-a9db-486b406c499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36346c4340>]}
[0m02:04:54.128975 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:04:54.129274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c71d2627-5266-4933-a9db-486b406c499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36346c40a0>]}
[0m02:04:54.130688 [info ] [MainThread]: 
[0m02:04:54.131141 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:04:54.134968 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:04:54.163701 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:04:54.164054 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:04:54.164317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:04:54.213116 [debug] [ThreadPool]: SQL status: OK in 0.049 seconds
[0m02:04:54.214511 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:04:54.217052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:04:54.217434 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:04:54.222868 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:04:54.223110 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:04:54.223306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:54.257075 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:04:54.258498 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:04:54.258815 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:04:54.259344 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:04:54.259658 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:04:54.259928 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:04:54.260459 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:04:54.261033 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:04:54.261235 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:04:54.261494 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:04:54.261940 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:04:54.262262 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:04:54.266035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:04:54.270322 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:04:54.270542 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:04:54.270722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:04:54.305245 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:04:54.305790 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:04:54.306078 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:04:54.322796 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m02:04:54.323911 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:04:54.325163 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:04:54.325494 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:04:54.328048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c71d2627-5266-4933-a9db-486b406c499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f363453b220>]}
[0m02:04:54.328395 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:54.328598 [debug] [MainThread]: On master: BEGIN
[0m02:04:54.328775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:04:54.362117 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m02:04:54.362639 [debug] [MainThread]: On master: COMMIT
[0m02:04:54.362979 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:54.363236 [debug] [MainThread]: On master: COMMIT
[0m02:04:54.363783 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:04:54.364152 [debug] [MainThread]: On master: Close
[0m02:04:54.366139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:04:54.366434 [info ] [MainThread]: 
[0m02:04:54.368712 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:04:54.369136 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:04:54.369601 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:04:54.369845 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:04:54.375956 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:04:54.376365 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:04:54.396613 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:04:54.397095 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:04:54.397346 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:04:54.397561 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:04:54.431520 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m02:04:54.431961 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:04:54.432258 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:04:54.447654 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:04:54.448103 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:04:54.448456 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:04:54.453486 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:04:54.453759 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:04:54.456570 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:04:54.457772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d2627-5266-4933-a9db-486b406c499d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3633950910>]}
[0m02:04:54.458251 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m02:04:54.458752 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:04:54.460185 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:04:54.460484 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:04:54.460821 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:04:54.461121 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:04:54.461525 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:04:54.461906 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:04:54.463039 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:54.463259 [debug] [MainThread]: On master: BEGIN
[0m02:04:54.463441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:04:54.498255 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m02:04:54.498812 [debug] [MainThread]: On master: COMMIT
[0m02:04:54.499074 [debug] [MainThread]: Using duckdb connection "master"
[0m02:04:54.499286 [debug] [MainThread]: On master: COMMIT
[0m02:04:54.499793 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:04:54.500072 [debug] [MainThread]: On master: Close
[0m02:04:54.502215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:04:54.502452 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:04:54.502671 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:04:54.503013 [info ] [MainThread]: 
[0m02:04:54.503365 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m02:04:54.504021 [debug] [MainThread]: Command end result
[0m02:04:54.527791 [info ] [MainThread]: 
[0m02:04:54.528252 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:04:54.528623 [info ] [MainThread]: 
[0m02:04:54.529059 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:04:54.529358 [info ] [MainThread]: 
[0m02:04:54.529780 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:04:54.530806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.87636185, "process_user_time": 2.437413, "process_kernel_time": 0.162494, "process_mem_max_rss": "205264", "process_in_blocks": "146440", "process_out_blocks": "2064", "command_success": false}
[0m02:04:54.531221 [debug] [MainThread]: Command `dbt run` failed at 02:04:54.531140 after 0.88 seconds
[0m02:04:54.531492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3641a57520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36419191e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3640763610>]}
[0m02:04:54.531793 [debug] [MainThread]: Flushing usage events
[0m02:08:35.200791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bcba74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bcf23850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bcf23d30>]}


============================== 02:08:35.203373 | b89af5d2-cd80-4716-8c79-1a4736fdea81 ==============================
[0m02:08:35.203373 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:08:35.203949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt ls --select source:raw.trades', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:08:35.373790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b89af5d2-cd80-4716-8c79-1a4736fdea81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2b7ad0070>]}
[0m02:08:35.410000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b89af5d2-cd80-4716-8c79-1a4736fdea81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bbeb65f0>]}
[0m02:08:35.412853 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:08:35.421737 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:08:35.539351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:08:35.539674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:08:35.544990 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:08:35.578037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b89af5d2-cd80-4716-8c79-1a4736fdea81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2af5f4130>]}
[0m02:08:35.744625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b89af5d2-cd80-4716-8c79-1a4736fdea81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2af567430>]}
[0m02:08:35.745093 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:08:35.745378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b89af5d2-cd80-4716-8c79-1a4736fdea81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2af567520>]}
[0m02:08:35.746923 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.58459574, "process_user_time": 1.268484, "process_kernel_time": 0.147498, "process_mem_max_rss": "163080", "process_in_blocks": "50584", "process_out_blocks": "1616"}
[0m02:08:35.747456 [debug] [MainThread]: Command `dbt ls` succeeded at 02:08:35.747372 after 0.59 seconds
[0m02:08:35.747724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2bcba74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2af779630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2af7706d0>]}
[0m02:08:35.747974 [debug] [MainThread]: Flushing usage events
[0m02:10:10.706072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b70cb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b739bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b739a5f0>]}


============================== 02:10:10.709145 | 900761a0-8d9a-473b-b9c5-74a21a78a6fd ==============================
[0m02:10:10.709145 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:10:10.709686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:10:10.716720 [info ] [MainThread]: dbt version: 1.8.8
[0m02:10:10.717219 [info ] [MainThread]: python version: 3.10.12
[0m02:10:10.717559 [info ] [MainThread]: python path: /root/crypto_pipeline/venv/bin/python3
[0m02:10:10.717869 [info ] [MainThread]: os info: Linux-5.15.153.1-microsoft-standard-WSL2-x86_64-with-glibc2.35
[0m02:10:10.823692 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m02:10:10.824632 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m02:10:10.825279 [info ] [MainThread]: Using dbt_project.yml file at /root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/dbt_project.yml
[0m02:10:10.828626 [info ] [MainThread]: adapter type: duckdb
[0m02:10:10.829521 [info ] [MainThread]: adapter version: 1.9.0
[0m02:10:10.904806 [info ] [MainThread]: Configuration:
[0m02:10:10.905294 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m02:10:10.905616 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m02:10:10.905861 [info ] [MainThread]: Required dependencies:
[0m02:10:10.906136 [debug] [MainThread]: Executing "git --help"
[0m02:10:10.916617 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m02:10:10.917271 [debug] [MainThread]: STDERR: "b''"
[0m02:10:10.917878 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m02:10:10.918432 [info ] [MainThread]: Connection:
[0m02:10:10.918819 [info ] [MainThread]:   database: crypto_trading
[0m02:10:10.919121 [info ] [MainThread]:   schema: main
[0m02:10:10.919373 [info ] [MainThread]:   path: /root/crypto_pipeline/crypto_trading.db
[0m02:10:10.919618 [info ] [MainThread]:   config_options: None
[0m02:10:10.919868 [info ] [MainThread]:   extensions: ['httpfs', 'aws']
[0m02:10:10.920102 [info ] [MainThread]:   settings: {}
[0m02:10:10.920331 [info ] [MainThread]:   external_root: .
[0m02:10:10.920559 [info ] [MainThread]:   use_credential_provider: None
[0m02:10:10.920787 [info ] [MainThread]:   attach: None
[0m02:10:10.921014 [info ] [MainThread]:   filesystems: None
[0m02:10:10.921238 [info ] [MainThread]:   remote: None
[0m02:10:10.921463 [info ] [MainThread]:   plugins: None
[0m02:10:10.921691 [info ] [MainThread]:   disable_transactions: False
[0m02:10:10.922068 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:10:10.923169 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m02:10:10.946371 [debug] [MainThread]: Using duckdb connection "debug"
[0m02:10:10.946772 [debug] [MainThread]: On debug: select 1 as id
[0m02:10:10.947003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:10:11.006149 [debug] [MainThread]: SQL status: OK in 0.059 seconds
[0m02:10:11.007233 [debug] [MainThread]: On debug: Close
[0m02:10:11.010142 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m02:10:11.010689 [info ] [MainThread]: [32mAll checks passed![0m
[0m02:10:11.011469 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3644276, "process_user_time": 1.303813, "process_kernel_time": 0.127646, "process_mem_max_rss": "171852", "process_in_blocks": "96720", "process_out_blocks": "24"}
[0m02:10:11.011928 [debug] [MainThread]: Command `dbt debug` succeeded at 02:10:11.011841 after 0.36 seconds
[0m02:10:11.012177 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m02:10:11.012456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b70cb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b55a9bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23b6a72b90>]}
[0m02:10:11.012733 [debug] [MainThread]: Flushing usage events
[0m02:12:54.759326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd87ef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd8b6b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd8b6a080>]}


============================== 02:12:54.761742 | ea16a7fd-56be-44e8-a9e9-0a7edd906c29 ==============================
[0m02:12:54.761742 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:12:54.762118 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:12:54.901173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea16a7fd-56be-44e8-a9e9-0a7edd906c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd715b7c0>]}
[0m02:12:54.936971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea16a7fd-56be-44e8-a9e9-0a7edd906c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd6de2890>]}
[0m02:12:54.938848 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:12:54.945667 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:12:55.034696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:12:55.035523 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/sources.yml
[0m02:12:55.186722 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:12:55.187187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ea16a7fd-56be-44e8-a9e9-0a7edd906c29', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcb4cdb10>]}
[0m02:12:55.429693 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:12:55.499207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea16a7fd-56be-44e8-a9e9-0a7edd906c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcb21e0b0>]}
[0m02:12:55.575367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea16a7fd-56be-44e8-a9e9-0a7edd906c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcb3bfb50>]}
[0m02:12:55.575928 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:12:55.576350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea16a7fd-56be-44e8-a9e9-0a7edd906c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcb3bf250>]}
[0m02:12:55.578569 [info ] [MainThread]: 
[0m02:12:55.579115 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:12:55.583953 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:12:55.608383 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:12:55.608768 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:12:55.609018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:12:55.652376 [debug] [ThreadPool]: SQL status: OK in 0.043 seconds
[0m02:12:55.653620 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:12:55.655863 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:12:55.656387 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:12:55.661402 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:12:55.661651 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:12:55.661990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:12:55.697858 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m02:12:55.699396 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:12:55.699718 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:12:55.700322 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:12:55.700608 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:12:55.701055 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:12:55.701891 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:12:55.702894 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:12:55.703522 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:12:55.703872 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:12:55.704586 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:12:55.704841 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:12:55.707388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:12:55.711781 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:12:55.712038 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:12:55.712242 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:12:55.750077 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m02:12:55.750642 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:12:55.751022 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:12:55.769340 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:12:55.770491 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:12:55.771727 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:12:55.772052 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:12:55.774733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea16a7fd-56be-44e8-a9e9-0a7edd906c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd378b6a0>]}
[0m02:12:55.775152 [debug] [MainThread]: Using duckdb connection "master"
[0m02:12:55.775484 [debug] [MainThread]: On master: BEGIN
[0m02:12:55.775709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:12:55.809710 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m02:12:55.810185 [debug] [MainThread]: On master: COMMIT
[0m02:12:55.810453 [debug] [MainThread]: Using duckdb connection "master"
[0m02:12:55.810696 [debug] [MainThread]: On master: COMMIT
[0m02:12:55.811257 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:12:55.811600 [debug] [MainThread]: On master: Close
[0m02:12:55.813993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:12:55.814380 [info ] [MainThread]: 
[0m02:12:55.816762 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:12:55.817375 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:12:55.818003 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:12:55.818301 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:12:55.824343 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:12:55.824901 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:12:55.847876 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:12:55.848570 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:12:55.848877 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:12:55.849118 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:12:55.884610 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m02:12:55.885158 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:12:55.885552 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:12:55.901530 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:12:55.901893 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:12:55.902306 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:12:55.907818 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:12:55.908130 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:12:55.910864 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:12:55.912050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea16a7fd-56be-44e8-a9e9-0a7edd906c29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd8b6b040>]}
[0m02:12:55.912537 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m02:12:55.913015 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:12:55.914620 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:12:55.914912 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:12:55.915248 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:12:55.915591 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:12:55.915982 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:12:55.916308 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:12:55.917621 [debug] [MainThread]: Using duckdb connection "master"
[0m02:12:55.917871 [debug] [MainThread]: On master: BEGIN
[0m02:12:55.918072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:12:55.953239 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m02:12:55.953785 [debug] [MainThread]: On master: COMMIT
[0m02:12:55.954041 [debug] [MainThread]: Using duckdb connection "master"
[0m02:12:55.954316 [debug] [MainThread]: On master: COMMIT
[0m02:12:55.954824 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:12:55.955161 [debug] [MainThread]: On master: Close
[0m02:12:55.957948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:12:55.958196 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:12:55.958383 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:12:55.958667 [info ] [MainThread]: 
[0m02:12:55.958948 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m02:12:55.959529 [debug] [MainThread]: Command end result
[0m02:12:55.982883 [info ] [MainThread]: 
[0m02:12:55.983332 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:12:55.983690 [info ] [MainThread]: 
[0m02:12:55.984088 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:12:55.984442 [info ] [MainThread]: 
[0m02:12:55.984746 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:12:55.985448 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2616878, "process_user_time": 2.667009, "process_kernel_time": 0.187707, "process_mem_max_rss": "207168", "process_in_blocks": "1840", "process_out_blocks": "2952", "command_success": false}
[0m02:12:55.985878 [debug] [MainThread]: Command `dbt run` failed at 02:12:55.985800 after 1.26 seconds
[0m02:12:55.986153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd87ef4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dd8063e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dcb3d7850>]}
[0m02:12:55.986417 [debug] [MainThread]: Flushing usage events
[0m02:13:11.936659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd0be74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd0f63850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd0f63d90>]}


============================== 02:13:11.938596 | 96914dd5-5a33-40bf-90b2-e16a90736e08 ==============================
[0m02:13:11.938596 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:13:11.938957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:13:12.073589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96914dd5-5a33-40bf-90b2-e16a90736e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcbaf7400>]}
[0m02:13:12.110019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96914dd5-5a33-40bf-90b2-e16a90736e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcf1e6770>]}
[0m02:13:12.112042 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:13:12.119147 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:13:12.207484 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:13:12.207842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:13:12.212503 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:13:12.245859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96914dd5-5a33-40bf-90b2-e16a90736e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc37e80a0>]}
[0m02:13:12.321260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96914dd5-5a33-40bf-90b2-e16a90736e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc37c4be0>]}
[0m02:13:12.321700 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:13:12.322013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96914dd5-5a33-40bf-90b2-e16a90736e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcf1dee00>]}
[0m02:13:12.323520 [info ] [MainThread]: 
[0m02:13:12.324011 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:13:12.327758 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:13:12.351487 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:13:12.351824 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:13:12.352057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:13:12.400254 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m02:13:12.401476 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:13:12.404139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:13:12.404613 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:13:12.410219 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:13:12.410489 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:13:12.410691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:13:12.447888 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m02:13:12.449276 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:13:12.449510 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:13:12.450273 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:13:12.450593 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:13:12.450878 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:13:12.451709 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:13:12.452787 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:13:12.453040 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:13:12.453252 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:13:12.453792 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:13:12.454046 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:13:12.458161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:13:12.462720 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:13:12.462963 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:13:12.463156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:13:12.498296 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m02:13:12.498809 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:13:12.499193 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:13:12.517780 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:13:12.518825 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:13:12.519230 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:13:12.519445 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:13:12.522004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96914dd5-5a33-40bf-90b2-e16a90736e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd09ad8a0>]}
[0m02:13:12.522471 [debug] [MainThread]: Using duckdb connection "master"
[0m02:13:12.522761 [debug] [MainThread]: On master: BEGIN
[0m02:13:12.523051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:13:12.556952 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m02:13:12.557435 [debug] [MainThread]: On master: COMMIT
[0m02:13:12.557761 [debug] [MainThread]: Using duckdb connection "master"
[0m02:13:12.558007 [debug] [MainThread]: On master: COMMIT
[0m02:13:12.558488 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:13:12.558741 [debug] [MainThread]: On master: Close
[0m02:13:12.561064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:13:12.561381 [info ] [MainThread]: 
[0m02:13:12.563531 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:13:12.564016 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:13:12.564520 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:13:12.564810 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:13:12.571028 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:13:12.571455 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:13:12.594545 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:13:12.595132 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:13:12.595404 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:13:12.595664 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:13:12.630770 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m02:13:12.631282 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:13:12.631717 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:13:12.647720 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:13:12.648097 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:13:12.648456 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:13:12.649693 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:13:12.649936 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:13:12.652764 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:13:12.654013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96914dd5-5a33-40bf-90b2-e16a90736e08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc2a448b0>]}
[0m02:13:12.654579 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m02:13:12.655048 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:13:12.656543 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:13:12.656890 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:13:12.657322 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:13:12.657649 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:13:12.657977 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:13:12.658489 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:13:12.659779 [debug] [MainThread]: Using duckdb connection "master"
[0m02:13:12.659996 [debug] [MainThread]: On master: BEGIN
[0m02:13:12.660180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:13:12.698577 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m02:13:12.699149 [debug] [MainThread]: On master: COMMIT
[0m02:13:12.699554 [debug] [MainThread]: Using duckdb connection "master"
[0m02:13:12.699870 [debug] [MainThread]: On master: COMMIT
[0m02:13:12.700396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:13:12.700691 [debug] [MainThread]: On master: Close
[0m02:13:12.702655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:13:12.702910 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:13:12.703096 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:13:12.703384 [info ] [MainThread]: 
[0m02:13:12.703665 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m02:13:12.704313 [debug] [MainThread]: Command end result
[0m02:13:12.727932 [info ] [MainThread]: 
[0m02:13:12.728432 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:13:12.728731 [info ] [MainThread]: 
[0m02:13:12.729084 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:13:12.729361 [info ] [MainThread]: 
[0m02:13:12.729643 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:13:12.730443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.82762504, "process_user_time": 2.328345, "process_kernel_time": 0.129352, "process_mem_max_rss": "202448", "process_out_blocks": "2080", "command_success": false, "process_in_blocks": "0"}
[0m02:13:12.730849 [debug] [MainThread]: Command `dbt run` failed at 02:13:12.730774 after 0.83 seconds
[0m02:13:12.731139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefd0be74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefcbaf7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefc37eaef0>]}
[0m02:13:12.731425 [debug] [MainThread]: Flushing usage events
[0m02:13:28.294339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c28a34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c2c1f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c2c1fd90>]}


============================== 02:13:28.297081 | f61e4ad1-0e80-4aeb-92cd-cd7d835bdc32 ==============================
[0m02:13:28.297081 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:13:28.297616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:13:28.502218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f61e4ad1-0e80-4aeb-92cd-cd7d835bdc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b574af50>]}
[0m02:13:28.542302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f61e4ad1-0e80-4aeb-92cd-cd7d835bdc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c0ea2770>]}
[0m02:13:28.544623 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:13:28.552794 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:13:28.647640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:13:28.647963 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:13:28.652625 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:13:28.685539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f61e4ad1-0e80-4aeb-92cd-cd7d835bdc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b54e80a0>]}
[0m02:13:28.762245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f61e4ad1-0e80-4aeb-92cd-cd7d835bdc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b54c4be0>]}
[0m02:13:28.762661 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:13:28.762961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61e4ad1-0e80-4aeb-92cd-cd7d835bdc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c0e9ae00>]}
[0m02:13:28.764400 [info ] [MainThread]: 
[0m02:13:28.764883 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:13:28.768978 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:13:28.792942 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:13:28.793357 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:13:28.793635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:13:28.841460 [debug] [ThreadPool]: SQL status: OK in 0.048 seconds
[0m02:13:28.842840 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:13:28.845477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:13:28.846115 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:13:28.852612 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:13:28.853049 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:13:28.853340 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:13:28.893803 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m02:13:28.895896 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:13:28.896324 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:13:28.897193 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:13:28.897722 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:13:28.898060 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:13:28.898816 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:13:28.899957 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:13:28.900306 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:13:28.900631 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:13:28.901423 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:13:28.901788 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:13:28.906338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:13:28.911352 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:13:28.911688 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:13:28.911968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:13:28.950702 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m02:13:28.951172 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:13:28.951527 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:13:28.970684 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:13:28.972052 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:13:28.972580 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:13:28.972909 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:13:28.976357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61e4ad1-0e80-4aeb-92cd-cd7d835bdc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c26698a0>]}
[0m02:13:28.976911 [debug] [MainThread]: Using duckdb connection "master"
[0m02:13:28.977219 [debug] [MainThread]: On master: BEGIN
[0m02:13:28.977459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:13:29.017049 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m02:13:29.017765 [debug] [MainThread]: On master: COMMIT
[0m02:13:29.018231 [debug] [MainThread]: Using duckdb connection "master"
[0m02:13:29.018740 [debug] [MainThread]: On master: COMMIT
[0m02:13:29.019756 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:13:29.020180 [debug] [MainThread]: On master: Close
[0m02:13:29.023202 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:13:29.023718 [info ] [MainThread]: 
[0m02:13:29.026214 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:13:29.026790 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:13:29.027459 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:13:29.027784 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:13:29.035395 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:13:29.036004 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:13:29.059163 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:13:29.059818 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:13:29.060176 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:13:29.060463 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:13:29.096757 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m02:13:29.097226 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:13:29.097620 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:13:29.112504 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:13:29.112994 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:13:29.113452 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:13:29.114986 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:13:29.115275 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:13:29.118286 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:13:29.119709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f61e4ad1-0e80-4aeb-92cd-cd7d835bdc32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b47508b0>]}
[0m02:13:29.120303 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m02:13:29.120845 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:13:29.122316 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:13:29.122852 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:13:29.123227 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:13:29.123604 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:13:29.124071 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:13:29.124907 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:13:29.126389 [debug] [MainThread]: Using duckdb connection "master"
[0m02:13:29.126712 [debug] [MainThread]: On master: BEGIN
[0m02:13:29.126924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:13:29.163647 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m02:13:29.164138 [debug] [MainThread]: On master: COMMIT
[0m02:13:29.164510 [debug] [MainThread]: Using duckdb connection "master"
[0m02:13:29.164755 [debug] [MainThread]: On master: COMMIT
[0m02:13:29.165413 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:13:29.165758 [debug] [MainThread]: On master: Close
[0m02:13:29.168374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:13:29.168751 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:13:29.168969 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:13:29.169278 [info ] [MainThread]: 
[0m02:13:29.169585 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m02:13:29.170204 [debug] [MainThread]: Command end result
[0m02:13:29.195466 [info ] [MainThread]: 
[0m02:13:29.195933 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:13:29.196274 [info ] [MainThread]: 
[0m02:13:29.196626 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:13:29.196907 [info ] [MainThread]: 
[0m02:13:29.197259 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:13:29.198034 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.94362086, "process_user_time": 2.392485, "process_kernel_time": 0.165474, "process_mem_max_rss": "199584", "process_out_blocks": "2048", "command_success": false, "process_in_blocks": "0"}
[0m02:13:29.198519 [debug] [MainThread]: Command `dbt run` failed at 02:13:29.198419 after 0.94 seconds
[0m02:13:29.198876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1c28a34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b574af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1b54eaef0>]}
[0m02:13:29.199158 [debug] [MainThread]: Flushing usage events
[0m02:14:52.981116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31708e3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316f227be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316f227d60>]}


============================== 02:14:52.984290 | bcfc179c-4864-4a80-9955-56a662abe13e ==============================
[0m02:14:52.984290 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:14:52.984901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:14:53.144255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcfc179c-4864-4a80-9955-56a662abe13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31707a51b0>]}
[0m02:14:53.180716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcfc179c-4864-4a80-9955-56a662abe13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316fa57ac0>]}
[0m02:14:53.183877 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:14:53.191671 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:14:53.306447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:14:53.307086 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:14:53.457546 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:14:53.458018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bcfc179c-4864-4a80-9955-56a662abe13e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316b70d7e0>]}
[0m02:14:53.600344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:14:53.612084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcfc179c-4864-4a80-9955-56a662abe13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3160138130>]}
[0m02:14:53.746576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcfc179c-4864-4a80-9955-56a662abe13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31610fbe80>]}
[0m02:14:53.747150 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:14:53.747497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcfc179c-4864-4a80-9955-56a662abe13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31610fbe80>]}
[0m02:14:53.749179 [info ] [MainThread]: 
[0m02:14:53.749649 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:14:53.753895 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:14:53.781629 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:14:53.781985 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:14:53.782180 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:14:53.835159 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m02:14:53.836350 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:14:53.838688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:14:53.839078 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:14:53.843842 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:14:53.844070 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:14:53.844343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:14:53.878861 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:14:53.880341 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:14:53.880659 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:14:53.881183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:14:53.881412 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:14:53.881608 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:14:53.882182 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:14:53.883000 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:14:53.883300 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:14:53.883569 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:14:53.884126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:14:53.884526 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:14:53.887535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:14:53.892171 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:14:53.892394 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:14:53.892585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:14:53.931477 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m02:14:53.932006 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:14:53.932300 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:14:53.949869 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:14:53.951088 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:14:53.952306 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:14:53.952620 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:14:53.955549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcfc179c-4864-4a80-9955-56a662abe13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31709737f0>]}
[0m02:14:53.955929 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:53.956137 [debug] [MainThread]: On master: BEGIN
[0m02:14:53.956322 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:14:53.989559 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m02:14:53.989970 [debug] [MainThread]: On master: COMMIT
[0m02:14:53.990220 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:53.990483 [debug] [MainThread]: On master: COMMIT
[0m02:14:53.991017 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:14:53.991376 [debug] [MainThread]: On master: Close
[0m02:14:53.993894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:14:53.994204 [info ] [MainThread]: 
[0m02:14:53.996923 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:14:53.997402 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:14:53.998971 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:14:53.999253 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:14:54.005063 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:14:54.005544 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:14:54.027702 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:14:54.028476 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:14:54.028800 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:14:54.029166 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:14:54.063935 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m02:14:54.064427 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:14:54.064763 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT *
FROM read_csv_auto(
    's3://crypto-pipeline-dev-data/raw/trades/*/*/*/*_trades.csv',
    hive_partitioning=true,
    filename_pattern='s3://crypto-pipeline-dev-data/raw/trades/{year}/{month}/{day}/btc-usdt_trades.csv'
) LIMIT 1;
/*
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
*/
  );

[0m02:14:54.067884 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT *
FROM read_csv_auto(
    's3://crypto-pipeline-dev-data/raw/trades/*/*/*/*_trades.csv',
    hive_partitioning=true,
    filename_pattern='s3://crypto-pipeline-dev-data/raw/trades/{year}/{month}/{day}/btc-usdt_trades.csv'
) LIMIT 1;
/*
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
*/
  );

[0m02:14:54.068183 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:14:54.068565 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:14:54.073743 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:14:54.073995 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:14:54.076032 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Parser Error: syntax error at or near ";"
[0m02:14:54.077263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcfc179c-4864-4a80-9955-56a662abe13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31611a7c40>]}
[0m02:14:54.077768 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.08s]
[0m02:14:54.078239 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:14:54.079833 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:14:54.080164 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:14:54.080519 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:14:54.080832 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:14:54.081193 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:14:54.081517 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:14:54.082664 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:54.082932 [debug] [MainThread]: On master: BEGIN
[0m02:14:54.083128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:14:54.121424 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m02:14:54.121906 [debug] [MainThread]: On master: COMMIT
[0m02:14:54.122163 [debug] [MainThread]: Using duckdb connection "master"
[0m02:14:54.122376 [debug] [MainThread]: On master: COMMIT
[0m02:14:54.122885 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:14:54.123234 [debug] [MainThread]: On master: Close
[0m02:14:54.125946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:14:54.126168 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:14:54.126346 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:14:54.126624 [info ] [MainThread]: 
[0m02:14:54.126911 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m02:14:54.127506 [debug] [MainThread]: Command end result
[0m02:14:54.152125 [info ] [MainThread]: 
[0m02:14:54.152598 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:14:54.152927 [info ] [MainThread]: 
[0m02:14:54.153272 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Parser Error: syntax error at or near ";"
[0m02:14:54.153550 [info ] [MainThread]: 
[0m02:14:54.153822 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:14:54.154790 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.208581, "process_user_time": 2.921191, "process_kernel_time": 0.277474, "process_mem_max_rss": "205324", "process_in_blocks": "148328", "process_out_blocks": "2960", "command_success": false}
[0m02:14:54.155233 [debug] [MainThread]: Command `dbt run` failed at 02:14:54.155145 after 1.21 seconds
[0m02:14:54.155687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31708e3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31701686d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316b70c9d0>]}
[0m02:14:54.155987 [debug] [MainThread]: Flushing usage events
[0m02:15:09.501782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc5553f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc53e83be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc53e83d60>]}


============================== 02:15:09.503559 | 942b1e32-e4f2-4a40-932b-d4fd09e3ae0a ==============================
[0m02:15:09.503559 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:15:09.503902 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:15:09.632701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '942b1e32-e4f2-4a40-932b-d4fd09e3ae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc554011b0>]}
[0m02:15:09.668092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '942b1e32-e4f2-4a40-932b-d4fd09e3ae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc546b3ac0>]}
[0m02:15:09.669875 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:15:09.676244 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:15:09.762603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:15:09.763178 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:15:09.906919 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:15:09.907359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '942b1e32-e4f2-4a40-932b-d4fd09e3ae0a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc482657e0>]}
[0m02:15:10.040244 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:15:10.051713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '942b1e32-e4f2-4a40-932b-d4fd09e3ae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc44f24130>]}
[0m02:15:10.173113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '942b1e32-e4f2-4a40-932b-d4fd09e3ae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc47eef280>]}
[0m02:15:10.173628 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:15:10.173993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '942b1e32-e4f2-4a40-932b-d4fd09e3ae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc47eef280>]}
[0m02:15:10.175595 [info ] [MainThread]: 
[0m02:15:10.176082 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:15:10.180262 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:15:10.202631 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:15:10.202956 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:15:10.203169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:15:10.244844 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m02:15:10.246222 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:15:10.248398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:15:10.248944 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:15:10.254019 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:15:10.254331 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:15:10.254553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:15:10.287874 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m02:15:10.289016 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:15:10.289286 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:15:10.289778 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:15:10.290081 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:15:10.290295 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:15:10.290815 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:15:10.291420 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:15:10.291633 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:15:10.291881 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:15:10.292322 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:15:10.292543 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:15:10.295382 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:15:10.299905 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:15:10.300135 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:15:10.300318 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:15:10.333970 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:15:10.334457 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:15:10.334719 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:15:10.351682 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:15:10.352791 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:15:10.353169 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:15:10.353367 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:15:10.355810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '942b1e32-e4f2-4a40-932b-d4fd09e3ae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc47e0eb00>]}
[0m02:15:10.356186 [debug] [MainThread]: Using duckdb connection "master"
[0m02:15:10.356448 [debug] [MainThread]: On master: BEGIN
[0m02:15:10.356659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:15:10.390473 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m02:15:10.390942 [debug] [MainThread]: On master: COMMIT
[0m02:15:10.391149 [debug] [MainThread]: Using duckdb connection "master"
[0m02:15:10.391344 [debug] [MainThread]: On master: COMMIT
[0m02:15:10.391787 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:15:10.392021 [debug] [MainThread]: On master: Close
[0m02:15:10.394187 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:15:10.394633 [info ] [MainThread]: 
[0m02:15:10.396877 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:15:10.397320 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:15:10.398853 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:15:10.399131 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:15:10.404954 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:15:10.405462 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:15:10.426333 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:15:10.426895 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:15:10.427144 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:15:10.427364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:15:10.463578 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m02:15:10.464074 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:15:10.464482 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT *
FROM read_csv_auto(
    's3://crypto-pipeline-dev-data/raw/trades/*/*/*/*_trades.csv',
    hive_partitioning=true,
    filename_pattern='s3://crypto-pipeline-dev-data/raw/trades/{year}/{month}/{day}/btc-usdt_trades.csv'
) LIMIT 1
/*
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
*/
  );

[0m02:15:10.466035 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT *
FROM read_csv_auto(
    's3://crypto-pipeline-dev-data/raw/trades/*/*/*/*_trades.csv',
    hive_partitioning=true,
    filename_pattern='s3://crypto-pipeline-dev-data/raw/trades/{year}/{month}/{day}/btc-usdt_trades.csv'
) LIMIT 1
/*
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
*/
  );

[0m02:15:10.466328 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:15:10.466770 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:15:10.468611 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:15:10.468864 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:15:10.471489 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Invalid named parameter "filename_pattern" for function read_csv_auto
  Candidates:
      hive_types_autocast BOOLEAN
      hive_types ANY
      union_by_name BOOLEAN
      hive_partitioning BOOLEAN
      filename ANY
      dtypes ANY
      column_types ANY
      auto_detect BOOLEAN
      sample_size BIGINT
      dateformat VARCHAR
      columns ANY
      all_varchar BOOLEAN
      new_line VARCHAR
      header BOOLEAN
      types ANY
      skip BIGINT
      compression VARCHAR
      comment VARCHAR
      quote VARCHAR
      max_line_size VARCHAR
      store_rejects BOOLEAN
      delim VARCHAR
      sep VARCHAR
      column_names VARCHAR[]
      buffer_size UBIGINT
      timestampformat VARCHAR
      normalize_names BOOLEAN
      ignore_errors BOOLEAN
      names VARCHAR[]
      allow_quoted_nulls BOOLEAN
      maximum_line_size VARCHAR
      rejects_table VARCHAR
      force_not_null VARCHAR[]
      parallel BOOLEAN
      auto_type_candidates ANY
      rejects_scan VARCHAR
      rejects_limit BIGINT
      nullstr ANY
      escape VARCHAR
      decimal_separator VARCHAR
      null_padding BOOLEAN
  
  LINE 7: FROM read_csv_auto(
               ^
[0m02:15:10.472758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '942b1e32-e4f2-4a40-932b-d4fd09e3ae0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc546b35b0>]}
[0m02:15:10.473231 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.07s]
[0m02:15:10.473747 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:15:10.475446 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:15:10.475745 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:15:10.476072 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:15:10.476371 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:15:10.476731 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:15:10.477061 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:15:10.478126 [debug] [MainThread]: Using duckdb connection "master"
[0m02:15:10.478353 [debug] [MainThread]: On master: BEGIN
[0m02:15:10.478545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:15:10.512326 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m02:15:10.512924 [debug] [MainThread]: On master: COMMIT
[0m02:15:10.513380 [debug] [MainThread]: Using duckdb connection "master"
[0m02:15:10.513702 [debug] [MainThread]: On master: COMMIT
[0m02:15:10.514371 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:15:10.514614 [debug] [MainThread]: On master: Close
[0m02:15:10.516627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:15:10.516918 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:15:10.517101 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:15:10.517388 [info ] [MainThread]: 
[0m02:15:10.517675 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m02:15:10.518306 [debug] [MainThread]: Command end result
[0m02:15:10.542321 [info ] [MainThread]: 
[0m02:15:10.542762 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:15:10.543070 [info ] [MainThread]: 
[0m02:15:10.543454 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Invalid named parameter "filename_pattern" for function read_csv_auto
  Candidates:
      hive_types_autocast BOOLEAN
      hive_types ANY
      union_by_name BOOLEAN
      hive_partitioning BOOLEAN
      filename ANY
      dtypes ANY
      column_types ANY
      auto_detect BOOLEAN
      sample_size BIGINT
      dateformat VARCHAR
      columns ANY
      all_varchar BOOLEAN
      new_line VARCHAR
      header BOOLEAN
      types ANY
      skip BIGINT
      compression VARCHAR
      comment VARCHAR
      quote VARCHAR
      max_line_size VARCHAR
      store_rejects BOOLEAN
      delim VARCHAR
      sep VARCHAR
      column_names VARCHAR[]
      buffer_size UBIGINT
      timestampformat VARCHAR
      normalize_names BOOLEAN
      ignore_errors BOOLEAN
      names VARCHAR[]
      allow_quoted_nulls BOOLEAN
      maximum_line_size VARCHAR
      rejects_table VARCHAR
      force_not_null VARCHAR[]
      parallel BOOLEAN
      auto_type_candidates ANY
      rejects_scan VARCHAR
      rejects_limit BIGINT
      nullstr ANY
      escape VARCHAR
      decimal_separator VARCHAR
      null_padding BOOLEAN
  
  LINE 7: FROM read_csv_auto(
               ^
[0m02:15:10.543788 [info ] [MainThread]: 
[0m02:15:10.544069 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:15:10.544793 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0760163, "process_user_time": 2.529719, "process_kernel_time": 0.107362, "process_mem_max_rss": "211936", "process_in_blocks": "168", "process_out_blocks": "2976", "command_success": false}
[0m02:15:10.545205 [debug] [MainThread]: Command `dbt run` failed at 02:15:10.545129 after 1.08 seconds
[0m02:15:10.545494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc5553f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc554011b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efc55826ad0>]}
[0m02:15:10.545757 [debug] [MainThread]: Flushing usage events
[0m02:18:44.066551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fd97b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fdc4b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fdc4a080>]}


============================== 02:18:44.069415 | 63c7ddfe-61f1-4f6f-bf2a-0c37e3871240 ==============================
[0m02:18:44.069415 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:18:44.069794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m02:18:44.234003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63c7ddfe-61f1-4f6f-bf2a-0c37e3871240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fc13b7c0>]}
[0m02:18:44.271225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63c7ddfe-61f1-4f6f-bf2a-0c37e3871240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fbdc2890>]}
[0m02:18:44.273737 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:18:44.282747 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:18:44.396561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:18:44.396905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:18:44.401957 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:18:44.437039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63c7ddfe-61f1-4f6f-bf2a-0c37e3871240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f0454130>]}
[0m02:18:44.526630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '63c7ddfe-61f1-4f6f-bf2a-0c37e3871240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f042d8d0>]}
[0m02:18:44.527050 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:18:44.527326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c7ddfe-61f1-4f6f-bf2a-0c37e3871240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f042f970>]}
[0m02:18:44.528677 [info ] [MainThread]: 
[0m02:18:44.529134 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:18:44.533343 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:18:44.561556 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:18:44.562190 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:18:44.562424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:18:44.618587 [debug] [ThreadPool]: SQL status: OK in 0.056 seconds
[0m02:18:44.619864 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:18:44.622011 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:18:44.622395 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:18:44.628304 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:18:44.628729 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:18:44.629018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:44.666422 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m02:18:44.667634 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:18:44.667886 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:18:44.668389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:18:44.668707 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:18:44.669050 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:18:44.669692 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:18:44.670336 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:18:44.670598 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:18:44.670817 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:18:44.671468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:18:44.671791 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:18:44.674611 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:18:44.679034 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:18:44.679268 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:18:44.679456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:18:44.716496 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m02:18:44.717094 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:18:44.717386 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:18:44.735908 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:18:44.737190 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:18:44.738386 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:18:44.738627 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:18:44.741158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63c7ddfe-61f1-4f6f-bf2a-0c37e3871240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f05d2710>]}
[0m02:18:44.741672 [debug] [MainThread]: Using duckdb connection "master"
[0m02:18:44.741909 [debug] [MainThread]: On master: BEGIN
[0m02:18:44.742155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:18:44.778328 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m02:18:44.778822 [debug] [MainThread]: On master: COMMIT
[0m02:18:44.779141 [debug] [MainThread]: Using duckdb connection "master"
[0m02:18:44.779507 [debug] [MainThread]: On master: COMMIT
[0m02:18:44.780312 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:18:44.780642 [debug] [MainThread]: On master: Close
[0m02:18:44.782851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:18:44.783146 [info ] [MainThread]: 
[0m02:18:44.785543 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:18:44.785989 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:18:44.786532 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:18:44.786876 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:18:44.793526 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:18:44.794086 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:18:44.817278 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:18:44.817987 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:18:44.818333 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:18:44.818627 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:18:44.854000 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m02:18:44.854686 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:18:44.854995 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT *
FROM read_csv_auto(
    's3://crypto-pipeline-dev-data/raw/trades/*/*/*/*_trades.csv',
    hive_partitioning=true,
    filename_pattern='s3://crypto-pipeline-dev-data/raw/trades/{year}/{month}/{day}/btc-usdt_trades.csv'
) LIMIT 1
/*
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
*/
  );

[0m02:18:44.856409 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT *
FROM read_csv_auto(
    's3://crypto-pipeline-dev-data/raw/trades/*/*/*/*_trades.csv',
    hive_partitioning=true,
    filename_pattern='s3://crypto-pipeline-dev-data/raw/trades/{year}/{month}/{day}/btc-usdt_trades.csv'
) LIMIT 1
/*
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
*/
  );

[0m02:18:44.856809 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:18:44.857285 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:18:44.862603 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:18:44.862856 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:18:44.865081 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Invalid named parameter "filename_pattern" for function read_csv_auto
  Candidates:
      hive_types_autocast BOOLEAN
      hive_types ANY
      union_by_name BOOLEAN
      hive_partitioning BOOLEAN
      filename ANY
      dtypes ANY
      column_types ANY
      auto_detect BOOLEAN
      sample_size BIGINT
      dateformat VARCHAR
      columns ANY
      all_varchar BOOLEAN
      new_line VARCHAR
      header BOOLEAN
      types ANY
      skip BIGINT
      compression VARCHAR
      comment VARCHAR
      quote VARCHAR
      max_line_size VARCHAR
      store_rejects BOOLEAN
      delim VARCHAR
      sep VARCHAR
      column_names VARCHAR[]
      buffer_size UBIGINT
      timestampformat VARCHAR
      normalize_names BOOLEAN
      ignore_errors BOOLEAN
      names VARCHAR[]
      allow_quoted_nulls BOOLEAN
      maximum_line_size VARCHAR
      rejects_table VARCHAR
      force_not_null VARCHAR[]
      parallel BOOLEAN
      auto_type_candidates ANY
      rejects_scan VARCHAR
      rejects_limit BIGINT
      nullstr ANY
      escape VARCHAR
      decimal_separator VARCHAR
      null_padding BOOLEAN
  
  LINE 7: FROM read_csv_auto(
               ^
[0m02:18:44.866306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63c7ddfe-61f1-4f6f-bf2a-0c37e3871240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86ef874850>]}
[0m02:18:44.866795 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.08s]
[0m02:18:44.867290 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:18:44.868929 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:18:44.869416 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:18:44.869763 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:18:44.870120 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:18:44.870582 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:18:44.871064 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:18:44.872398 [debug] [MainThread]: Using duckdb connection "master"
[0m02:18:44.872728 [debug] [MainThread]: On master: BEGIN
[0m02:18:44.873002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:18:44.906878 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m02:18:44.907314 [debug] [MainThread]: On master: COMMIT
[0m02:18:44.907566 [debug] [MainThread]: Using duckdb connection "master"
[0m02:18:44.907813 [debug] [MainThread]: On master: COMMIT
[0m02:18:44.908426 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:18:44.908713 [debug] [MainThread]: On master: Close
[0m02:18:44.911311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:18:44.911525 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:18:44.911704 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:18:44.911984 [info ] [MainThread]: 
[0m02:18:44.912266 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m02:18:44.912860 [debug] [MainThread]: Command end result
[0m02:18:44.936419 [info ] [MainThread]: 
[0m02:18:44.936875 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:18:44.937197 [info ] [MainThread]: 
[0m02:18:44.937579 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Binder Error: Invalid named parameter "filename_pattern" for function read_csv_auto
  Candidates:
      hive_types_autocast BOOLEAN
      hive_types ANY
      union_by_name BOOLEAN
      hive_partitioning BOOLEAN
      filename ANY
      dtypes ANY
      column_types ANY
      auto_detect BOOLEAN
      sample_size BIGINT
      dateformat VARCHAR
      columns ANY
      all_varchar BOOLEAN
      new_line VARCHAR
      header BOOLEAN
      types ANY
      skip BIGINT
      compression VARCHAR
      comment VARCHAR
      quote VARCHAR
      max_line_size VARCHAR
      store_rejects BOOLEAN
      delim VARCHAR
      sep VARCHAR
      column_names VARCHAR[]
      buffer_size UBIGINT
      timestampformat VARCHAR
      normalize_names BOOLEAN
      ignore_errors BOOLEAN
      names VARCHAR[]
      allow_quoted_nulls BOOLEAN
      maximum_line_size VARCHAR
      rejects_table VARCHAR
      force_not_null VARCHAR[]
      parallel BOOLEAN
      auto_type_candidates ANY
      rejects_scan VARCHAR
      rejects_limit BIGINT
      nullstr ANY
      escape VARCHAR
      decimal_separator VARCHAR
      null_padding BOOLEAN
  
  LINE 7: FROM read_csv_auto(
               ^
[0m02:18:44.937894 [info ] [MainThread]: 
[0m02:18:44.938186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:18:44.939206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9082954, "process_user_time": 2.434526, "process_kernel_time": 0.19647, "process_mem_max_rss": "205944", "process_in_blocks": "146152", "process_out_blocks": "2088", "command_success": false}
[0m02:18:44.939660 [debug] [MainThread]: Command `dbt run` failed at 02:18:44.939571 after 0.91 seconds
[0m02:18:44.939942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fd97b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86fcafdb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86f04bad10>]}
[0m02:18:44.940202 [debug] [MainThread]: Flushing usage events
[0m02:19:07.403177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa69e3f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa68373970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa68372f20>]}


============================== 02:19:07.405659 | 1ebf710a-3e3a-492d-b480-e0971aae1256 ==============================
[0m02:19:07.405659 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:19:07.406056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:19:07.561628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ebf710a-3e3a-492d-b480-e0971aae1256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa64d176a0>]}
[0m02:19:07.601074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ebf710a-3e3a-492d-b480-e0971aae1256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa6919ec20>]}
[0m02:19:07.603239 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:19:07.610722 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:19:07.703887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:19:07.704412 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:19:07.883178 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:19:07.883888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ebf710a-3e3a-492d-b480-e0971aae1256', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa5c842980>]}
[0m02:19:08.055701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:19:08.070260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ebf710a-3e3a-492d-b480-e0971aae1256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa55528130>]}
[0m02:19:08.218936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ebf710a-3e3a-492d-b480-e0971aae1256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa56570cd0>]}
[0m02:19:08.219449 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:19:08.219737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebf710a-3e3a-492d-b480-e0971aae1256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa56570cd0>]}
[0m02:19:08.221243 [info ] [MainThread]: 
[0m02:19:08.221706 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:19:08.226623 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:19:08.252454 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:19:08.252860 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:19:08.253156 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:19:08.297930 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m02:19:08.299295 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:19:08.301659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:19:08.302089 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:19:08.307340 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:19:08.307586 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:19:08.307779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:19:08.341622 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:19:08.343044 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:19:08.343325 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:19:08.343917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:19:08.344317 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:19:08.344638 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:19:08.345286 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:19:08.346550 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:19:08.346966 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:19:08.347392 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:19:08.348163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:19:08.348413 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:19:08.352318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:19:08.359468 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:19:08.359995 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:19:08.360279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:19:08.400593 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m02:19:08.401040 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:19:08.401276 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:19:08.420300 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:19:08.421575 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:19:08.422098 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:19:08.422379 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:19:08.426262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebf710a-3e3a-492d-b480-e0971aae1256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa5c70cc70>]}
[0m02:19:08.427099 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:08.427701 [debug] [MainThread]: On master: BEGIN
[0m02:19:08.428137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:19:08.466501 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m02:19:08.467311 [debug] [MainThread]: On master: COMMIT
[0m02:19:08.467785 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:08.468198 [debug] [MainThread]: On master: COMMIT
[0m02:19:08.469051 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:19:08.469426 [debug] [MainThread]: On master: Close
[0m02:19:08.473315 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:19:08.474139 [info ] [MainThread]: 
[0m02:19:08.476702 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:19:08.477421 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:19:08.479782 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:19:08.480233 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:19:08.486868 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:19:08.487634 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:19:08.511895 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:19:08.512650 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:19:08.512979 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:19:08.513359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:19:08.551209 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m02:19:08.551744 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:19:08.552133 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:19:08.569497 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:19:08.570038 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:19:08.570707 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:19:08.572235 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:19:08.572518 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:19:08.576760 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:19:08.578194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ebf710a-3e3a-492d-b480-e0971aae1256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa565cbd30>]}
[0m02:19:08.578805 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.10s]
[0m02:19:08.579361 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:19:08.581363 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:19:08.581830 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:19:08.582269 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:19:08.582641 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:19:08.583008 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:19:08.583476 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:19:08.584751 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:08.584999 [debug] [MainThread]: On master: BEGIN
[0m02:19:08.585217 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:19:08.626507 [debug] [MainThread]: SQL status: OK in 0.041 seconds
[0m02:19:08.627159 [debug] [MainThread]: On master: COMMIT
[0m02:19:08.627524 [debug] [MainThread]: Using duckdb connection "master"
[0m02:19:08.627859 [debug] [MainThread]: On master: COMMIT
[0m02:19:08.628530 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:19:08.629012 [debug] [MainThread]: On master: Close
[0m02:19:08.631729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:19:08.632047 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:19:08.632250 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:19:08.632566 [info ] [MainThread]: 
[0m02:19:08.632911 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m02:19:08.633537 [debug] [MainThread]: Command end result
[0m02:19:08.663894 [info ] [MainThread]: 
[0m02:19:08.664482 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:19:08.664989 [info ] [MainThread]: 
[0m02:19:08.665452 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:19:08.665943 [info ] [MainThread]: 
[0m02:19:08.666285 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:19:08.667017 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3097517, "process_user_time": 2.78934, "process_kernel_time": 0.185461, "process_mem_max_rss": "205792", "process_in_blocks": "744", "process_out_blocks": "2968", "command_success": false}
[0m02:19:08.667454 [debug] [MainThread]: Command `dbt run` failed at 02:19:08.667371 after 1.31 seconds
[0m02:19:08.667785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa69e3f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa564f8cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa564f8c40>]}
[0m02:19:08.668062 [debug] [MainThread]: Flushing usage events
[0m02:22:52.966898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bea83f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8beabba050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8beabbbdc0>]}


============================== 02:22:52.970098 | 48a1a815-7bba-4765-863c-96d36896e8b8 ==============================
[0m02:22:52.970098 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:22:52.970449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:22:53.133976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48a1a815-7bba-4765-863c-96d36896e8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bea7011e0>]}
[0m02:22:53.170128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48a1a815-7bba-4765-863c-96d36896e8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be9b875b0>]}
[0m02:22:53.173099 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:22:53.181363 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:22:53.298929 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:22:53.299915 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/sources.yml
[0m02:22:53.459664 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:22:53.460154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '48a1a815-7bba-4765-863c-96d36896e8b8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bdd1f5510>]}
[0m02:22:53.688110 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:22:53.749773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48a1a815-7bba-4765-863c-96d36896e8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bdc17c2e0>]}
[0m02:22:53.829869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48a1a815-7bba-4765-863c-96d36896e8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bdd3c1720>]}
[0m02:22:53.830278 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:22:53.830559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48a1a815-7bba-4765-863c-96d36896e8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bdd3c3fd0>]}
[0m02:22:53.831929 [info ] [MainThread]: 
[0m02:22:53.832372 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:22:53.836716 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:22:53.866126 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:22:53.866487 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:22:53.866714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:22:53.919511 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m02:22:53.920687 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:22:53.923161 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:22:53.923557 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:22:53.928703 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:22:53.928960 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:22:53.929157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:22:53.964578 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m02:22:53.965828 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:22:53.966116 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:22:53.966637 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:22:53.967038 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:22:53.967317 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:22:53.968189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:22:53.969065 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:22:53.969368 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:22:53.969554 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:22:53.970076 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:22:53.970439 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:22:53.973216 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:22:53.977694 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:22:53.977917 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:22:53.978124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:22:54.012019 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:22:54.012528 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:22:54.012875 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:22:54.030941 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:22:54.031950 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:22:54.033185 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:22:54.033506 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:22:54.036223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48a1a815-7bba-4765-863c-96d36896e8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bdd51ff10>]}
[0m02:22:54.036626 [debug] [MainThread]: Using duckdb connection "master"
[0m02:22:54.036919 [debug] [MainThread]: On master: BEGIN
[0m02:22:54.037231 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:22:54.072713 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m02:22:54.073226 [debug] [MainThread]: On master: COMMIT
[0m02:22:54.073556 [debug] [MainThread]: Using duckdb connection "master"
[0m02:22:54.073855 [debug] [MainThread]: On master: COMMIT
[0m02:22:54.074378 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:22:54.074722 [debug] [MainThread]: On master: Close
[0m02:22:54.077341 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:22:54.077640 [info ] [MainThread]: 
[0m02:22:54.079977 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:22:54.080434 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:22:54.080956 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:22:54.081220 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:22:54.087599 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:22:54.088143 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:22:54.110483 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:22:54.111035 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:22:54.111309 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:22:54.111544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:22:54.144951 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m02:22:54.145509 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:22:54.145846 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:22:54.161622 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:22:54.161946 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:22:54.162336 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:22:54.167524 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:22:54.167901 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:22:54.170317 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:22:54.171448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48a1a815-7bba-4765-863c-96d36896e8b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8be9b49c00>]}
[0m02:22:54.171933 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m02:22:54.172394 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:22:54.173973 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:22:54.174362 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:22:54.174755 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:22:54.175079 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:22:54.175424 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:22:54.175866 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:22:54.177362 [debug] [MainThread]: Using duckdb connection "master"
[0m02:22:54.177719 [debug] [MainThread]: On master: BEGIN
[0m02:22:54.178069 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:22:54.211344 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m02:22:54.211777 [debug] [MainThread]: On master: COMMIT
[0m02:22:54.212081 [debug] [MainThread]: Using duckdb connection "master"
[0m02:22:54.212304 [debug] [MainThread]: On master: COMMIT
[0m02:22:54.212791 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:22:54.213058 [debug] [MainThread]: On master: Close
[0m02:22:54.215293 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:22:54.215524 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:22:54.215771 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:22:54.216173 [info ] [MainThread]: 
[0m02:22:54.216574 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m02:22:54.217269 [debug] [MainThread]: Command end result
[0m02:22:54.241021 [info ] [MainThread]: 
[0m02:22:54.241488 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:22:54.241825 [info ] [MainThread]: 
[0m02:22:54.242195 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:22:54.242471 [info ] [MainThread]: 
[0m02:22:54.242752 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m02:22:54.243755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.3123866, "process_user_time": 2.607667, "process_kernel_time": 0.28115, "process_mem_max_rss": "206572", "process_in_blocks": "146888", "process_out_blocks": "2976", "command_success": false}
[0m02:22:54.244404 [debug] [MainThread]: Command `dbt run` failed at 02:22:54.244215 after 1.31 seconds
[0m02:22:54.244694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bea83f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bdc138700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bdd3e27a0>]}
[0m02:22:54.244950 [debug] [MainThread]: Flushing usage events
[0m02:23:29.075374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd37bc3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd375babf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd360fa530>]}


============================== 02:23:29.077210 | 4b4544a3-b9a3-4d41-9f4a-e37df523a8ca ==============================
[0m02:23:29.077210 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:23:29.077608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:23:29.219769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd32b2f610>]}
[0m02:23:29.259845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd36f208b0>]}
[0m02:23:29.261651 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:23:29.268396 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:23:29.400574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:23:29.401586 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:23:29.737657 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:23:29.738347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a6dcd00>]}
[0m02:23:29.919049 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:23:29.932261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a587700>]}
[0m02:23:30.080098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a5ec760>]}
[0m02:23:30.080701 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 418 macros
[0m02:23:30.081065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a5ec760>]}
[0m02:23:30.083249 [info ] [MainThread]: 
[0m02:23:30.083776 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:23:30.088197 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:23:30.112703 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:23:30.113101 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:23:30.113346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:23:30.158923 [debug] [ThreadPool]: SQL status: OK in 0.045 seconds
[0m02:23:30.160209 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:23:30.163690 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:23:30.164358 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:23:30.170333 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:23:30.170744 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:23:30.171023 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:30.208126 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m02:23:30.210057 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:23:30.210623 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:23:30.211618 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:23:30.211937 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:23:30.212298 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:23:30.213237 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:23:30.214296 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:23:30.214595 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:23:30.214953 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:23:30.215710 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:23:30.216089 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:23:30.219989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:23:30.225143 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:23:30.225498 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:23:30.225722 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:23:30.262735 [debug] [ThreadPool]: SQL status: OK in 0.037 seconds
[0m02:23:30.263293 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:23:30.263556 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:23:30.288374 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m02:23:30.289842 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:23:30.290401 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:23:30.290750 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:23:30.294550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a50d990>]}
[0m02:23:30.295326 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:30.295760 [debug] [MainThread]: On master: BEGIN
[0m02:23:30.296093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:23:30.333903 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m02:23:30.334540 [debug] [MainThread]: On master: COMMIT
[0m02:23:30.334865 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:30.335109 [debug] [MainThread]: On master: COMMIT
[0m02:23:30.335630 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:23:30.335884 [debug] [MainThread]: On master: Close
[0m02:23:30.339046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:23:30.339845 [info ] [MainThread]: 
[0m02:23:30.342105 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:23:30.342598 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m02:23:30.344812 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m02:23:30.345290 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:23:30.352185 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:23:30.352822 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:23:30.377834 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:23:30.378420 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:23:30.378676 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:23:30.378906 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:23:30.417006 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m02:23:30.417509 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:23:30.417819 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT * FROM system.information_schema.tables
/*
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
*/
  );

[0m02:23:30.419197 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:23:30.425855 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:23:30.426305 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */
alter view "crypto_trading"."main"."stg_trades__dbt_tmp" rename to "stg_trades"
[0m02:23:30.427447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:23:30.441774 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: COMMIT
[0m02:23:30.442441 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:23:30.442900 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: COMMIT
[0m02:23:30.447814 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m02:23:30.453196 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:23:30.453706 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */
drop view if exists "crypto_trading"."main"."stg_trades__dbt_backup" cascade
[0m02:23:30.455302 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m02:23:30.457391 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:23:30.467765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd37a4f520>]}
[0m02:23:30.468460 [info ] [Thread-1 (]: 1 of 3 OK created sql view model main.stg_trades ............................... [[32mOK[0m in 0.12s]
[0m02:23:30.469074 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:23:30.470203 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:23:30.470641 [info ] [Thread-1 (]: 2 of 3 START sql table model main.hourly_ohlcv ................................. [RUN]
[0m02:23:30.471082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_pipeline.stg_trades, now model.crypto_pipeline.hourly_ohlcv)
[0m02:23:30.471349 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.hourly_ohlcv
[0m02:23:30.473766 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.hourly_ohlcv"
[0m02:23:30.474379 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.hourly_ohlcv
[0m02:23:30.491279 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.hourly_ohlcv"
[0m02:23:30.491955 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.hourly_ohlcv"
[0m02:23:30.492290 [debug] [Thread-1 (]: On model.crypto_pipeline.hourly_ohlcv: BEGIN
[0m02:23:30.492541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:23:30.530161 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m02:23:30.530630 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.hourly_ohlcv"
[0m02:23:30.531012 [debug] [Thread-1 (]: On model.crypto_pipeline.hourly_ohlcv: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.hourly_ohlcv"} */

  
    
    

    create  table
      "crypto_trading"."main"."hourly_ohlcv__dbt_tmp"
  
    as (
      -- mart/hourly_ohlcv.sql
WITH hourly_trades AS (
    SELECT
        DATE_TRUNC('hour', traded_at) AS trading_hour,
        price,
        qty,
        tick_volume
    FROM "crypto_trading"."main"."stg_trades"
)

SELECT 
    trading_hour,
    FIRST_VALUE(price) OVER (
        PARTITION BY trading_hour
        ORDER BY trading_hour
    ) AS open,
    MAX(price) AS high,
    MIN(price) AS low,
    LAST_VALUE(price) OVER (
        PARTITION BY trading_hour
        ORDER BY trading_hour
    ) AS close,
    SUM(tick_volume) AS volume,
    COUNT(*) AS trade_count
FROM hourly_trades
GROUP BY trading_hour
    );
  
  
[0m02:23:30.533410 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.hourly_ohlcv"} */

  
    
    

    create  table
      "crypto_trading"."main"."hourly_ohlcv__dbt_tmp"
  
    as (
      -- mart/hourly_ohlcv.sql
WITH hourly_trades AS (
    SELECT
        DATE_TRUNC('hour', traded_at) AS trading_hour,
        price,
        qty,
        tick_volume
    FROM "crypto_trading"."main"."stg_trades"
)

SELECT 
    trading_hour,
    FIRST_VALUE(price) OVER (
        PARTITION BY trading_hour
        ORDER BY trading_hour
    ) AS open,
    MAX(price) AS high,
    MIN(price) AS low,
    LAST_VALUE(price) OVER (
        PARTITION BY trading_hour
        ORDER BY trading_hour
    ) AS close,
    SUM(tick_volume) AS volume,
    COUNT(*) AS trade_count
FROM hourly_trades
GROUP BY trading_hour
    );
  
  
[0m02:23:30.533823 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:23:30.534299 [debug] [Thread-1 (]: On model.crypto_pipeline.hourly_ohlcv: ROLLBACK
[0m02:23:30.535749 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.hourly_ohlcv'
[0m02:23:30.536021 [debug] [Thread-1 (]: On model.crypto_pipeline.hourly_ohlcv: Close
[0m02:23:30.539916 [debug] [Thread-1 (]: Runtime Error in model hourly_ohlcv (models/mart/hourly_ohlcv.sql)
  Binder Error: Referenced column "traded_at" not found in FROM clause!
  Candidate bindings: "stg_trades.table_catalog", "stg_trades.table_name", "stg_trades.table_type", "stg_trades.table_schema", "stg_trades.reference_generation"
  LINE 14:         DATE_TRUNC('hour', traded_at) AS trading_hour,
                                      ^
[0m02:23:30.540670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd2a50f070>]}
[0m02:23:30.541328 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.hourly_ohlcv ........................ [[31mERROR[0m in 0.07s]
[0m02:23:30.541984 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:23:30.542403 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:23:30.543721 [info ] [Thread-1 (]: 3 of 3 START sql table model main.minute_ohlcv ................................. [RUN]
[0m02:23:30.544441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_pipeline.hourly_ohlcv, now model.crypto_pipeline.minute_ohlcv)
[0m02:23:30.544941 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.minute_ohlcv
[0m02:23:30.547925 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.minute_ohlcv"
[0m02:23:30.548435 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.minute_ohlcv
[0m02:23:30.551730 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.minute_ohlcv"
[0m02:23:30.552447 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.minute_ohlcv"
[0m02:23:30.552811 [debug] [Thread-1 (]: On model.crypto_pipeline.minute_ohlcv: BEGIN
[0m02:23:30.553075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:23:30.591288 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m02:23:30.592258 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.minute_ohlcv"
[0m02:23:30.592786 [debug] [Thread-1 (]: On model.crypto_pipeline.minute_ohlcv: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.minute_ohlcv"} */

  
    
    

    create  table
      "crypto_trading"."main"."minute_ohlcv__dbt_tmp"
  
    as (
      -- mart/minute_ohlcv.sql
WITH minute_trades AS (
    SELECT
        DATE_TRUNC('minute', traded_at) AS trading_minute,
        price,
        qty,
        tick_volume,
        traded_at  
    FROM "crypto_trading"."main"."stg_trades"
)

SELECT 
    trading_minute,
    FIRST_VALUE(price) OVER (
        PARTITION BY trading_minute
        ORDER BY traded_at
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) AS open,
    MAX(price) AS high,
    MIN(price) AS low,
    LAST_VALUE(price) OVER (
        PARTITION BY trading_minute
        ORDER BY traded_at
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) AS close,
    SUM(tick_volume) AS volume,
    COUNT(*) AS trade_count
FROM minute_trades
GROUP BY trading_minute
ORDER BY trading_minute
    );
  
  
[0m02:23:30.595065 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.minute_ohlcv"} */

  
    
    

    create  table
      "crypto_trading"."main"."minute_ohlcv__dbt_tmp"
  
    as (
      -- mart/minute_ohlcv.sql
WITH minute_trades AS (
    SELECT
        DATE_TRUNC('minute', traded_at) AS trading_minute,
        price,
        qty,
        tick_volume,
        traded_at  
    FROM "crypto_trading"."main"."stg_trades"
)

SELECT 
    trading_minute,
    FIRST_VALUE(price) OVER (
        PARTITION BY trading_minute
        ORDER BY traded_at
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) AS open,
    MAX(price) AS high,
    MIN(price) AS low,
    LAST_VALUE(price) OVER (
        PARTITION BY trading_minute
        ORDER BY traded_at
        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING
    ) AS close,
    SUM(tick_volume) AS volume,
    COUNT(*) AS trade_count
FROM minute_trades
GROUP BY trading_minute
ORDER BY trading_minute
    );
  
  
[0m02:23:30.595443 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:23:30.595802 [debug] [Thread-1 (]: On model.crypto_pipeline.minute_ohlcv: ROLLBACK
[0m02:23:30.596362 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.minute_ohlcv'
[0m02:23:30.596594 [debug] [Thread-1 (]: On model.crypto_pipeline.minute_ohlcv: Close
[0m02:23:30.599518 [debug] [Thread-1 (]: Runtime Error in model minute_ohlcv (models/mart/minute_ohlcv.sql)
  Binder Error: Referenced column "traded_at" not found in FROM clause!
  Candidate bindings: "stg_trades.table_catalog", "stg_trades.table_name", "stg_trades.table_type", "stg_trades.table_schema", "stg_trades.reference_generation"
  LINE 14:         DATE_TRUNC('minute', traded_at) AS trading_minute,
                                        ^
[0m02:23:30.600028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b4544a3-b9a3-4d41-9f4a-e37df523a8ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccc7402740>]}
[0m02:23:30.600598 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model main.minute_ohlcv ........................ [[31mERROR[0m in 0.06s]
[0m02:23:30.601138 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:23:30.602516 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:30.602793 [debug] [MainThread]: On master: BEGIN
[0m02:23:30.603031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:23:30.641934 [debug] [MainThread]: SQL status: OK in 0.039 seconds
[0m02:23:30.642372 [debug] [MainThread]: On master: COMMIT
[0m02:23:30.642649 [debug] [MainThread]: Using duckdb connection "master"
[0m02:23:30.643003 [debug] [MainThread]: On master: COMMIT
[0m02:23:30.643593 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:23:30.643851 [debug] [MainThread]: On master: Close
[0m02:23:30.646130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:23:30.646412 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:23:30.646611 [debug] [MainThread]: Connection 'model.crypto_pipeline.minute_ohlcv' was properly closed.
[0m02:23:30.646909 [info ] [MainThread]: 
[0m02:23:30.647209 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m02:23:30.647983 [debug] [MainThread]: Command end result
[0m02:23:30.672499 [info ] [MainThread]: 
[0m02:23:30.672956 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:23:30.673273 [info ] [MainThread]: 
[0m02:23:30.673616 [error] [MainThread]:   Runtime Error in model hourly_ohlcv (models/mart/hourly_ohlcv.sql)
  Binder Error: Referenced column "traded_at" not found in FROM clause!
  Candidate bindings: "stg_trades.table_catalog", "stg_trades.table_name", "stg_trades.table_type", "stg_trades.table_schema", "stg_trades.reference_generation"
  LINE 14:         DATE_TRUNC('hour', traded_at) AS trading_hour,
                                      ^
[0m02:23:30.673942 [info ] [MainThread]: 
[0m02:23:30.674374 [error] [MainThread]:   Runtime Error in model minute_ohlcv (models/mart/minute_ohlcv.sql)
  Binder Error: Referenced column "traded_at" not found in FROM clause!
  Candidate bindings: "stg_trades.table_catalog", "stg_trades.table_name", "stg_trades.table_type", "stg_trades.table_schema", "stg_trades.reference_generation"
  LINE 14:         DATE_TRUNC('minute', traded_at) AS trading_minute,
                                        ^
[0m02:23:30.674650 [info ] [MainThread]: 
[0m02:23:30.674934 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m02:23:30.675610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.63389, "process_user_time": 3.535889, "process_kernel_time": 0.201851, "process_mem_max_rss": "211648", "process_in_blocks": "280", "process_out_blocks": "3568", "command_success": false}
[0m02:23:30.676063 [debug] [MainThread]: Command `dbt run` failed at 02:23:30.675972 after 1.63 seconds
[0m02:23:30.676350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd37bc3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccc757cc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fccc750b100>]}
[0m02:23:30.676653 [debug] [MainThread]: Flushing usage events
[0m02:27:05.675814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f689b7774f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f689baf3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f689baf3d90>]}


============================== 02:27:05.679201 | 9bb128de-e035-456b-be35-1f606a504f67 ==============================
[0m02:27:05.679201 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:27:05.679611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:27:05.852754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9bb128de-e035-456b-be35-1f606a504f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6896682f50>]}
[0m02:27:05.889257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9bb128de-e035-456b-be35-1f606a504f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6899d8a770>]}
[0m02:27:05.892446 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:27:05.901503 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:27:06.024759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:27:06.025404 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:27:06.136475 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_trades (models/staging/stg_trades.sql)
  expected token 'end of print statement', got 'system'
    line 2
      {{ SELECT * FROM system.information_schema.tables }}
[0m02:27:06.137653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.49974206, "process_user_time": 1.238831, "process_kernel_time": 0.158824, "process_mem_max_rss": "128956", "process_in_blocks": "48624", "process_out_blocks": "8", "command_success": false}
[0m02:27:06.138201 [debug] [MainThread]: Command `dbt run` failed at 02:27:06.138118 after 0.50 seconds
[0m02:27:06.138478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f689b7774f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e1fca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f688e1fd7b0>]}
[0m02:27:06.138780 [debug] [MainThread]: Flushing usage events
[0m02:29:29.148354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a9b7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935ad33e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935ad33070>]}


============================== 02:29:29.150467 | 4fff93e7-9d5c-4521-b306-e6489fd9fde4 ==============================
[0m02:29:29.150467 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:29:29.150840 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select debug_tables', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:29:29.303281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fff93e7-9d5c-4521-b306-e6489fd9fde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a8791e0>]}
[0m02:29:29.366890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fff93e7-9d5c-4521-b306-e6489fd9fde4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9358faa3e0>]}
[0m02:29:29.370072 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:29:29.382886 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:29:29.539554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m02:29:29.541056 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:29:29.542005 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:29:29.681767 [info ] [MainThread]: Available tables:
[0m02:29:29.689139 [error] [MainThread]: Encountered an error:
Compilation Error in model debug_tables (models/staging/debug_tables.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:29:29.690494 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5769851, "process_user_time": 1.190532, "process_kernel_time": 0.177103, "process_mem_max_rss": "143688", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m02:29:29.691385 [debug] [MainThread]: Command `dbt run` failed at 02:29:29.691232 after 0.58 seconds
[0m02:29:29.691954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f935a9b7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934d468a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f934d469750>]}
[0m02:29:29.692353 [debug] [MainThread]: Flushing usage events
[0m02:30:17.370838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0625fe3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062635e0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f062635fb50>]}


============================== 02:30:17.372730 | 697d9be3-eec2-496e-9188-4110a9af8361 ==============================
[0m02:30:17.372730 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:30:17.373101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select debug_tables', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:30:17.512197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '697d9be3-eec2-496e-9188-4110a9af8361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0620ef06d0>]}
[0m02:30:17.551516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '697d9be3-eec2-496e-9188-4110a9af8361', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0624d252a0>]}
[0m02:30:17.553350 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:30:17.560502 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:30:17.649007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m02:30:17.649484 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:30:17.649737 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://macros/debug_tables.sql
[0m02:30:17.650030 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:30:17.759012 [info ] [MainThread]: Available tables:
[0m02:30:17.764699 [error] [MainThread]: Encountered an error:
Compilation Error in model debug_tables (models/staging/debug_tables.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:30:17.765432 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.42999208, "process_user_time": 1.135992, "process_kernel_time": 0.080424, "process_mem_max_rss": "130200", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m02:30:17.765852 [debug] [MainThread]: Command `dbt run` failed at 02:30:17.765774 after 0.43 seconds
[0m02:30:17.766120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0625fe3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0618aebb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0618aeba90>]}
[0m02:30:17.766374 [debug] [MainThread]: Flushing usage events
[0m02:31:06.588767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a0ecb74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a0d1ebc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a0d1e9f60>]}


============================== 02:31:06.590666 | 0deca028-fca8-4a59-ba7d-3721b03003ac ==============================
[0m02:31:06.590666 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:31:06.591029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select debug_tables', 'send_anonymous_usage_stats': 'True'}
[0m02:31:06.732584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0deca028-fca8-4a59-ba7d-3721b03003ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a0eb7d1e0>]}
[0m02:31:06.770857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0deca028-fca8-4a59-ba7d-3721b03003ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a0932a440>]}
[0m02:31:06.772875 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:31:06.780112 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:31:06.868214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m02:31:06.868685 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:31:06.868933 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://macros/debug_tables.sql
[0m02:31:06.869210 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:31:06.978381 [info ] [MainThread]: === Available Tables ===
[0m02:31:06.984787 [error] [MainThread]: Encountered an error:
Compilation Error in model debug_tables (models/staging/debug_tables.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:31:06.985581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4310864, "process_user_time": 1.137526, "process_kernel_time": 0.099783, "process_mem_max_rss": "127872", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m02:31:06.986032 [debug] [MainThread]: Command `dbt run` failed at 02:31:06.985951 after 0.43 seconds
[0m02:31:06.986313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a0ecb74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a01637c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a01637b20>]}
[0m02:31:06.986587 [debug] [MainThread]: Flushing usage events
[0m02:31:46.989451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8745adb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8744013e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8744013070>]}


============================== 02:31:46.991511 | 0e572d01-3486-4658-b80c-9c5ae6cc251f ==============================
[0m02:31:46.991511 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:31:46.991882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select debug_tables', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:31:47.130922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e572d01-3486-4658-b80c-9c5ae6cc251f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87401a06a0>]}
[0m02:31:47.168086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e572d01-3486-4658-b80c-9c5ae6cc251f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8744426320>]}
[0m02:31:47.170156 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:31:47.177579 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:31:47.271165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m02:31:47.271883 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:31:47.272152 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://macros/debug_tables.sql
[0m02:31:47.272458 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:31:47.386168 [info ] [MainThread]: === Available Tables ===
[0m02:31:47.391594 [error] [MainThread]: Encountered an error:
Compilation Error in model debug_tables (models/staging/debug_tables.sql)
  'None' has no attribute 'table'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:31:47.392257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.43874738, "process_user_time": 1.188448, "process_kernel_time": 0.059921, "process_mem_max_rss": "127212", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m02:31:47.392743 [debug] [MainThread]: Command `dbt run` failed at 02:31:47.392605 after 0.44 seconds
[0m02:31:47.393137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8745adb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8738437c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8738437a90>]}
[0m02:31:47.393441 [debug] [MainThread]: Flushing usage events
[0m02:33:30.245382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f6e727520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f6e9f20e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f6e9f3b50>]}


============================== 02:33:30.247411 | 0d20a368-fdfe-4267-97fc-e26118bbb47a ==============================
[0m02:33:30.247411 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:33:30.247777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select debug_tables', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:33:30.385894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d20a368-fdfe-4267-97fc-e26118bbb47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f6cbe86d0>]}
[0m02:33:30.422378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d20a368-fdfe-4267-97fc-e26118bbb47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f6d2b92a0>]}
[0m02:33:30.424298 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:33:30.431121 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:33:30.521096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m02:33:30.521551 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:33:30.521771 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://macros/debug_tables.sql
[0m02:33:30.522038 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:33:30.631646 [info ] [MainThread]: === Debug Information ===
[0m02:33:30.632087 [info ] [MainThread]: Current Database: crypto_trading
[0m02:33:30.632387 [info ] [MainThread]: Current Schema: main
[0m02:33:30.632689 [info ] [MainThread]: Relations found: 
[0m02:33:30.633017 [info ] [MainThread]: =====================
[0m02:33:30.646479 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_trades (models/staging/stg_trades.sql)
  unexpected '%'
    line 2
      {{% SELECT * FROM system.information_schema.tables %}}
[0m02:33:30.647223 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.43718988, "process_user_time": 1.16335, "process_kernel_time": 0.049715, "process_mem_max_rss": "129664", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m02:33:30.647681 [debug] [MainThread]: Command `dbt run` failed at 02:33:30.647564 after 0.44 seconds
[0m02:33:30.647972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f6e727520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f610452d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f61045360>]}
[0m02:33:30.648230 [debug] [MainThread]: Flushing usage events
[0m02:33:56.959370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e5a5f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e5d2e0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e5d2fb50>]}


============================== 02:33:56.961184 | a4f654ec-801b-4988-9cb1-6dc83aa0707e ==============================
[0m02:33:56.961184 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:33:56.961567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select debug_tables', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:33:57.093315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4f654ec-801b-4988-9cb1-6dc83aa0707e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e3f286d0>]}
[0m02:33:57.128514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4f654ec-801b-4988-9cb1-6dc83aa0707e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e45ed2a0>]}
[0m02:33:57.130366 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:33:57.137429 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:33:57.225286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m02:33:57.225762 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://macros/debug_tables.sql
[0m02:33:57.226017 [debug] [MainThread]: Partial parsing: added file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:33:57.226307 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/stg_trades.sql
[0m02:33:57.336282 [info ] [MainThread]: === Debug Information ===
[0m02:33:57.336725 [info ] [MainThread]: Current Database: crypto_trading
[0m02:33:57.337030 [info ] [MainThread]: Current Schema: main
[0m02:33:57.337321 [info ] [MainThread]: Relations found: 
[0m02:33:57.337588 [info ] [MainThread]: =====================
[0m02:33:57.389503 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:33:57.390012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a4f654ec-801b-4988-9cb1-6dc83aa0707e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d83fd540>]}
[0m02:33:57.521029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:33:57.532679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4f654ec-801b-4988-9cb1-6dc83aa0707e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d53428f0>]}
[0m02:33:57.665491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4f654ec-801b-4988-9cb1-6dc83aa0707e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d866a9e0>]}
[0m02:33:57.665911 [info ] [MainThread]: Found 4 models, 32 data tests, 1 source, 418 macros
[0m02:33:57.666205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f654ec-801b-4988-9cb1-6dc83aa0707e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e654c4c0>]}
[0m02:33:57.667347 [info ] [MainThread]: 
[0m02:33:57.667849 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:33:57.668884 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:33:57.696760 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:33:57.697198 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:33:57.697462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:33:57.751601 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m02:33:57.752807 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:33:57.755243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:33:57.755660 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:33:57.760782 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:33:57.761036 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:33:57.761246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:57.797695 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m02:33:57.799016 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:33:57.799299 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:33:57.799812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:33:57.800125 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:33:57.800405 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:33:57.801147 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:33:57.801740 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:33:57.801955 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:33:57.802157 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:33:57.802648 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:33:57.802965 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:33:57.809453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:33:57.814527 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:33:57.814879 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:33:57.815142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:33:57.848884 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:33:57.849325 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:33:57.849599 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:33:57.867878 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:33:57.869088 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:33:57.870369 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:33:57.870706 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:33:57.873599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4f654ec-801b-4988-9cb1-6dc83aa0707e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d849f160>]}
[0m02:33:57.874045 [debug] [MainThread]: Using duckdb connection "master"
[0m02:33:57.874392 [debug] [MainThread]: On master: BEGIN
[0m02:33:57.874601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:33:57.909491 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m02:33:57.910058 [debug] [MainThread]: On master: COMMIT
[0m02:33:57.910356 [debug] [MainThread]: Using duckdb connection "master"
[0m02:33:57.910622 [debug] [MainThread]: On master: COMMIT
[0m02:33:57.911239 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:33:57.911477 [debug] [MainThread]: On master: Close
[0m02:33:57.913967 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:33:57.914320 [info ] [MainThread]: 
[0m02:33:57.917029 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.debug_tables
[0m02:33:57.917472 [info ] [Thread-1 (]: 1 of 1 START sql view model main.debug_tables .................................. [RUN]
[0m02:33:57.917963 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.debug_tables'
[0m02:33:57.918222 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.debug_tables
[0m02:33:57.925382 [info ] [Thread-1 (]: === Debug Information ===
[0m02:33:57.925731 [info ] [Thread-1 (]: Current Database: crypto_trading
[0m02:33:57.926025 [info ] [Thread-1 (]: Current Schema: main
[0m02:33:57.930541 [debug] [Thread-1 (]: Compilation Error in model debug_tables (models/staging/debug_tables.sql)
  'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'list_relations'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:33:57.931790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4f654ec-801b-4988-9cb1-6dc83aa0707e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60d8645270>]}
[0m02:33:57.932262 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.debug_tables ......................... [[31mERROR[0m in 0.01s]
[0m02:33:57.932703 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.debug_tables
[0m02:33:57.934567 [debug] [MainThread]: Using duckdb connection "master"
[0m02:33:57.934836 [debug] [MainThread]: On master: BEGIN
[0m02:33:57.935035 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:33:57.970689 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m02:33:57.971199 [debug] [MainThread]: On master: COMMIT
[0m02:33:57.971452 [debug] [MainThread]: Using duckdb connection "master"
[0m02:33:57.971664 [debug] [MainThread]: On master: COMMIT
[0m02:33:57.972203 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:33:57.972548 [debug] [MainThread]: On master: Close
[0m02:33:57.974822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:33:57.975079 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:33:57.975262 [debug] [MainThread]: Connection 'model.crypto_pipeline.debug_tables' was properly closed.
[0m02:33:57.975501 [info ] [MainThread]: 
[0m02:33:57.975836 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m02:33:57.976331 [debug] [MainThread]: Command end result
[0m02:33:58.000369 [info ] [MainThread]: 
[0m02:33:58.000812 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:33:58.001179 [info ] [MainThread]: 
[0m02:33:58.001647 [error] [MainThread]:   Compilation Error in model debug_tables (models/staging/debug_tables.sql)
  'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'list_relations'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m02:33:58.001929 [info ] [MainThread]: 
[0m02:33:58.002230 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:33:58.002920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0768278, "process_user_time": 2.664788, "process_kernel_time": 0.081198, "process_mem_max_rss": "204052", "process_in_blocks": "98432", "process_out_blocks": "2944", "command_success": false}
[0m02:33:58.003316 [debug] [MainThread]: Command `dbt run` failed at 02:33:58.003241 after 1.08 seconds
[0m02:33:58.003604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e5a5f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e5964550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60e546ece0>]}
[0m02:33:58.003861 [debug] [MainThread]: Flushing usage events
[0m02:35:50.734828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc73507f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7353fbd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7353fbbb0>]}


============================== 02:35:50.737329 | 751bb13c-3086-48d6-bc77-cb3f2e65a423 ==============================
[0m02:35:50.737329 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:35:50.737670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select debug_tables', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:35:50.905356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '751bb13c-3086-48d6-bc77-cb3f2e65a423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc727f4f670>]}
[0m02:35:50.943052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '751bb13c-3086-48d6-bc77-cb3f2e65a423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc733672380>]}
[0m02:35:50.945659 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:35:50.954217 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:35:51.076788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:35:51.077414 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:35:51.258905 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:35:51.276369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '751bb13c-3086-48d6-bc77-cb3f2e65a423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc725a30130>]}
[0m02:35:51.371879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '751bb13c-3086-48d6-bc77-cb3f2e65a423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc725a32260>]}
[0m02:35:51.372425 [info ] [MainThread]: Found 4 models, 32 data tests, 1 source, 418 macros
[0m02:35:51.372763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '751bb13c-3086-48d6-bc77-cb3f2e65a423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc725a321d0>]}
[0m02:35:51.373980 [info ] [MainThread]: 
[0m02:35:51.374538 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:35:51.375828 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:35:51.405831 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:35:51.406212 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:35:51.406462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:35:51.459936 [debug] [ThreadPool]: SQL status: OK in 0.053 seconds
[0m02:35:51.461214 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:35:51.464022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:35:51.464619 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:35:51.470704 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:35:51.471068 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:35:51.471352 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:51.509515 [debug] [ThreadPool]: SQL status: OK in 0.038 seconds
[0m02:35:51.510828 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:35:51.511071 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:35:51.511567 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:51.511776 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:35:51.511969 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:35:51.512480 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:51.513086 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:35:51.513301 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:35:51.513492 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:35:51.513976 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:35:51.514404 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:35:51.520924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:35:51.526312 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:35:51.526603 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:35:51.526817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:35:51.566264 [debug] [ThreadPool]: SQL status: OK in 0.039 seconds
[0m02:35:51.566781 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:35:51.567192 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:35:51.586369 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m02:35:51.588045 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:35:51.589135 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:35:51.589501 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:35:51.592883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '751bb13c-3086-48d6-bc77-cb3f2e65a423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc73368ccd0>]}
[0m02:35:51.593394 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:51.593794 [debug] [MainThread]: On master: BEGIN
[0m02:35:51.594129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:35:51.630194 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m02:35:51.630711 [debug] [MainThread]: On master: COMMIT
[0m02:35:51.631068 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:51.631336 [debug] [MainThread]: On master: COMMIT
[0m02:35:51.631862 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:51.632129 [debug] [MainThread]: On master: Close
[0m02:35:51.634730 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:35:51.635075 [info ] [MainThread]: 
[0m02:35:51.637582 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.debug_tables
[0m02:35:51.638070 [info ] [Thread-1 (]: 1 of 1 START sql view model main.debug_tables .................................. [RUN]
[0m02:35:51.638629 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.debug_tables'
[0m02:35:51.638918 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.debug_tables
[0m02:35:51.701398 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.debug_tables"
[0m02:35:51.702806 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.debug_tables
[0m02:35:51.724560 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.debug_tables"
[0m02:35:51.725614 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:35:51.725929 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: BEGIN
[0m02:35:51.726184 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:35:51.767424 [debug] [Thread-1 (]: SQL status: OK in 0.041 seconds
[0m02:35:51.767968 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:35:51.768242 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 
    'Checking tables' as message,
    current_database() as current_db,
    current_schema() as current_schema;
  );

[0m02:35:51.771508 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 
    'Checking tables' as message,
    current_database() as current_db,
    current_schema() as current_schema;
  );

[0m02:35:51.771851 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:35:51.772372 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: ROLLBACK
[0m02:35:51.777831 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.debug_tables'
[0m02:35:51.778204 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: Close
[0m02:35:51.781068 [debug] [Thread-1 (]: Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:35:51.782365 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '751bb13c-3086-48d6-bc77-cb3f2e65a423', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b3ea3280>]}
[0m02:35:51.782903 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.debug_tables ......................... [[31mERROR[0m in 0.14s]
[0m02:35:51.783477 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.debug_tables
[0m02:35:51.785515 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:51.785820 [debug] [MainThread]: On master: BEGIN
[0m02:35:51.786031 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:35:51.823577 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m02:35:51.824002 [debug] [MainThread]: On master: COMMIT
[0m02:35:51.824327 [debug] [MainThread]: Using duckdb connection "master"
[0m02:35:51.824798 [debug] [MainThread]: On master: COMMIT
[0m02:35:51.825507 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:35:51.825867 [debug] [MainThread]: On master: Close
[0m02:35:51.828152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:35:51.828405 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:35:51.828593 [debug] [MainThread]: Connection 'model.crypto_pipeline.debug_tables' was properly closed.
[0m02:35:51.828840 [info ] [MainThread]: 
[0m02:35:51.829149 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m02:35:51.829700 [debug] [MainThread]: Command end result
[0m02:35:51.858193 [info ] [MainThread]: 
[0m02:35:51.858747 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:35:51.859089 [info ] [MainThread]: 
[0m02:35:51.859504 [error] [MainThread]:   Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:35:51.859803 [info ] [MainThread]: 
[0m02:35:51.860133 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:35:51.861064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1622539, "process_user_time": 2.819376, "process_kernel_time": 0.25078, "process_mem_max_rss": "209568", "process_in_blocks": "148624", "process_out_blocks": "2976", "command_success": false}
[0m02:35:51.861508 [debug] [MainThread]: Command `dbt run` failed at 02:35:51.861395 after 1.16 seconds
[0m02:35:51.861821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc73507f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc727c76770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc727eabaf0>]}
[0m02:35:51.862092 [debug] [MainThread]: Flushing usage events
[0m02:36:04.240551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350ef074f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350d43be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350d43b070>]}


============================== 02:36:04.242579 | dbe5957e-a49c-4523-a515-a8c26652ff55 ==============================
[0m02:36:04.242579 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:36:04.242982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select debug_tables', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:36:04.376055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbe5957e-a49c-4523-a515-a8c26652ff55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3509599600>]}
[0m02:36:04.411747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbe5957e-a49c-4523-a515-a8c26652ff55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350d84a320>]}
[0m02:36:04.413517 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:36:04.420926 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:36:04.508366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:36:04.508879 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:36:04.670807 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:36:04.682357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbe5957e-a49c-4523-a515-a8c26652ff55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350188c130>]}
[0m02:36:04.756399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbe5957e-a49c-4523-a515-a8c26652ff55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350188d0f0>]}
[0m02:36:04.756831 [info ] [MainThread]: Found 4 models, 32 data tests, 1 source, 418 macros
[0m02:36:04.757139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbe5957e-a49c-4523-a515-a8c26652ff55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350188d180>]}
[0m02:36:04.758293 [info ] [MainThread]: 
[0m02:36:04.758742 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:36:04.759597 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:36:04.786495 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:36:04.786850 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:36:04.787076 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:04.828404 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m02:36:04.829541 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:36:04.831780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:36:04.832170 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:36:04.837115 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:36:04.837357 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:36:04.837559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:04.871609 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:36:04.873013 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:36:04.873236 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:36:04.873767 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:36:04.874072 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:36:04.874471 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:36:04.875131 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:36:04.875780 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:36:04.875987 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:36:04.876171 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:36:04.876651 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:36:04.876967 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:36:04.883148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:36:04.888173 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:36:04.888407 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:36:04.888689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:04.923506 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m02:36:04.923919 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:36:04.924173 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:36:04.941538 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:36:04.942833 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:36:04.943249 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:36:04.943476 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:36:04.946231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbe5957e-a49c-4523-a515-a8c26652ff55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350188cc10>]}
[0m02:36:04.946708 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:04.946998 [debug] [MainThread]: On master: BEGIN
[0m02:36:04.947234 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:36:04.981149 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m02:36:04.981652 [debug] [MainThread]: On master: COMMIT
[0m02:36:04.982031 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:04.982274 [debug] [MainThread]: On master: COMMIT
[0m02:36:04.982732 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:36:04.982968 [debug] [MainThread]: On master: Close
[0m02:36:04.985210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:36:04.985540 [info ] [MainThread]: 
[0m02:36:04.987589 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.debug_tables
[0m02:36:04.988098 [info ] [Thread-1 (]: 1 of 1 START sql view model main.debug_tables .................................. [RUN]
[0m02:36:04.988614 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.debug_tables'
[0m02:36:04.988871 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.debug_tables
[0m02:36:05.042578 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.debug_tables"
[0m02:36:05.043156 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.debug_tables
[0m02:36:05.063682 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.debug_tables"
[0m02:36:05.064210 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:36:05.064596 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: BEGIN
[0m02:36:05.064842 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:36:05.101633 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m02:36:05.102205 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:36:05.102600 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT SHOW ALL TABLES;
  );

[0m02:36:05.103221 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT SHOW ALL TABLES;
  );

[0m02:36:05.103479 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:36:05.103809 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: ROLLBACK
[0m02:36:05.105190 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.debug_tables'
[0m02:36:05.105443 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: Close
[0m02:36:05.108107 [debug] [Thread-1 (]: Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near "SHOW"
[0m02:36:05.109271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbe5957e-a49c-4523-a515-a8c26652ff55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350195f9d0>]}
[0m02:36:05.109749 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.debug_tables ......................... [[31mERROR[0m in 0.12s]
[0m02:36:05.110215 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.debug_tables
[0m02:36:05.112096 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:05.112333 [debug] [MainThread]: On master: BEGIN
[0m02:36:05.112562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:36:05.147239 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m02:36:05.147744 [debug] [MainThread]: On master: COMMIT
[0m02:36:05.148002 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:05.148218 [debug] [MainThread]: On master: COMMIT
[0m02:36:05.148694 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:36:05.148976 [debug] [MainThread]: On master: Close
[0m02:36:05.151262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:05.151482 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:36:05.151662 [debug] [MainThread]: Connection 'model.crypto_pipeline.debug_tables' was properly closed.
[0m02:36:05.151899 [info ] [MainThread]: 
[0m02:36:05.152177 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m02:36:05.152710 [debug] [MainThread]: Command end result
[0m02:36:05.178230 [info ] [MainThread]: 
[0m02:36:05.178692 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:36:05.179013 [info ] [MainThread]: 
[0m02:36:05.179353 [error] [MainThread]:   Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near "SHOW"
[0m02:36:05.179606 [info ] [MainThread]: 
[0m02:36:05.179872 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:36:05.180518 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.97363997, "process_user_time": 2.366176, "process_kernel_time": 0.175532, "process_mem_max_rss": "210528", "process_out_blocks": "2968", "command_success": false, "process_in_blocks": "0"}
[0m02:36:05.180946 [debug] [MainThread]: Command `dbt run` failed at 02:36:05.180866 after 0.97 seconds
[0m02:36:05.181247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350ef074f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3501a34310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3501a36e60>]}
[0m02:36:05.181508 [debug] [MainThread]: Flushing usage events
[0m02:36:29.796528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fcf6b74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fcdbebc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fcdbe9f60>]}


============================== 02:36:29.798507 | f1344e7f-25a9-4195-969a-2ea2c39eb6f0 ==============================
[0m02:36:29.798507 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:36:29.798856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select debug_tables', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:36:29.930214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1344e7f-25a9-4195-969a-2ea2c39eb6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fcf57d1e0>]}
[0m02:36:29.965904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1344e7f-25a9-4195-969a-2ea2c39eb6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fc9d26440>]}
[0m02:36:29.967782 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:36:29.974862 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:36:30.063011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:36:30.063573 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:36:30.225862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:36:30.237537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1344e7f-25a9-4195-969a-2ea2c39eb6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fc2088130>]}
[0m02:36:30.311630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1344e7f-25a9-4195-969a-2ea2c39eb6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fc2089f60>]}
[0m02:36:30.312070 [info ] [MainThread]: Found 4 models, 32 data tests, 1 source, 418 macros
[0m02:36:30.312384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1344e7f-25a9-4195-969a-2ea2c39eb6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fc2089ff0>]}
[0m02:36:30.313556 [info ] [MainThread]: 
[0m02:36:30.314007 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:36:30.314866 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:36:30.339614 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:36:30.340041 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:36:30.340395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:36:30.382208 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m02:36:30.383483 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:36:30.385774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:36:30.386167 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:36:30.391010 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:36:30.391260 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:36:30.391457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:30.426137 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m02:36:30.427490 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:36:30.427844 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:36:30.428438 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:36:30.428752 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:36:30.429051 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:36:30.429679 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:36:30.430561 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:36:30.430873 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:36:30.431090 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:36:30.431516 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:36:30.431752 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:36:30.437759 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:36:30.442681 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:36:30.442952 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:36:30.443173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:36:30.477520 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:36:30.477988 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:36:30.478253 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:36:30.495655 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:36:30.496994 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:36:30.497392 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:36:30.497591 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:36:30.499939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1344e7f-25a9-4195-969a-2ea2c39eb6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fc20889a0>]}
[0m02:36:30.500296 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:30.500503 [debug] [MainThread]: On master: BEGIN
[0m02:36:30.500743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:36:30.534095 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m02:36:30.534565 [debug] [MainThread]: On master: COMMIT
[0m02:36:30.534817 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:30.535030 [debug] [MainThread]: On master: COMMIT
[0m02:36:30.535497 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:36:30.535785 [debug] [MainThread]: On master: Close
[0m02:36:30.538163 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:36:30.538479 [info ] [MainThread]: 
[0m02:36:30.540555 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.debug_tables
[0m02:36:30.541041 [info ] [Thread-1 (]: 1 of 1 START sql view model main.debug_tables .................................. [RUN]
[0m02:36:30.541527 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.debug_tables'
[0m02:36:30.541783 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.debug_tables
[0m02:36:30.598827 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.debug_tables"
[0m02:36:30.599340 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.debug_tables
[0m02:36:30.620179 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.debug_tables"
[0m02:36:30.620681 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:36:30.620939 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: BEGIN
[0m02:36:30.621158 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:36:30.655594 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m02:36:30.656107 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:36:30.656378 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 
    'Checking tables' as message,
    current_database() as current_db,
    current_schema() as current_schema;
  );

[0m02:36:30.656866 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 
    'Checking tables' as message,
    current_database() as current_db,
    current_schema() as current_schema;
  );

[0m02:36:30.657118 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:36:30.657456 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: ROLLBACK
[0m02:36:30.658743 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.debug_tables'
[0m02:36:30.658986 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: Close
[0m02:36:30.661568 [debug] [Thread-1 (]: Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:36:30.662716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1344e7f-25a9-4195-969a-2ea2c39eb6f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fc22b3340>]}
[0m02:36:30.663184 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.debug_tables ......................... [[31mERROR[0m in 0.12s]
[0m02:36:30.663637 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.debug_tables
[0m02:36:30.665696 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:30.666082 [debug] [MainThread]: On master: BEGIN
[0m02:36:30.666724 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:36:30.702487 [debug] [MainThread]: SQL status: OK in 0.036 seconds
[0m02:36:30.703005 [debug] [MainThread]: On master: COMMIT
[0m02:36:30.703415 [debug] [MainThread]: Using duckdb connection "master"
[0m02:36:30.703656 [debug] [MainThread]: On master: COMMIT
[0m02:36:30.704274 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:36:30.704542 [debug] [MainThread]: On master: Close
[0m02:36:30.706668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:36:30.706931 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:36:30.707117 [debug] [MainThread]: Connection 'model.crypto_pipeline.debug_tables' was properly closed.
[0m02:36:30.707350 [info ] [MainThread]: 
[0m02:36:30.707640 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m02:36:30.708182 [debug] [MainThread]: Command end result
[0m02:36:30.732905 [info ] [MainThread]: 
[0m02:36:30.733365 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:36:30.733731 [info ] [MainThread]: 
[0m02:36:30.734153 [error] [MainThread]:   Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:36:30.734505 [info ] [MainThread]: 
[0m02:36:30.734824 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:36:30.735496 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.97245604, "process_user_time": 2.236054, "process_kernel_time": 0.141146, "process_mem_max_rss": "210036", "process_out_blocks": "2976", "command_success": false, "process_in_blocks": "0"}
[0m02:36:30.735900 [debug] [MainThread]: Command `dbt run` failed at 02:36:30.735823 after 0.97 seconds
[0m02:36:30.736191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fcf6b74c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fcef47e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2fc2235000>]}
[0m02:36:30.736478 [debug] [MainThread]: Flushing usage events
[0m02:37:17.564869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19dc8eb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19dae23e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19dae23070>]}


============================== 02:37:17.567536 | c7cbbda2-2e74-4334-8593-0c9c55401076 ==============================
[0m02:37:17.567536 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:37:17.568119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select debug_tables', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:37:17.716285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7cbbda2-2e74-4334-8593-0c9c55401076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19d6fa46a0>]}
[0m02:37:17.752042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7cbbda2-2e74-4334-8593-0c9c55401076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19db236320>]}
[0m02:37:17.753936 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:37:17.760647 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:37:17.882697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m02:37:17.883321 [debug] [MainThread]: Partial parsing: updated file: crypto_pipeline://models/staging/debug_tables.sql
[0m02:37:18.052605 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:37:18.064619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7cbbda2-2e74-4334-8593-0c9c55401076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19cf28c130>]}
[0m02:37:18.153381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7cbbda2-2e74-4334-8593-0c9c55401076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19cf28d0f0>]}
[0m02:37:18.153858 [info ] [MainThread]: Found 4 models, 32 data tests, 1 source, 418 macros
[0m02:37:18.154156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7cbbda2-2e74-4334-8593-0c9c55401076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19cf28d180>]}
[0m02:37:18.155355 [info ] [MainThread]: 
[0m02:37:18.155823 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:37:18.157057 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:37:18.186644 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:37:18.187025 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:37:18.187223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:37:18.238654 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m02:37:18.239855 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:37:18.242927 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:37:18.246631 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:37:18.254554 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:37:18.255046 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:37:18.255381 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:37:18.295765 [debug] [ThreadPool]: SQL status: OK in 0.040 seconds
[0m02:37:18.297557 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:37:18.297936 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:37:18.298647 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:37:18.298961 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:37:18.299213 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:37:18.299862 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:37:18.300589 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:37:18.300868 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:37:18.301087 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:37:18.301566 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:37:18.301827 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:37:18.308299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:37:18.313675 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:37:18.313942 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:37:18.314296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:37:18.348715 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:37:18.349236 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:37:18.349511 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:37:18.366841 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:37:18.368154 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:37:18.369490 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:37:18.369811 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:37:18.372782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7cbbda2-2e74-4334-8593-0c9c55401076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19cf28cc10>]}
[0m02:37:18.373254 [debug] [MainThread]: Using duckdb connection "master"
[0m02:37:18.373540 [debug] [MainThread]: On master: BEGIN
[0m02:37:18.373735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:37:18.408677 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m02:37:18.409189 [debug] [MainThread]: On master: COMMIT
[0m02:37:18.409614 [debug] [MainThread]: Using duckdb connection "master"
[0m02:37:18.409846 [debug] [MainThread]: On master: COMMIT
[0m02:37:18.410356 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:37:18.410692 [debug] [MainThread]: On master: Close
[0m02:37:18.413046 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:37:18.413349 [info ] [MainThread]: 
[0m02:37:18.415873 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.debug_tables
[0m02:37:18.416334 [info ] [Thread-1 (]: 1 of 1 START sql view model main.debug_tables .................................. [RUN]
[0m02:37:18.416864 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.debug_tables'
[0m02:37:18.417122 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.debug_tables
[0m02:37:18.470425 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.debug_tables"
[0m02:37:18.470943 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.debug_tables
[0m02:37:18.491613 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.debug_tables"
[0m02:37:18.492102 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:37:18.492413 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: BEGIN
[0m02:37:18.492652 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:37:18.527665 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m02:37:18.528160 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:37:18.528453 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:37:18.531390 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:37:18.531715 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:37:18.532095 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: ROLLBACK
[0m02:37:18.537243 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.debug_tables'
[0m02:37:18.537499 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: Close
[0m02:37:18.539613 [debug] [Thread-1 (]: Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:37:18.540787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7cbbda2-2e74-4334-8593-0c9c55401076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19cf35b9d0>]}
[0m02:37:18.541264 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.debug_tables ......................... [[31mERROR[0m in 0.12s]
[0m02:37:18.541735 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.debug_tables
[0m02:37:18.543603 [debug] [MainThread]: Using duckdb connection "master"
[0m02:37:18.543837 [debug] [MainThread]: On master: BEGIN
[0m02:37:18.544061 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:37:18.579178 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m02:37:18.579627 [debug] [MainThread]: On master: COMMIT
[0m02:37:18.579878 [debug] [MainThread]: Using duckdb connection "master"
[0m02:37:18.580144 [debug] [MainThread]: On master: COMMIT
[0m02:37:18.580645 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:37:18.581002 [debug] [MainThread]: On master: Close
[0m02:37:18.583049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:37:18.583290 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:37:18.583467 [debug] [MainThread]: Connection 'model.crypto_pipeline.debug_tables' was properly closed.
[0m02:37:18.583699 [info ] [MainThread]: 
[0m02:37:18.583979 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m02:37:18.584567 [debug] [MainThread]: Command end result
[0m02:37:18.609489 [info ] [MainThread]: 
[0m02:37:18.609953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m02:37:18.610285 [info ] [MainThread]: 
[0m02:37:18.610627 [error] [MainThread]:   Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:37:18.610888 [info ] [MainThread]: 
[0m02:37:18.611155 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m02:37:18.612076 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0854807, "process_user_time": 2.598205, "process_kernel_time": 0.186611, "process_mem_max_rss": "210312", "process_in_blocks": "102176", "process_out_blocks": "2968", "command_success": false}
[0m02:37:18.612481 [debug] [MainThread]: Command `dbt run` failed at 02:37:18.612407 after 1.09 seconds
[0m02:37:18.612780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19dc8eb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19cf30e980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19cf30eb90>]}
[0m02:37:18.613048 [debug] [MainThread]: Flushing usage events
[0m02:37:33.581033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f51534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f5423850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f5423d90>]}


============================== 02:37:33.583741 | d4345d3b-2b9b-4747-b404-885235c48316 ==============================
[0m02:37:33.583741 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:37:33.584102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:37:33.746674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4345d3b-2b9b-4747-b404-885235c48316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f360ef50>]}
[0m02:37:33.784693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4345d3b-2b9b-4747-b404-885235c48316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f35a6770>]}
[0m02:37:33.787294 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:37:33.795670 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:37:33.884866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:37:33.885207 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:37:33.890079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:37:33.923125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4345d3b-2b9b-4747-b404-885235c48316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e7b50130>]}
[0m02:37:34.000695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4345d3b-2b9b-4747-b404-885235c48316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e7b34040>]}
[0m02:37:34.001153 [info ] [MainThread]: Found 4 models, 32 data tests, 1 source, 418 macros
[0m02:37:34.001466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4345d3b-2b9b-4747-b404-885235c48316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e7b35390>]}
[0m02:37:34.002940 [info ] [MainThread]: 
[0m02:37:34.003428 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:37:34.007827 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:37:34.032037 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:37:34.032388 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:37:34.032585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:37:34.073538 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m02:37:34.074796 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:37:34.077448 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:37:34.077887 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:37:34.083158 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:37:34.083444 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:37:34.083649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:37:34.117762 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:37:34.119317 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:37:34.119708 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:37:34.120421 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:37:34.120753 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:37:34.121037 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:37:34.121507 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:37:34.122095 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:37:34.122307 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:37:34.122578 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:37:34.123033 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:37:34.123260 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:37:34.127403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:37:34.131670 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:37:34.131919 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:37:34.132154 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:37:34.167770 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m02:37:34.168156 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:37:34.168430 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:37:34.186676 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:37:34.188146 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:37:34.188652 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:37:34.188847 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:37:34.191627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4345d3b-2b9b-4747-b404-885235c48316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e7b9b010>]}
[0m02:37:34.191992 [debug] [MainThread]: Using duckdb connection "master"
[0m02:37:34.192210 [debug] [MainThread]: On master: BEGIN
[0m02:37:34.192468 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:37:34.225758 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m02:37:34.226222 [debug] [MainThread]: On master: COMMIT
[0m02:37:34.226513 [debug] [MainThread]: Using duckdb connection "master"
[0m02:37:34.226783 [debug] [MainThread]: On master: COMMIT
[0m02:37:34.227238 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:37:34.227485 [debug] [MainThread]: On master: Close
[0m02:37:34.229383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:37:34.229696 [info ] [MainThread]: 
[0m02:37:34.231585 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.debug_tables
[0m02:37:34.232016 [info ] [Thread-1 (]: 1 of 4 START sql view model main.debug_tables .................................. [RUN]
[0m02:37:34.232509 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.debug_tables'
[0m02:37:34.232805 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.debug_tables
[0m02:37:34.238261 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.debug_tables"
[0m02:37:34.238674 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.debug_tables
[0m02:37:34.259882 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.debug_tables"
[0m02:37:34.260443 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:37:34.260739 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: BEGIN
[0m02:37:34.260973 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:37:34.298474 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m02:37:34.298951 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:37:34.299295 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:37:34.299783 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:37:34.300041 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:37:34.300376 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: ROLLBACK
[0m02:37:34.301603 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.debug_tables'
[0m02:37:34.301854 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: Close
[0m02:37:34.304126 [debug] [Thread-1 (]: Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:37:34.305390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4345d3b-2b9b-4747-b404-885235c48316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e6f79780>]}
[0m02:37:34.305882 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.debug_tables ......................... [[31mERROR[0m in 0.07s]
[0m02:37:34.306349 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.debug_tables
[0m02:37:34.306681 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:37:34.307097 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_trades .................................... [RUN]
[0m02:37:34.308376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_pipeline.debug_tables, now model.crypto_pipeline.stg_trades)
[0m02:37:34.308715 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:37:34.311130 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:37:34.311869 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:37:34.315758 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:37:34.316248 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:37:34.316553 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:37:34.316796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:37:34.352867 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m02:37:34.353539 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:37:34.353974 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:37:34.370934 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:37:34.371319 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:37:34.371694 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:37:34.372266 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:37:34.372517 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:37:34.375506 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "crypto_trading.stg_trades"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:37:34.375888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4345d3b-2b9b-4747-b404-885235c48316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e6e9efb0>]}
[0m02:37:34.376381 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.07s]
[0m02:37:34.376857 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:37:34.377881 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:37:34.378160 [info ] [Thread-1 (]: 3 of 4 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:37:34.378503 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:37:34.378799 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:37:34.379163 [info ] [Thread-1 (]: 4 of 4 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:37:34.379498 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:37:34.380562 [debug] [MainThread]: Using duckdb connection "master"
[0m02:37:34.380868 [debug] [MainThread]: On master: BEGIN
[0m02:37:34.381128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:37:34.416680 [debug] [MainThread]: SQL status: OK in 0.035 seconds
[0m02:37:34.417235 [debug] [MainThread]: On master: COMMIT
[0m02:37:34.417656 [debug] [MainThread]: Using duckdb connection "master"
[0m02:37:34.417877 [debug] [MainThread]: On master: COMMIT
[0m02:37:34.418378 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:37:34.418726 [debug] [MainThread]: On master: Close
[0m02:37:34.420775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:37:34.421023 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:37:34.421265 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:37:34.421608 [info ] [MainThread]: 
[0m02:37:34.421894 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m02:37:34.422595 [debug] [MainThread]: Command end result
[0m02:37:34.494207 [info ] [MainThread]: 
[0m02:37:34.494736 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:37:34.495017 [info ] [MainThread]: 
[0m02:37:34.495395 [error] [MainThread]:   Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:37:34.495648 [info ] [MainThread]: 
[0m02:37:34.495949 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "crypto_trading.stg_trades"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:37:34.496189 [info ] [MainThread]: 
[0m02:37:34.496463 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m02:37:34.497073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.952541, "process_user_time": 2.594887, "process_kernel_time": 0.2448, "process_mem_max_rss": "207300", "process_in_blocks": "40968", "process_out_blocks": "2080", "command_success": false}
[0m02:37:34.497493 [debug] [MainThread]: Command `dbt run` failed at 02:37:34.497419 after 0.95 seconds
[0m02:37:34.497766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97f51534f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e6f99b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e6f9a1d0>]}
[0m02:37:34.498009 [debug] [MainThread]: Flushing usage events
[0m02:42:47.953462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb31b07520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb31501690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3003f850>]}


============================== 02:42:47.956013 | 8732356f-bd17-4d8b-b391-388edd21208e ==============================
[0m02:42:47.956013 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:42:47.956369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:42:48.114164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb319cd1e0>]}
[0m02:42:48.149721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c1263b0>]}
[0m02:42:48.153067 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:42:48.161240 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:42:48.239980 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:42:48.240391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb30c84eb0>]}
[0m02:42:48.981899 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:42:48.982352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb2c16c940>]}
[0m02:42:49.161462 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:42:49.172359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0d4e2830>]}
[0m02:42:49.248131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0d4e4c70>]}
[0m02:42:49.248533 [info ] [MainThread]: Found 4 models, 32 data tests, 1 source, 418 macros
[0m02:42:49.248814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0d4e4c40>]}
[0m02:42:49.250358 [info ] [MainThread]: 
[0m02:42:49.250837 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:42:49.254753 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:42:49.282876 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:42:49.283266 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:42:49.283492 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:42:49.337415 [debug] [ThreadPool]: SQL status: OK in 0.054 seconds
[0m02:42:49.338750 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:42:49.341224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:42:49.341620 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:42:49.346960 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:42:49.347214 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:42:49.347411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:49.382134 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m02:42:49.383356 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:42:49.383636 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:42:49.384152 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:49.384568 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:42:49.384864 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:42:49.385441 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:49.386027 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:42:49.386235 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:42:49.386422 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:42:49.386888 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:42:49.387201 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:42:49.390122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:42:49.394461 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:42:49.394700 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:42:49.394883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:42:49.428194 [debug] [ThreadPool]: SQL status: OK in 0.033 seconds
[0m02:42:49.428562 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:42:49.428809 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:42:49.445667 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m02:42:49.446596 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:42:49.447840 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:42:49.448144 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:42:49.450594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0d387940>]}
[0m02:42:49.450931 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:49.451129 [debug] [MainThread]: On master: BEGIN
[0m02:42:49.451307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:42:49.484265 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m02:42:49.484663 [debug] [MainThread]: On master: COMMIT
[0m02:42:49.484863 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:49.485095 [debug] [MainThread]: On master: COMMIT
[0m02:42:49.485568 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:49.485792 [debug] [MainThread]: On master: Close
[0m02:42:49.487714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:42:49.488005 [info ] [MainThread]: 
[0m02:42:49.490465 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.debug_tables
[0m02:42:49.490922 [info ] [Thread-1 (]: 1 of 4 START sql view model main.debug_tables .................................. [RUN]
[0m02:42:49.491418 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.debug_tables'
[0m02:42:49.491664 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.debug_tables
[0m02:42:49.496858 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.debug_tables"
[0m02:42:49.497253 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.debug_tables
[0m02:42:49.517878 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.debug_tables"
[0m02:42:49.518388 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:42:49.518657 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: BEGIN
[0m02:42:49.518882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:42:49.553362 [debug] [Thread-1 (]: SQL status: OK in 0.034 seconds
[0m02:42:49.553885 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:42:49.554269 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:42:49.556966 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:42:49.557220 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:42:49.557554 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: ROLLBACK
[0m02:42:49.562304 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.debug_tables'
[0m02:42:49.562639 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: Close
[0m02:42:49.564685 [debug] [Thread-1 (]: Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:42:49.565871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0c789750>]}
[0m02:42:49.566348 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.debug_tables ......................... [[31mERROR[0m in 0.07s]
[0m02:42:49.566937 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.debug_tables
[0m02:42:49.567307 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:42:49.568326 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_trades .................................... [RUN]
[0m02:42:49.568892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_pipeline.debug_tables, now model.crypto_pipeline.stg_trades)
[0m02:42:49.569150 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:42:49.571527 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:42:49.571929 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:42:49.574168 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:42:49.574622 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:42:49.574858 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:42:49.575074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:42:49.608460 [debug] [Thread-1 (]: SQL status: OK in 0.033 seconds
[0m02:42:49.608959 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:42:49.609329 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:42:49.624868 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:42:49.625186 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:42:49.625575 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:42:49.626166 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:42:49.626408 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:42:49.628929 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:42:49.629285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8732356f-bd17-4d8b-b391-388edd21208e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0c13f8e0>]}
[0m02:42:49.629762 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.06s]
[0m02:42:49.630206 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:42:49.631190 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:42:49.631477 [info ] [Thread-1 (]: 3 of 4 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:42:49.631850 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:42:49.632163 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:42:49.632516 [info ] [Thread-1 (]: 4 of 4 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:42:49.632843 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:42:49.633939 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:49.634162 [debug] [MainThread]: On master: BEGIN
[0m02:42:49.634499 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:42:49.667945 [debug] [MainThread]: SQL status: OK in 0.033 seconds
[0m02:42:49.668496 [debug] [MainThread]: On master: COMMIT
[0m02:42:49.668797 [debug] [MainThread]: Using duckdb connection "master"
[0m02:42:49.669081 [debug] [MainThread]: On master: COMMIT
[0m02:42:49.669624 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:42:49.669847 [debug] [MainThread]: On master: Close
[0m02:42:49.671762 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:42:49.671972 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:42:49.672150 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:42:49.672435 [info ] [MainThread]: 
[0m02:42:49.672717 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m02:42:49.673360 [debug] [MainThread]: Command end result
[0m02:42:49.748501 [info ] [MainThread]: 
[0m02:42:49.748986 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:42:49.749311 [info ] [MainThread]: 
[0m02:42:49.749680 [error] [MainThread]:   Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:42:49.749941 [info ] [MainThread]: 
[0m02:42:49.750232 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "temp.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:42:49.750493 [info ] [MainThread]: 
[0m02:42:49.750765 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m02:42:49.751673 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8342891, "process_user_time": 3.462199, "process_kernel_time": 0.222343, "process_mem_max_rss": "208628", "process_in_blocks": "148256", "process_out_blocks": "3000", "command_success": false}
[0m02:42:49.752068 [debug] [MainThread]: Command `dbt run` failed at 02:42:49.751995 after 1.83 seconds
[0m02:42:49.752420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb31b07520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb3151ace0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb0d4609d0>]}
[0m02:42:49.752675 [debug] [MainThread]: Flushing usage events
[0m02:46:07.792120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e120f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9df747130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9df746080>]}


============================== 02:46:07.795249 | 14fb1264-509a-464f-8676-3effd7f0020c ==============================
[0m02:46:07.795249 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:46:07.795745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:46:07.800455 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error
    Could not render {{ get_aws_credentials()['aws_region'] }}: 'get_aws_credentials' is undefined
[0m02:46:07.801511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.04476388, "process_user_time": 0.863505, "process_kernel_time": 0.094775, "process_mem_max_rss": "85256", "process_in_blocks": "42216", "process_out_blocks": "8", "command_success": false}
[0m02:46:07.802093 [debug] [MainThread]: Command `dbt run` failed at 02:46:07.801943 after 0.05 seconds
[0m02:46:07.802460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9e120f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9df7d7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9df7d5360>]}
[0m02:46:07.802796 [debug] [MainThread]: Flushing usage events
[0m02:48:45.928874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff782803520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff780d3a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff780d3bbe0>]}


============================== 02:48:45.931046 | 0f5d9d4a-5327-4eca-8535-73fd7aa17096 ==============================
[0m02:48:45.931046 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:48:45.931423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m02:48:46.095290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff780cc6da0>]}
[0m02:48:46.133558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff780c6b1f0>]}
[0m02:48:46.136759 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:48:46.146266 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:48:46.230911 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m02:48:46.231367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff781984eb0>]}
[0m02:48:47.006151 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m02:48:47.006623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78114e620>]}
[0m02:48:47.187937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:48:47.198992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7740340a0>]}
[0m02:48:47.279211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff774057880>]}
[0m02:48:47.279658 [info ] [MainThread]: Found 4 models, 32 data tests, 1 source, 419 macros
[0m02:48:47.280052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7740577f0>]}
[0m02:48:47.281647 [info ] [MainThread]: 
[0m02:48:47.282142 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:48:47.286444 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:48:47.314756 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:48:47.315139 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:48:47.315366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:48:47.366567 [debug] [ThreadPool]: SQL status: OK in 0.051 seconds
[0m02:48:47.367719 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:48:47.370137 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:48:47.370551 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:48:47.376350 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:48:47.376633 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:48:47.376838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:48:47.413196 [debug] [ThreadPool]: SQL status: OK in 0.036 seconds
[0m02:48:47.414722 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:48:47.415088 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:48:47.416657 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m02:48:47.416996 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:48:47.417315 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:48:47.417900 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:48:47.418694 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:48:47.418979 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:48:47.419178 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:48:47.419618 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:48:47.419849 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:48:47.422773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:48:47.427293 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:48:47.427534 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:48:47.427729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:48:47.461762 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m02:48:47.462279 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:48:47.462521 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:48:47.480568 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m02:48:47.481843 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:48:47.483257 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:48:47.483593 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:48:47.486029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff780c6abc0>]}
[0m02:48:47.486540 [debug] [MainThread]: Using duckdb connection "master"
[0m02:48:47.486899 [debug] [MainThread]: On master: BEGIN
[0m02:48:47.487114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:48:47.524135 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m02:48:47.524639 [debug] [MainThread]: On master: COMMIT
[0m02:48:47.524896 [debug] [MainThread]: Using duckdb connection "master"
[0m02:48:47.525115 [debug] [MainThread]: On master: COMMIT
[0m02:48:47.525630 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:48:47.525893 [debug] [MainThread]: On master: Close
[0m02:48:47.528196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:48:47.528505 [info ] [MainThread]: 
[0m02:48:47.531120 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.debug_tables
[0m02:48:47.531745 [info ] [Thread-1 (]: 1 of 4 START sql view model main.debug_tables .................................. [RUN]
[0m02:48:47.532284 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.debug_tables'
[0m02:48:47.532535 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.debug_tables
[0m02:48:47.538156 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.debug_tables"
[0m02:48:47.538898 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.debug_tables
[0m02:48:47.560869 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.debug_tables"
[0m02:48:47.561508 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:48:47.561798 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: BEGIN
[0m02:48:47.562105 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:48:47.600704 [debug] [Thread-1 (]: SQL status: OK in 0.038 seconds
[0m02:48:47.601172 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:48:47.601468 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:48:47.604535 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:48:47.604830 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:48:47.605190 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: ROLLBACK
[0m02:48:47.610292 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.debug_tables'
[0m02:48:47.610633 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: Close
[0m02:48:47.612853 [debug] [Thread-1 (]: Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:48:47.614058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff76d377520>]}
[0m02:48:47.614570 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.debug_tables ......................... [[31mERROR[0m in 0.08s]
[0m02:48:47.615030 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.debug_tables
[0m02:48:47.615372 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:48:47.615766 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_trades .................................... [RUN]
[0m02:48:47.616777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_pipeline.debug_tables, now model.crypto_pipeline.stg_trades)
[0m02:48:47.617113 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:48:47.619589 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:48:47.619992 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:48:47.622323 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:48:47.622807 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:48:47.623188 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:48:47.623558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:48:47.659704 [debug] [Thread-1 (]: SQL status: OK in 0.036 seconds
[0m02:48:47.660299 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:48:47.660732 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:48:47.677528 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:48:47.677881 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:48:47.678271 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:48:47.678841 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:48:47.679081 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:48:47.681630 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:48:47.681985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f5d9d4a-5327-4eca-8535-73fd7aa17096', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff76d37c9a0>]}
[0m02:48:47.682472 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.07s]
[0m02:48:47.682935 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:48:47.684045 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:48:47.684749 [info ] [Thread-1 (]: 3 of 4 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:48:47.685098 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:48:47.685436 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:48:47.685764 [info ] [Thread-1 (]: 4 of 4 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:48:47.686176 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:48:47.687327 [debug] [MainThread]: Using duckdb connection "master"
[0m02:48:47.687647 [debug] [MainThread]: On master: BEGIN
[0m02:48:47.687985 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:48:47.725020 [debug] [MainThread]: SQL status: OK in 0.037 seconds
[0m02:48:47.725452 [debug] [MainThread]: On master: COMMIT
[0m02:48:47.725751 [debug] [MainThread]: Using duckdb connection "master"
[0m02:48:47.725997 [debug] [MainThread]: On master: COMMIT
[0m02:48:47.726458 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:48:47.726770 [debug] [MainThread]: On master: Close
[0m02:48:47.729157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:48:47.729393 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:48:47.729578 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:48:47.729871 [info ] [MainThread]: 
[0m02:48:47.730159 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m02:48:47.730828 [debug] [MainThread]: Command end result
[0m02:48:47.809366 [info ] [MainThread]: 
[0m02:48:47.809817 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:48:47.810104 [info ] [MainThread]: 
[0m02:48:47.810454 [error] [MainThread]:   Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:48:47.810738 [info ] [MainThread]: 
[0m02:48:47.811064 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:48:47.811342 [info ] [MainThread]: 
[0m02:48:47.811615 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m02:48:47.812242 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.917598, "process_user_time": 3.684997, "process_kernel_time": 0.250579, "process_mem_max_rss": "217312", "process_in_blocks": "106080", "process_out_blocks": "2984", "command_success": false}
[0m02:48:47.812632 [debug] [MainThread]: Command `dbt run` failed at 02:48:47.812560 after 1.92 seconds
[0m02:48:47.812904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff782803520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78289bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7821a5cf0>]}
[0m02:48:47.813155 [debug] [MainThread]: Flushing usage events
[0m02:49:41.846027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64b64f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64b9c7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64b9c6080>]}


============================== 02:49:41.849319 | 8e11edca-2302-46ec-909f-ec6ec5315072 ==============================
[0m02:49:41.849319 [info ] [MainThread]: Running with dbt=1.8.8
[0m02:49:41.849701 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:49:42.045000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e11edca-2302-46ec-909f-ec6ec5315072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64b5111e0>]}
[0m02:49:42.085995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e11edca-2302-46ec-909f-ec6ec5315072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa649c5bb20>]}
[0m02:49:42.089227 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m02:49:42.099973 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m02:49:42.232986 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m02:49:42.233458 [debug] [MainThread]: Partial parsing: deleted file: crypto_pipeline://macros/get_aws_creds.sql
[0m02:49:42.233703 [debug] [MainThread]: Partial parsing: deleted file: crypto_pipeline://macros/debug_compile.sql
[0m02:49:42.233901 [debug] [MainThread]: Partial parsing: deleted file: crypto_pipeline://macros/debug_tables.sql
[0m02:49:42.297488 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m02:49:42.309756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e11edca-2302-46ec-909f-ec6ec5315072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63e130130>]}
[0m02:49:42.400823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e11edca-2302-46ec-909f-ec6ec5315072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63e130070>]}
[0m02:49:42.401280 [info ] [MainThread]: Found 4 models, 32 data tests, 1 source, 417 macros
[0m02:49:42.401606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e11edca-2302-46ec-909f-ec6ec5315072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63e133fa0>]}
[0m02:49:42.403430 [info ] [MainThread]: 
[0m02:49:42.404152 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m02:49:42.408696 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m02:49:42.440095 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m02:49:42.440492 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m02:49:42.440732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:49:42.500157 [debug] [ThreadPool]: SQL status: OK in 0.059 seconds
[0m02:49:42.501696 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m02:49:42.504602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m02:49:42.505199 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m02:49:42.511217 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:49:42.511745 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m02:49:42.512053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:42.554534 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m02:49:42.556119 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:49:42.556475 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m02:49:42.557172 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:49:42.557576 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:49:42.558005 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m02:49:42.558626 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:49:42.559765 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:49:42.560115 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m02:49:42.560384 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m02:49:42.561101 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m02:49:42.561354 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m02:49:42.564832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m02:49:42.570394 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:49:42.570782 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m02:49:42.571060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m02:49:42.614724 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m02:49:42.615193 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m02:49:42.615611 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m02:49:42.640207 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m02:49:42.641684 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m02:49:42.643111 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m02:49:42.643611 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m02:49:42.647114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e11edca-2302-46ec-909f-ec6ec5315072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63e136650>]}
[0m02:49:42.648040 [debug] [MainThread]: Using duckdb connection "master"
[0m02:49:42.648486 [debug] [MainThread]: On master: BEGIN
[0m02:49:42.648794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m02:49:42.694061 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m02:49:42.695107 [debug] [MainThread]: On master: COMMIT
[0m02:49:42.695682 [debug] [MainThread]: Using duckdb connection "master"
[0m02:49:42.696165 [debug] [MainThread]: On master: COMMIT
[0m02:49:42.697263 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:49:42.697922 [debug] [MainThread]: On master: Close
[0m02:49:42.700823 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m02:49:42.701243 [info ] [MainThread]: 
[0m02:49:42.704216 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.debug_tables
[0m02:49:42.705121 [info ] [Thread-1 (]: 1 of 4 START sql view model main.debug_tables .................................. [RUN]
[0m02:49:42.705756 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.debug_tables'
[0m02:49:42.706244 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.debug_tables
[0m02:49:42.716851 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.debug_tables"
[0m02:49:42.717906 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.debug_tables
[0m02:49:42.758998 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.debug_tables"
[0m02:49:42.759902 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:49:42.760432 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: BEGIN
[0m02:49:42.760860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:49:42.817635 [debug] [Thread-1 (]: SQL status: OK in 0.057 seconds
[0m02:49:42.818767 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.debug_tables"
[0m02:49:42.819324 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:49:42.823763 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.debug_tables"} */

  
  create view "crypto_trading"."main"."debug_tables__dbt_tmp" as (
    SELECT 1 AS test;
  );

[0m02:49:42.824852 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:49:42.825358 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: ROLLBACK
[0m02:49:42.834659 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.debug_tables'
[0m02:49:42.835532 [debug] [Thread-1 (]: On model.crypto_pipeline.debug_tables: Close
[0m02:49:42.840315 [debug] [Thread-1 (]: Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:49:42.842871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e11edca-2302-46ec-909f-ec6ec5315072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63e16edd0>]}
[0m02:49:42.843867 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model main.debug_tables ......................... [[31mERROR[0m in 0.14s]
[0m02:49:42.844895 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.debug_tables
[0m02:49:42.845635 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m02:49:42.847979 [info ] [Thread-1 (]: 2 of 4 START sql view model main.stg_trades .................................... [RUN]
[0m02:49:42.848717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.crypto_pipeline.debug_tables, now model.crypto_pipeline.stg_trades)
[0m02:49:42.849335 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m02:49:42.854873 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m02:49:42.856023 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m02:49:42.861112 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m02:49:42.862411 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:49:42.862918 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m02:49:42.863510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m02:49:42.913418 [debug] [Thread-1 (]: SQL status: OK in 0.050 seconds
[0m02:49:42.913991 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m02:49:42.914492 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:49:42.932490 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM crypto_trading.raw.trades
WHERE price > 0
  );

[0m02:49:42.933255 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m02:49:42.933712 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m02:49:42.934382 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m02:49:42.934670 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m02:49:42.938841 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:49:42.939447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e11edca-2302-46ec-909f-ec6ec5315072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa63c58bdf0>]}
[0m02:49:42.940169 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m02:49:42.940714 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m02:49:42.942012 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m02:49:42.942542 [info ] [Thread-1 (]: 3 of 4 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m02:49:42.943004 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m02:49:42.943393 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m02:49:42.943965 [info ] [Thread-1 (]: 4 of 4 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m02:49:42.944612 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m02:49:42.946055 [debug] [MainThread]: Using duckdb connection "master"
[0m02:49:42.946309 [debug] [MainThread]: On master: BEGIN
[0m02:49:42.946510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m02:49:42.984575 [debug] [MainThread]: SQL status: OK in 0.038 seconds
[0m02:49:42.985202 [debug] [MainThread]: On master: COMMIT
[0m02:49:42.985605 [debug] [MainThread]: Using duckdb connection "master"
[0m02:49:42.985881 [debug] [MainThread]: On master: COMMIT
[0m02:49:42.986528 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m02:49:42.986824 [debug] [MainThread]: On master: Close
[0m02:49:42.989619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:49:42.990052 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m02:49:42.990356 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m02:49:42.990808 [info ] [MainThread]: 
[0m02:49:42.991156 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m02:49:42.992027 [debug] [MainThread]: Command end result
[0m02:49:43.081079 [info ] [MainThread]: 
[0m02:49:43.081571 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m02:49:43.081941 [info ] [MainThread]: 
[0m02:49:43.082437 [error] [MainThread]:   Runtime Error in model debug_tables (models/staging/debug_tables.sql)
  Parser Error: syntax error at or near ";"
[0m02:49:43.082835 [info ] [MainThread]: 
[0m02:49:43.083211 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM crypto_trading.raw.trades
                ^
[0m02:49:43.083498 [info ] [MainThread]: 
[0m02:49:43.083794 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=2 TOTAL=4
[0m02:49:43.085012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2844653, "process_user_time": 3.196965, "process_kernel_time": 0.35913, "process_mem_max_rss": "198728", "process_in_blocks": "148488", "process_out_blocks": "3016", "command_success": false}
[0m02:49:43.085494 [debug] [MainThread]: Command `dbt run` failed at 02:49:43.085412 after 1.29 seconds
[0m02:49:43.085828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa64b64f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa649bcab00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa649bcb460>]}
[0m02:49:43.086109 [debug] [MainThread]: Flushing usage events
[0m03:00:45.595008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486880b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48681ee4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4868b87fa0>]}


============================== 03:00:45.597786 | d1ad0334-9827-4c04-afc1-f493b193dc40 ==============================
[0m03:00:45.597786 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:00:45.598269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:00:45.765000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1ad0334-9827-4c04-afc1-f493b193dc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4866d8d6f0>]}
[0m03:00:45.802039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1ad0334-9827-4c04-afc1-f493b193dc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48670d7460>]}
[0m03:00:45.804805 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m03:00:45.813172 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m03:00:45.895323 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:00:45.895741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1ad0334-9827-4c04-afc1-f493b193dc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4867b50f40>]}
[0m03:00:46.666409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:00:46.666870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1ad0334-9827-4c04-afc1-f493b193dc40', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f485b4e7b80>]}
[0m03:00:46.852007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m03:00:46.863567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1ad0334-9827-4c04-afc1-f493b193dc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48581ac130>]}
[0m03:00:46.945404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1ad0334-9827-4c04-afc1-f493b193dc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f485818a2f0>]}
[0m03:00:46.945853 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m03:00:46.946285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ad0334-9827-4c04-afc1-f493b193dc40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f485818b7c0>]}
[0m03:00:46.947715 [info ] [MainThread]: 
[0m03:00:46.948185 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:00:46.952236 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m03:00:46.981094 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m03:00:46.981470 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m03:00:46.981688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:47.487731 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m03:00:47.488160 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m03:00:47.488989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:47.489311 [debug] [MainThread]: Connection 'list_crypto_trading' was properly closed.
[0m03:00:47.489603 [info ] [MainThread]: 
[0m03:00:47.489997 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m03:00:47.490449 [error] [MainThread]: Encountered an error:
Runtime Error
  HTTP Error: Failed to download extension "duckdb_s3" at URL "http://extensions.duckdb.org/v1.1.3/linux_amd64_gcc4/duckdb_s3.duckdb_extension.gz" (HTTP 403)
  
  Candidate extensions: "md", "tpcds", "iceberg"
[0m03:00:47.491303 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.931753, "process_user_time": 2.78214, "process_kernel_time": 0.283094, "process_mem_max_rss": "199044", "process_in_blocks": "148264", "process_out_blocks": "1952", "command_success": false}
[0m03:00:47.491776 [debug] [MainThread]: Command `dbt run` failed at 03:00:47.491695 after 1.93 seconds
[0m03:00:47.492037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f486880b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4858188e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47dbf3dba0>]}
[0m03:00:47.492304 [debug] [MainThread]: Flushing usage events
[0m03:01:15.436639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb687374f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb66c6f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb66c6fd90>]}


============================== 03:01:15.438725 | 6f905379-b404-4a56-a064-6d4bae738930 ==============================
[0m03:01:15.438725 [info ] [MainThread]: Running with dbt=1.8.8
[0m03:01:15.439097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/root/crypto_pipeline/src/crypto_pipeline/transformers/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m03:01:15.574401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f905379-b404-4a56-a064-6d4bae738930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb66be3640>]}
[0m03:01:15.609849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f905379-b404-4a56-a064-6d4bae738930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb670b8940>]}
[0m03:01:15.611743 [info ] [MainThread]: Registered adapter: duckdb=1.9.0
[0m03:01:15.618577 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m03:01:15.696644 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m03:01:15.697077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f905379-b404-4a56-a064-6d4bae738930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb678b8e80>]}
[0m03:01:16.423545 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m03:01:16.423997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6f905379-b404-4a56-a064-6d4bae738930', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb635e1c90>]}
[0m03:01:16.613935 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crypto_pipeline.intermediate
[0m03:01:16.625147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f905379-b404-4a56-a064-6d4bae738930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb43fe8130>]}
[0m03:01:16.699931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f905379-b404-4a56-a064-6d4bae738930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb43e26e60>]}
[0m03:01:16.700391 [info ] [MainThread]: Found 3 models, 32 data tests, 1 source, 417 macros
[0m03:01:16.700692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f905379-b404-4a56-a064-6d4bae738930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb43e26fb0>]}
[0m03:01:16.702162 [info ] [MainThread]: 
[0m03:01:16.702660 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m03:01:16.706942 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_crypto_trading'
[0m03:01:16.729954 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading"
[0m03:01:16.730529 [debug] [ThreadPool]: On list_crypto_trading: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"crypto_trading"'
    
  
  
[0m03:01:16.730825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:01:16.775194 [debug] [ThreadPool]: SQL status: OK in 0.044 seconds
[0m03:01:16.776352 [debug] [ThreadPool]: On list_crypto_trading: Close
[0m03:01:16.778419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_crypto_trading, now create_crypto_trading_main)
[0m03:01:16.778833 [debug] [ThreadPool]: Creating schema "database: "crypto_trading"
schema: "main"
"
[0m03:01:16.783679 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m03:01:16.783934 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='crypto_trading'
        and type='sqlite'
    
  
[0m03:01:16.784134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:01:16.819409 [debug] [ThreadPool]: SQL status: OK in 0.035 seconds
[0m03:01:16.820893 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m03:01:16.821278 [debug] [ThreadPool]: On create_crypto_trading_main: BEGIN
[0m03:01:16.821857 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:01:16.822202 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m03:01:16.822477 [debug] [ThreadPool]: On create_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "create_crypto_trading_main"} */

    
    
        create schema if not exists "crypto_trading"."main"
    
[0m03:01:16.822950 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:01:16.823560 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m03:01:16.823776 [debug] [ThreadPool]: Using duckdb connection "create_crypto_trading_main"
[0m03:01:16.823965 [debug] [ThreadPool]: On create_crypto_trading_main: COMMIT
[0m03:01:16.824483 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m03:01:16.824822 [debug] [ThreadPool]: On create_crypto_trading_main: Close
[0m03:01:16.827450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_crypto_trading_main, now list_crypto_trading_main)
[0m03:01:16.832497 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m03:01:16.832742 [debug] [ThreadPool]: On list_crypto_trading_main: BEGIN
[0m03:01:16.832935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:01:16.866976 [debug] [ThreadPool]: SQL status: OK in 0.034 seconds
[0m03:01:16.867390 [debug] [ThreadPool]: Using duckdb connection "list_crypto_trading_main"
[0m03:01:16.867646 [debug] [ThreadPool]: On list_crypto_trading_main: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "connection_name": "list_crypto_trading_main"} */
select
      'crypto_trading' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'crypto_trading'
  
[0m03:01:16.885075 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m03:01:16.886231 [debug] [ThreadPool]: On list_crypto_trading_main: ROLLBACK
[0m03:01:16.887520 [debug] [ThreadPool]: Failed to rollback 'list_crypto_trading_main'
[0m03:01:16.887856 [debug] [ThreadPool]: On list_crypto_trading_main: Close
[0m03:01:16.890609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f905379-b404-4a56-a064-6d4bae738930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb687ced10>]}
[0m03:01:16.891093 [debug] [MainThread]: Using duckdb connection "master"
[0m03:01:16.891394 [debug] [MainThread]: On master: BEGIN
[0m03:01:16.891669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:01:16.926066 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m03:01:16.926515 [debug] [MainThread]: On master: COMMIT
[0m03:01:16.926822 [debug] [MainThread]: Using duckdb connection "master"
[0m03:01:16.927096 [debug] [MainThread]: On master: COMMIT
[0m03:01:16.927609 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:01:16.927946 [debug] [MainThread]: On master: Close
[0m03:01:16.929843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:01:16.930139 [info ] [MainThread]: 
[0m03:01:16.932542 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.stg_trades
[0m03:01:16.932998 [info ] [Thread-1 (]: 1 of 3 START sql view model main.stg_trades .................................... [RUN]
[0m03:01:16.933461 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.crypto_pipeline.stg_trades'
[0m03:01:16.933725 [debug] [Thread-1 (]: Began compiling node model.crypto_pipeline.stg_trades
[0m03:01:16.939993 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_pipeline.stg_trades"
[0m03:01:16.940778 [debug] [Thread-1 (]: Began executing node model.crypto_pipeline.stg_trades
[0m03:01:16.962033 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_pipeline.stg_trades"
[0m03:01:16.962590 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m03:01:16.962875 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: BEGIN
[0m03:01:16.963127 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m03:01:17.000709 [debug] [Thread-1 (]: SQL status: OK in 0.037 seconds
[0m03:01:17.001146 [debug] [Thread-1 (]: Using duckdb connection "model.crypto_pipeline.stg_trades"
[0m03:01:17.001426 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."raw"."trades"
WHERE price > 0
  );

[0m03:01:17.017987 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "crypto_pipeline", "target_name": "dev", "node_id": "model.crypto_pipeline.stg_trades"} */

  
  create view "crypto_trading"."main"."stg_trades__dbt_tmp" as (
    -- staging/stg_trades.sql
SELECT
    id,
    price,
    qty,
    quoteQty,
    time AS traded_at,
    isBuyerMaker,
    isBestMatch,
    tick_volume,
    tick_direction,
    MAKE_DATE(year, month, day) AS partition_date
FROM "crypto_trading"."raw"."trades"
WHERE price > 0
  );

[0m03:01:17.018627 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m03:01:17.019161 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: ROLLBACK
[0m03:01:17.024755 [debug] [Thread-1 (]: Failed to rollback 'model.crypto_pipeline.stg_trades'
[0m03:01:17.025034 [debug] [Thread-1 (]: On model.crypto_pipeline.stg_trades: Close
[0m03:01:17.027745 [debug] [Thread-1 (]: Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."raw"."trades"
                ^
[0m03:01:17.029043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f905379-b404-4a56-a064-6d4bae738930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb43e9f2b0>]}
[0m03:01:17.029540 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model main.stg_trades ........................... [[31mERROR[0m in 0.09s]
[0m03:01:17.030020 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.stg_trades
[0m03:01:17.031606 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.hourly_ohlcv
[0m03:01:17.031903 [info ] [Thread-1 (]: 2 of 3 SKIP relation main.hourly_ohlcv ......................................... [[33mSKIP[0m]
[0m03:01:17.032232 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.hourly_ohlcv
[0m03:01:17.032541 [debug] [Thread-1 (]: Began running node model.crypto_pipeline.minute_ohlcv
[0m03:01:17.032886 [info ] [Thread-1 (]: 3 of 3 SKIP relation main.minute_ohlcv ......................................... [[33mSKIP[0m]
[0m03:01:17.033207 [debug] [Thread-1 (]: Finished running node model.crypto_pipeline.minute_ohlcv
[0m03:01:17.034760 [debug] [MainThread]: Using duckdb connection "master"
[0m03:01:17.035079 [debug] [MainThread]: On master: BEGIN
[0m03:01:17.035383 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:01:17.069816 [debug] [MainThread]: SQL status: OK in 0.034 seconds
[0m03:01:17.070369 [debug] [MainThread]: On master: COMMIT
[0m03:01:17.070635 [debug] [MainThread]: Using duckdb connection "master"
[0m03:01:17.070867 [debug] [MainThread]: On master: COMMIT
[0m03:01:17.071365 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m03:01:17.071722 [debug] [MainThread]: On master: Close
[0m03:01:17.074426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:01:17.074643 [debug] [MainThread]: Connection 'list_crypto_trading_main' was properly closed.
[0m03:01:17.074838 [debug] [MainThread]: Connection 'model.crypto_pipeline.stg_trades' was properly closed.
[0m03:01:17.075123 [info ] [MainThread]: 
[0m03:01:17.075405 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m03:01:17.076023 [debug] [MainThread]: Command end result
[0m03:01:17.155972 [info ] [MainThread]: 
[0m03:01:17.156421 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m03:01:17.156705 [info ] [MainThread]: 
[0m03:01:17.157024 [error] [MainThread]:   Runtime Error in model stg_trades (models/staging/stg_trades.sql)
  Catalog Error: Table with name trades does not exist!
  Did you mean "system.information_schema.tables"?
  LINE 17: FROM "crypto_trading"."raw"."trades"
                ^
[0m03:01:17.157278 [info ] [MainThread]: 
[0m03:01:17.157543 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:01:17.158149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.7626635, "process_user_time": 3.311452, "process_kernel_time": 0.192975, "process_mem_max_rss": "211996", "process_in_blocks": "1112", "process_out_blocks": "2952", "command_success": false}
[0m03:01:17.158531 [debug] [MainThread]: Command `dbt run` failed at 03:01:17.158461 after 1.76 seconds
[0m03:01:17.158795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb687374f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb431a4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb431a4be0>]}
[0m03:01:17.159071 [debug] [MainThread]: Flushing usage events
